"use strict";var Hn=Object.defineProperty;var Zn=(s,e,t)=>e in s?Hn(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ct=(s,e,t)=>Zn(s,typeof e!="symbol"?e+"":e,t);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function Ie(s,e,t={}){const n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=s,n}function me(s,e,t={}){if(!s)throw new Error("coordinates is required");if(!Array.isArray(s))throw new Error("coordinates must be an Array");if(s.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!pn(s[0])||!pn(s[1]))throw new Error("coordinates must contain numbers");return Ie({type:"Point",coordinates:s},e,t)}function Oe(s,e,t={}){for(const i of s){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let r=0;r<i[i.length-1].length;r++)if(i[i.length-1][r]!==i[0][r])throw new Error("First and last Position are not equivalent.")}return Ie({type:"Polygon",coordinates:s},e,t)}function ln(s,e,t={}){if(s.length<2)throw new Error("coordinates must be an array of two or more positions");return Ie({type:"LineString",coordinates:s},e,t)}function Gt(s,e={}){const t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=s,t}function pn(s){return!isNaN(s)&&s!==null&&!Array.isArray(s)}function tr(s){if(!s)throw new Error("coord is required");if(!Array.isArray(s)){if(s.type==="Feature"&&s.geometry!==null&&s.geometry.type==="Point")return[...s.geometry.coordinates];if(s.type==="Point")return[...s.coordinates]}if(Array.isArray(s)&&s.length>=2&&!Array.isArray(s[0])&&!Array.isArray(s[1]))return[...s];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function er(s){return s.type==="Feature"?s.geometry:s}function an(s,e,t){if(s!==null)for(var n,i,r,o,a,c,h,u=0,f=0,g,m=s.type,k=m==="FeatureCollection",S=m==="Feature",X=k?s.features.length:1,C=0;C<X;C++){h=k?s.features[C].geometry:S?s.geometry:s,g=h?h.type==="GeometryCollection":!1,a=g?h.geometries.length:1;for(var d=0;d<a;d++){var v=0,l=0;if(o=g?h.geometries[d]:h,o!==null){c=o.coordinates;var w=o.type;switch(u=t&&(w==="Polygon"||w==="MultiPolygon")?1:0,w){case null:break;case"Point":if(e(c,f,C,v,l)===!1)return!1;f++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(e(c[n],f,C,v,l)===!1)return!1;f++,w==="MultiPoint"&&v++}w==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(i=0;i<c[n].length-u;i++){if(e(c[n][i],f,C,v,l)===!1)return!1;f++}w==="MultiLineString"&&v++,w==="Polygon"&&l++}w==="Polygon"&&v++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(l=0,i=0;i<c[n].length;i++){for(r=0;r<c[n][i].length-u;r++){if(e(c[n][i][r],f,C,v,l)===!1)return!1;f++}l++}v++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(an(o.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}const Lt=11102230246251565e-32,rt=134217729,Cn=(3+8*Lt)*Lt;function Ct(s,e,t,n,i){let r,o,a,c,h=e[0],u=n[0],f=0,g=0;u>h==u>-h?(r=h,h=e[++f]):(r=u,u=n[++g]);let m=0;if(f<s&&g<t)for(u>h==u>-h?(o=h+r,a=r-(o-h),h=e[++f]):(o=u+r,a=r-(o-u),u=n[++g]),r=o,a!==0&&(i[m++]=a);f<s&&g<t;)u>h==u>-h?(o=r+h,c=o-r,a=r-(o-c)+(h-c),h=e[++f]):(o=r+u,c=o-r,a=r-(o-c)+(u-c),u=n[++g]),r=o,a!==0&&(i[m++]=a);for(;f<s;)o=r+h,c=o-r,a=r-(o-c)+(h-c),h=e[++f],r=o,a!==0&&(i[m++]=a);for(;g<t;)o=r+u,c=o-r,a=r-(o-c)+(u-c),u=n[++g],r=o,a!==0&&(i[m++]=a);return(r!==0||m===0)&&(i[m++]=r),m}function Ut(s,e,t,n,i,r,o,a){return Ct(Ct(s,e,t,n,o),o,i,r,a)}function j(s,e,t,n){let i,r,o,a,c,h,u,f,g,m,k;u=rt*t,m=u-(u-t),k=t-m;let S=e[0];i=S*t,u=rt*S,f=u-(u-S),g=S-f,o=g*k-(i-f*m-g*m-f*k);let X=0;o!==0&&(n[X++]=o);for(let C=1;C<s;C++)S=e[C],a=S*t,u=rt*S,f=u-(u-S),g=S-f,c=g*k-(a-f*m-g*m-f*k),r=i+c,h=r-i,o=i-(r-h)+(c-h),o!==0&&(n[X++]=o),i=a+r,o=r-(i-a),o!==0&&(n[X++]=o);return(i!==0||X===0)&&(n[X++]=i),X}function Fn(s,e){let t=e[0];for(let n=1;n<s;n++)t+=e[n];return t}function bt(s){return new Float64Array(s)}const nr=(3+16*Lt)*Lt,rr=(2+12*Lt)*Lt,ir=(9+64*Lt)*Lt*Lt,ge=bt(4),dn=bt(8),mn=bt(12),gn=bt(16),Dt=bt(4);function sr(s,e,t,n,i,r,o){let a,c,h,u,f,g,m,k,S,X,C,d,v,l,w,x,A,T;const _=s-i,P=t-i,R=e-r,D=n-r;l=_*D,g=rt*_,m=g-(g-_),k=_-m,g=rt*D,S=g-(g-D),X=D-S,w=k*X-(l-m*S-k*S-m*X),x=R*P,g=rt*R,m=g-(g-R),k=R-m,g=rt*P,S=g-(g-P),X=P-S,A=k*X-(x-m*S-k*S-m*X),C=w-A,f=w-C,ge[0]=w-(C+f)+(f-A),d=l+C,f=d-l,v=l-(d-f)+(C-f),C=v-x,f=v-C,ge[1]=v-(C+f)+(f-x),T=d+C,f=T-d,ge[2]=d-(T-f)+(C-f),ge[3]=T;let G=Fn(4,ge),p=rr*o;if(G>=p||-G>=p||(f=s-_,a=s-(_+f)+(f-i),f=t-P,h=t-(P+f)+(f-i),f=e-R,c=e-(R+f)+(f-r),f=n-D,u=n-(D+f)+(f-r),a===0&&c===0&&h===0&&u===0)||(p=ir*o+Cn*Math.abs(G),G+=_*u+D*a-(R*h+P*c),G>=p||-G>=p))return G;l=a*D,g=rt*a,m=g-(g-a),k=a-m,g=rt*D,S=g-(g-D),X=D-S,w=k*X-(l-m*S-k*S-m*X),x=c*P,g=rt*c,m=g-(g-c),k=c-m,g=rt*P,S=g-(g-P),X=P-S,A=k*X-(x-m*S-k*S-m*X),C=w-A,f=w-C,Dt[0]=w-(C+f)+(f-A),d=l+C,f=d-l,v=l-(d-f)+(C-f),C=v-x,f=v-C,Dt[1]=v-(C+f)+(f-x),T=d+C,f=T-d,Dt[2]=d-(T-f)+(C-f),Dt[3]=T;const M=Ct(4,ge,4,Dt,dn);l=_*u,g=rt*_,m=g-(g-_),k=_-m,g=rt*u,S=g-(g-u),X=u-S,w=k*X-(l-m*S-k*S-m*X),x=R*h,g=rt*R,m=g-(g-R),k=R-m,g=rt*h,S=g-(g-h),X=h-S,A=k*X-(x-m*S-k*S-m*X),C=w-A,f=w-C,Dt[0]=w-(C+f)+(f-A),d=l+C,f=d-l,v=l-(d-f)+(C-f),C=v-x,f=v-C,Dt[1]=v-(C+f)+(f-x),T=d+C,f=T-d,Dt[2]=d-(T-f)+(C-f),Dt[3]=T;const b=Ct(M,dn,4,Dt,mn);l=a*u,g=rt*a,m=g-(g-a),k=a-m,g=rt*u,S=g-(g-u),X=u-S,w=k*X-(l-m*S-k*S-m*X),x=c*h,g=rt*c,m=g-(g-c),k=c-m,g=rt*h,S=g-(g-h),X=h-S,A=k*X-(x-m*S-k*S-m*X),C=w-A,f=w-C,Dt[0]=w-(C+f)+(f-A),d=l+C,f=d-l,v=l-(d-f)+(C-f),C=v-x,f=v-C,Dt[1]=v-(C+f)+(f-x),T=d+C,f=T-d,Dt[2]=d-(T-f)+(C-f),Dt[3]=T;const I=Ct(b,mn,4,Dt,gn);return gn[I-1]}function ee(s,e,t,n,i,r){const o=(e-r)*(t-i),a=(s-i)*(n-r),c=o-a,h=Math.abs(o+a);return Math.abs(c)>=nr*h?c:-sr(s,e,t,n,i,r,h)}const or=(10+96*Lt)*Lt,ar=(4+48*Lt)*Lt,cr=(44+576*Lt)*Lt*Lt,ie=bt(4),se=bt(4),oe=bt(4),Ht=bt(4),Zt=bt(4),te=bt(4),$t=bt(4),qt=bt(4),Je=bt(8),Ke=bt(8),Ge=bt(8),Qe=bt(8),He=bt(8),Ze=bt(8),Te=bt(8),Ne=bt(8),Xe=bt(8),ue=bt(4),le=bt(4),pe=bt(4),ot=bt(8),dt=bt(16),St=bt(16),Et=bt(16),xt=bt(32),ae=bt(32),Ot=bt(48),jt=bt(64);let ve=bt(1152),tn=bt(1152);function Tt(s,e,t){s=Ct(s,ve,e,t,tn);const n=ve;return ve=tn,tn=n,s}function hr(s,e,t,n,i,r,o,a,c){let h,u,f,g,m,k,S,X,C,d,v,l,w,x,A,T,_,P,R,D,G,p,M,b,I,N,Y,y,O,L,q,V,z,K,U;const ht=s-o,ft=t-o,pt=i-o,mt=e-a,wt=n-a,gt=r-a;q=ft*gt,M=rt*ft,b=M-(M-ft),I=ft-b,M=rt*gt,N=M-(M-gt),Y=gt-N,V=I*Y-(q-b*N-I*N-b*Y),z=pt*wt,M=rt*pt,b=M-(M-pt),I=pt-b,M=rt*wt,N=M-(M-wt),Y=wt-N,K=I*Y-(z-b*N-I*N-b*Y),y=V-K,p=V-y,ie[0]=V-(y+p)+(p-K),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L-z,p=L-y,ie[1]=L-(y+p)+(p-z),U=O+y,p=U-O,ie[2]=O-(U-p)+(y-p),ie[3]=U,q=pt*mt,M=rt*pt,b=M-(M-pt),I=pt-b,M=rt*mt,N=M-(M-mt),Y=mt-N,V=I*Y-(q-b*N-I*N-b*Y),z=ht*gt,M=rt*ht,b=M-(M-ht),I=ht-b,M=rt*gt,N=M-(M-gt),Y=gt-N,K=I*Y-(z-b*N-I*N-b*Y),y=V-K,p=V-y,se[0]=V-(y+p)+(p-K),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L-z,p=L-y,se[1]=L-(y+p)+(p-z),U=O+y,p=U-O,se[2]=O-(U-p)+(y-p),se[3]=U,q=ht*wt,M=rt*ht,b=M-(M-ht),I=ht-b,M=rt*wt,N=M-(M-wt),Y=wt-N,V=I*Y-(q-b*N-I*N-b*Y),z=ft*mt,M=rt*ft,b=M-(M-ft),I=ft-b,M=rt*mt,N=M-(M-mt),Y=mt-N,K=I*Y-(z-b*N-I*N-b*Y),y=V-K,p=V-y,oe[0]=V-(y+p)+(p-K),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L-z,p=L-y,oe[1]=L-(y+p)+(p-z),U=O+y,p=U-O,oe[2]=O-(U-p)+(y-p),oe[3]=U,h=Ct(Ct(Ct(j(j(4,ie,ht,ot),ot,ht,dt),dt,j(j(4,ie,mt,ot),ot,mt,St),St,xt),xt,Ct(j(j(4,se,ft,ot),ot,ft,dt),dt,j(j(4,se,wt,ot),ot,wt,St),St,ae),ae,jt),jt,Ct(j(j(4,oe,pt,ot),ot,pt,dt),dt,j(j(4,oe,gt,ot),ot,gt,St),St,xt),xt,ve);let Bt=Fn(h,ve),Xt=ar*c;if(Bt>=Xt||-Bt>=Xt||(p=s-ht,u=s-(ht+p)+(p-o),p=e-mt,m=e-(mt+p)+(p-a),p=t-ft,f=t-(ft+p)+(p-o),p=n-wt,k=n-(wt+p)+(p-a),p=i-pt,g=i-(pt+p)+(p-o),p=r-gt,S=r-(gt+p)+(p-a),u===0&&f===0&&g===0&&m===0&&k===0&&S===0)||(Xt=cr*c+Cn*Math.abs(Bt),Bt+=(ht*ht+mt*mt)*(ft*S+gt*f-(wt*g+pt*k))+2*(ht*u+mt*m)*(ft*gt-wt*pt)+((ft*ft+wt*wt)*(pt*m+mt*g-(gt*u+ht*S))+2*(ft*f+wt*k)*(pt*mt-gt*ht))+((pt*pt+gt*gt)*(ht*k+wt*u-(mt*f+ft*m))+2*(pt*g+gt*S)*(ht*wt-mt*ft)),Bt>=Xt||-Bt>=Xt))return Bt;if((f!==0||k!==0||g!==0||S!==0)&&(q=ht*ht,M=rt*ht,b=M-(M-ht),I=ht-b,V=I*I-(q-b*b-(b+b)*I),z=mt*mt,M=rt*mt,b=M-(M-mt),I=mt-b,K=I*I-(z-b*b-(b+b)*I),y=V+K,p=y-V,Ht[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,Ht[1]=L-(y-p)+(z-p),U=O+y,p=U-O,Ht[2]=O-(U-p)+(y-p),Ht[3]=U),(g!==0||S!==0||u!==0||m!==0)&&(q=ft*ft,M=rt*ft,b=M-(M-ft),I=ft-b,V=I*I-(q-b*b-(b+b)*I),z=wt*wt,M=rt*wt,b=M-(M-wt),I=wt-b,K=I*I-(z-b*b-(b+b)*I),y=V+K,p=y-V,Zt[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,Zt[1]=L-(y-p)+(z-p),U=O+y,p=U-O,Zt[2]=O-(U-p)+(y-p),Zt[3]=U),(u!==0||m!==0||f!==0||k!==0)&&(q=pt*pt,M=rt*pt,b=M-(M-pt),I=pt-b,V=I*I-(q-b*b-(b+b)*I),z=gt*gt,M=rt*gt,b=M-(M-gt),I=gt-b,K=I*I-(z-b*b-(b+b)*I),y=V+K,p=y-V,te[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,te[1]=L-(y-p)+(z-p),U=O+y,p=U-O,te[2]=O-(U-p)+(y-p),te[3]=U),u!==0&&(X=j(4,ie,u,Je),h=Tt(h,Ut(j(X,Je,2*ht,dt),dt,j(j(4,te,u,ot),ot,wt,St),St,j(j(4,Zt,u,ot),ot,-gt,Et),Et,xt,Ot),Ot)),m!==0&&(C=j(4,ie,m,Ke),h=Tt(h,Ut(j(C,Ke,2*mt,dt),dt,j(j(4,Zt,m,ot),ot,pt,St),St,j(j(4,te,m,ot),ot,-ft,Et),Et,xt,Ot),Ot)),f!==0&&(d=j(4,se,f,Ge),h=Tt(h,Ut(j(d,Ge,2*ft,dt),dt,j(j(4,Ht,f,ot),ot,gt,St),St,j(j(4,te,f,ot),ot,-mt,Et),Et,xt,Ot),Ot)),k!==0&&(v=j(4,se,k,Qe),h=Tt(h,Ut(j(v,Qe,2*wt,dt),dt,j(j(4,te,k,ot),ot,ht,St),St,j(j(4,Ht,k,ot),ot,-pt,Et),Et,xt,Ot),Ot)),g!==0&&(l=j(4,oe,g,He),h=Tt(h,Ut(j(l,He,2*pt,dt),dt,j(j(4,Zt,g,ot),ot,mt,St),St,j(j(4,Ht,g,ot),ot,-wt,Et),Et,xt,Ot),Ot)),S!==0&&(w=j(4,oe,S,Ze),h=Tt(h,Ut(j(w,Ze,2*gt,dt),dt,j(j(4,Ht,S,ot),ot,ft,St),St,j(j(4,Zt,S,ot),ot,-ht,Et),Et,xt,Ot),Ot)),u!==0||m!==0){if(f!==0||k!==0||g!==0||S!==0?(q=f*gt,M=rt*f,b=M-(M-f),I=f-b,M=rt*gt,N=M-(M-gt),Y=gt-N,V=I*Y-(q-b*N-I*N-b*Y),z=ft*S,M=rt*ft,b=M-(M-ft),I=ft-b,M=rt*S,N=M-(M-S),Y=S-N,K=I*Y-(z-b*N-I*N-b*Y),y=V+K,p=y-V,$t[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,$t[1]=L-(y-p)+(z-p),U=O+y,p=U-O,$t[2]=O-(U-p)+(y-p),$t[3]=U,q=g*-wt,M=rt*g,b=M-(M-g),I=g-b,M=rt*-wt,N=M-(M- -wt),Y=-wt-N,V=I*Y-(q-b*N-I*N-b*Y),z=pt*-k,M=rt*pt,b=M-(M-pt),I=pt-b,M=rt*-k,N=M-(M- -k),Y=-k-N,K=I*Y-(z-b*N-I*N-b*Y),y=V+K,p=y-V,qt[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,qt[1]=L-(y-p)+(z-p),U=O+y,p=U-O,qt[2]=O-(U-p)+(y-p),qt[3]=U,A=Ct(4,$t,4,qt,Ne),q=f*S,M=rt*f,b=M-(M-f),I=f-b,M=rt*S,N=M-(M-S),Y=S-N,V=I*Y-(q-b*N-I*N-b*Y),z=g*k,M=rt*g,b=M-(M-g),I=g-b,M=rt*k,N=M-(M-k),Y=k-N,K=I*Y-(z-b*N-I*N-b*Y),y=V-K,p=V-y,le[0]=V-(y+p)+(p-K),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L-z,p=L-y,le[1]=L-(y+p)+(p-z),U=O+y,p=U-O,le[2]=O-(U-p)+(y-p),le[3]=U,P=4):(Ne[0]=0,A=1,le[0]=0,P=1),u!==0){const Mt=j(A,Ne,u,Et);h=Tt(h,Ct(j(X,Je,u,dt),dt,j(Mt,Et,2*ht,xt),xt,Ot),Ot);const kt=j(P,le,u,ot);h=Tt(h,Ut(j(kt,ot,2*ht,dt),dt,j(kt,ot,u,St),St,j(Mt,Et,u,xt),xt,ae,jt),jt),k!==0&&(h=Tt(h,j(j(4,te,u,ot),ot,k,dt),dt)),S!==0&&(h=Tt(h,j(j(4,Zt,-u,ot),ot,S,dt),dt))}if(m!==0){const Mt=j(A,Ne,m,Et);h=Tt(h,Ct(j(C,Ke,m,dt),dt,j(Mt,Et,2*mt,xt),xt,Ot),Ot);const kt=j(P,le,m,ot);h=Tt(h,Ut(j(kt,ot,2*mt,dt),dt,j(kt,ot,m,St),St,j(Mt,Et,m,xt),xt,ae,jt),jt)}}if(f!==0||k!==0){if(g!==0||S!==0||u!==0||m!==0?(q=g*mt,M=rt*g,b=M-(M-g),I=g-b,M=rt*mt,N=M-(M-mt),Y=mt-N,V=I*Y-(q-b*N-I*N-b*Y),z=pt*m,M=rt*pt,b=M-(M-pt),I=pt-b,M=rt*m,N=M-(M-m),Y=m-N,K=I*Y-(z-b*N-I*N-b*Y),y=V+K,p=y-V,$t[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,$t[1]=L-(y-p)+(z-p),U=O+y,p=U-O,$t[2]=O-(U-p)+(y-p),$t[3]=U,D=-gt,G=-S,q=u*D,M=rt*u,b=M-(M-u),I=u-b,M=rt*D,N=M-(M-D),Y=D-N,V=I*Y-(q-b*N-I*N-b*Y),z=ht*G,M=rt*ht,b=M-(M-ht),I=ht-b,M=rt*G,N=M-(M-G),Y=G-N,K=I*Y-(z-b*N-I*N-b*Y),y=V+K,p=y-V,qt[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,qt[1]=L-(y-p)+(z-p),U=O+y,p=U-O,qt[2]=O-(U-p)+(y-p),qt[3]=U,T=Ct(4,$t,4,qt,Xe),q=g*m,M=rt*g,b=M-(M-g),I=g-b,M=rt*m,N=M-(M-m),Y=m-N,V=I*Y-(q-b*N-I*N-b*Y),z=u*S,M=rt*u,b=M-(M-u),I=u-b,M=rt*S,N=M-(M-S),Y=S-N,K=I*Y-(z-b*N-I*N-b*Y),y=V-K,p=V-y,pe[0]=V-(y+p)+(p-K),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L-z,p=L-y,pe[1]=L-(y+p)+(p-z),U=O+y,p=U-O,pe[2]=O-(U-p)+(y-p),pe[3]=U,R=4):(Xe[0]=0,T=1,pe[0]=0,R=1),f!==0){const Mt=j(T,Xe,f,Et);h=Tt(h,Ct(j(d,Ge,f,dt),dt,j(Mt,Et,2*ft,xt),xt,Ot),Ot);const kt=j(R,pe,f,ot);h=Tt(h,Ut(j(kt,ot,2*ft,dt),dt,j(kt,ot,f,St),St,j(Mt,Et,f,xt),xt,ae,jt),jt),S!==0&&(h=Tt(h,j(j(4,Ht,f,ot),ot,S,dt),dt)),m!==0&&(h=Tt(h,j(j(4,te,-f,ot),ot,m,dt),dt))}if(k!==0){const Mt=j(T,Xe,k,Et);h=Tt(h,Ct(j(v,Qe,k,dt),dt,j(Mt,Et,2*wt,xt),xt,Ot),Ot);const kt=j(R,pe,k,ot);h=Tt(h,Ut(j(kt,ot,2*wt,dt),dt,j(kt,ot,k,St),St,j(Mt,Et,k,xt),xt,ae,jt),jt)}}if(g!==0||S!==0){if(u!==0||m!==0||f!==0||k!==0?(q=u*wt,M=rt*u,b=M-(M-u),I=u-b,M=rt*wt,N=M-(M-wt),Y=wt-N,V=I*Y-(q-b*N-I*N-b*Y),z=ht*k,M=rt*ht,b=M-(M-ht),I=ht-b,M=rt*k,N=M-(M-k),Y=k-N,K=I*Y-(z-b*N-I*N-b*Y),y=V+K,p=y-V,$t[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,$t[1]=L-(y-p)+(z-p),U=O+y,p=U-O,$t[2]=O-(U-p)+(y-p),$t[3]=U,D=-mt,G=-m,q=f*D,M=rt*f,b=M-(M-f),I=f-b,M=rt*D,N=M-(M-D),Y=D-N,V=I*Y-(q-b*N-I*N-b*Y),z=ft*G,M=rt*ft,b=M-(M-ft),I=ft-b,M=rt*G,N=M-(M-G),Y=G-N,K=I*Y-(z-b*N-I*N-b*Y),y=V+K,p=y-V,qt[0]=V-(y-p)+(K-p),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L+z,p=y-L,qt[1]=L-(y-p)+(z-p),U=O+y,p=U-O,qt[2]=O-(U-p)+(y-p),qt[3]=U,x=Ct(4,$t,4,qt,Te),q=u*k,M=rt*u,b=M-(M-u),I=u-b,M=rt*k,N=M-(M-k),Y=k-N,V=I*Y-(q-b*N-I*N-b*Y),z=f*m,M=rt*f,b=M-(M-f),I=f-b,M=rt*m,N=M-(M-m),Y=m-N,K=I*Y-(z-b*N-I*N-b*Y),y=V-K,p=V-y,ue[0]=V-(y+p)+(p-K),O=q+y,p=O-q,L=q-(O-p)+(y-p),y=L-z,p=L-y,ue[1]=L-(y+p)+(p-z),U=O+y,p=U-O,ue[2]=O-(U-p)+(y-p),ue[3]=U,_=4):(Te[0]=0,x=1,ue[0]=0,_=1),g!==0){const Mt=j(x,Te,g,Et);h=Tt(h,Ct(j(l,He,g,dt),dt,j(Mt,Et,2*pt,xt),xt,Ot),Ot);const kt=j(_,ue,g,ot);h=Tt(h,Ut(j(kt,ot,2*pt,dt),dt,j(kt,ot,g,St),St,j(Mt,Et,g,xt),xt,ae,jt),jt),m!==0&&(h=Tt(h,j(j(4,Zt,g,ot),ot,m,dt),dt)),k!==0&&(h=Tt(h,j(j(4,Ht,-g,ot),ot,k,dt),dt))}if(S!==0){const Mt=j(x,Te,S,Et);h=Tt(h,Ct(j(w,Ze,S,dt),dt,j(Mt,Et,2*gt,xt),xt,Ot),Ot);const kt=j(_,ue,S,ot);h=Tt(h,Ut(j(kt,ot,2*gt,dt),dt,j(kt,ot,S,St),St,j(Mt,Et,S,xt),xt,ae,jt),jt)}}return ve[h-1]}function fr(s,e,t,n,i,r,o,a){const c=s-o,h=t-o,u=i-o,f=e-a,g=n-a,m=r-a,k=h*m,S=u*g,X=c*c+f*f,C=u*f,d=c*m,v=h*h+g*g,l=c*g,w=h*f,x=u*u+m*m,A=X*(k-S)+v*(C-d)+x*(l-w),T=(Math.abs(k)+Math.abs(S))*X+(Math.abs(C)+Math.abs(d))*v+(Math.abs(l)+Math.abs(w))*x,_=or*T;return A>_||-A>_?A:hr(s,e,t,n,i,r,o,a,T)}function ur(s,e){var t,n,i=0,r,o,a,c,h,u,f,g=s[0],m=s[1],k=e.length;for(t=0;t<k;t++){n=0;var S=e[t],X=S.length-1;if(u=S[0],u[0]!==S[X][0]&&u[1]!==S[X][1])throw new Error("First and last coordinates in a ring must be the same");for(o=u[0]-g,a=u[1]-m,n;n<X;n++){if(f=S[n+1],c=f[0]-g,h=f[1]-m,a===0&&h===0){if(c<=0&&o>=0||o<=0&&c>=0)return 0}else if(h>=0&&a<=0||h<=0&&a>=0){if(r=ee(o,c,a,h,0,0),r===0)return 0;(r>0&&h>0&&a<=0||r<0&&h<=0&&a>0)&&i++}u=f,a=h,o=c}}return i%2!==0}function lr(s,e,t={}){if(!s)throw new Error("point is required");if(!e)throw new Error("polygon is required");const n=tr(s),i=er(e),r=i.type,o=e.bbox;let a=i.coordinates;if(o&&pr(n,o)===!1)return!1;r==="Polygon"&&(a=[a]);let c=!1;for(var h=0;h<a.length;++h){const u=ur(n,a[h]);if(u===0)return!t.ignoreBoundary;u&&(c=!0)}return c}function pr(s,e){return e[0]<=s[0]&&e[1]<=s[1]&&e[2]>=s[0]&&e[3]>=s[1]}let Ln=class{constructor(e=[],t=dr){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,i=t[e];for(;e>0;){const r=e-1>>1,o=t[r];if(n(i,o)>=0)break;t[e]=o,e=r}t[e]=i}_down(e){const{data:t,compare:n}=this,i=this.length>>1,r=t[e];for(;e<i;){let o=(e<<1)+1,a=t[o];const c=o+1;if(c<this.length&&n(t[c],a)<0&&(o=c,a=t[c]),n(a,r)>=0)break;t[e]=a,e=o}t[e]=r}};function dr(s,e){return s<e?-1:s>e?1:0}function Dn(s,e){return s.p.x>e.p.x?1:s.p.x<e.p.x?-1:s.p.y!==e.p.y?s.p.y>e.p.y?1:-1:1}function mr(s,e){return s.rightSweepEvent.p.x>e.rightSweepEvent.p.x?1:s.rightSweepEvent.p.x<e.rightSweepEvent.p.x?-1:s.rightSweepEvent.p.y!==e.rightSweepEvent.p.y?s.rightSweepEvent.p.y<e.rightSweepEvent.p.y?1:-1:1}class wn{constructor(e,t,n,i){this.p={x:e[0],y:e[1]},this.featureId=t,this.ringId=n,this.eventId=i,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(e){return this.p.x===e.p.x&&this.p.y===e.p.y}}function gr(s,e){if(s.type==="FeatureCollection"){const t=s.features;for(let n=0;n<t.length;n++)yn(t[n],e)}else yn(s,e)}let Ye=0,Re=0,Ce=0;function yn(s,e){const t=s.type==="Feature"?s.geometry:s;let n=t.coordinates;(t.type==="Polygon"||t.type==="MultiLineString")&&(n=[n]),t.type==="LineString"&&(n=[[n]]);for(let i=0;i<n.length;i++)for(let r=0;r<n[i].length;r++){let o=n[i][r][0],a=null;Re=Re+1;for(let c=0;c<n[i][r].length-1;c++){a=n[i][r][c+1];const h=new wn(o,Ye,Re,Ce),u=new wn(a,Ye,Re,Ce+1);h.otherEvent=u,u.otherEvent=h,Dn(h,u)>0?(u.isLeftEndpoint=!0,h.isLeftEndpoint=!1):(h.isLeftEndpoint=!0,u.isLeftEndpoint=!1),e.push(h),e.push(u),o=a,Ce=Ce+1}}Ye=Ye+1}class wr{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}function yr(s,e){if(s===null||e===null||s.leftSweepEvent.ringId===e.leftSweepEvent.ringId&&(s.rightSweepEvent.isSamePoint(e.leftSweepEvent)||s.rightSweepEvent.isSamePoint(e.leftSweepEvent)||s.rightSweepEvent.isSamePoint(e.rightSweepEvent)||s.leftSweepEvent.isSamePoint(e.leftSweepEvent)||s.leftSweepEvent.isSamePoint(e.rightSweepEvent)))return!1;const t=s.leftSweepEvent.p.x,n=s.leftSweepEvent.p.y,i=s.rightSweepEvent.p.x,r=s.rightSweepEvent.p.y,o=e.leftSweepEvent.p.x,a=e.leftSweepEvent.p.y,c=e.rightSweepEvent.p.x,h=e.rightSweepEvent.p.y,u=(h-a)*(i-t)-(c-o)*(r-n),f=(c-o)*(n-a)-(h-a)*(t-o),g=(i-t)*(n-a)-(r-n)*(t-o);if(u===0)return!1;const m=f/u,k=g/u;if(m>=0&&m<=1&&k>=0&&k<=1){const S=t+m*(i-t),X=n+m*(r-n);return[S,X]}return!1}function vr(s,e){e=e||!1;const t=[],n=new Ln([],mr);for(;s.length;){const i=s.pop();if(i.isLeftEndpoint){const r=new wr(i);for(let o=0;o<n.data.length;o++){const a=n.data[o];if(e&&a.leftSweepEvent.featureId===i.featureId)continue;const c=yr(r,a);c!==!1&&t.push(c)}n.push(r)}else i.isLeftEndpoint===!1&&n.pop()}return t}function br(s,e){const t=new Ln([],Dn);return gr(s,t),vr(t,e)}var xr=br;function _r(s,e,t={}){const{removeDuplicates:n=!0,ignoreSelfIntersections:i=!0}=t;let r=[];s.type==="FeatureCollection"?r=r.concat(s.features):s.type==="Feature"?r.push(s):(s.type==="LineString"||s.type==="Polygon"||s.type==="MultiLineString"||s.type==="MultiPolygon")&&r.push(Ie(s)),e.type==="FeatureCollection"?r=r.concat(e.features):e.type==="Feature"?r.push(e):(e.type==="LineString"||e.type==="Polygon"||e.type==="MultiLineString"||e.type==="MultiPolygon")&&r.push(Ie(e));const o=xr(Gt(r),i);let a=[];if(n){const c={};o.forEach(h=>{const u=h.join(",");c[u]||(c[u]=!0,a.push(h))})}else a=o;return Gt(a.map(c=>me(c)))}function Mr(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function kr(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var i=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return s[n]}})}),t}function Sr(s,e={}){let t=0,n=0,i=0;return an(s,function(r){t+=r[0],n+=r[1],i++},!0),me([t/i,n/i],e.properties)}var Fe={exports:{}},je={exports:{}},Er=je.exports,vn;function Ar(){return vn||(vn=1,(function(s,e){(function(t,n){s.exports=n()})(Er,function(){function t(d,v,l,w,x){(function A(T,_,P,R,D){for(;R>P;){if(R-P>600){var G=R-P+1,p=_-P+1,M=Math.log(G),b=.5*Math.exp(2*M/3),I=.5*Math.sqrt(M*b*(G-b)/G)*(p-G/2<0?-1:1),N=Math.max(P,Math.floor(_-p*b/G+I)),Y=Math.min(R,Math.floor(_+(G-p)*b/G+I));A(T,_,N,Y,D)}var y=T[_],O=P,L=R;for(n(T,P,_),D(T[R],y)>0&&n(T,P,R);O<L;){for(n(T,O,L),O++,L--;D(T[O],y)<0;)O++;for(;D(T[L],y)>0;)L--}D(T[P],y)===0?n(T,P,L):n(T,++L,R),L<=_&&(P=L+1),_<=L&&(R=L-1)}})(d,v,l||0,w||d.length-1,x||i)}function n(d,v,l){var w=d[v];d[v]=d[l],d[l]=w}function i(d,v){return d<v?-1:d>v?1:0}var r=function(d){d===void 0&&(d=9),this._maxEntries=Math.max(4,d),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(d,v,l){if(!l)return v.indexOf(d);for(var w=0;w<v.length;w++)if(l(d,v[w]))return w;return-1}function a(d,v){c(d,0,d.children.length,v,d)}function c(d,v,l,w,x){x||(x=X(null)),x.minX=1/0,x.minY=1/0,x.maxX=-1/0,x.maxY=-1/0;for(var A=v;A<l;A++){var T=d.children[A];h(x,d.leaf?w(T):T)}return x}function h(d,v){return d.minX=Math.min(d.minX,v.minX),d.minY=Math.min(d.minY,v.minY),d.maxX=Math.max(d.maxX,v.maxX),d.maxY=Math.max(d.maxY,v.maxY),d}function u(d,v){return d.minX-v.minX}function f(d,v){return d.minY-v.minY}function g(d){return(d.maxX-d.minX)*(d.maxY-d.minY)}function m(d){return d.maxX-d.minX+(d.maxY-d.minY)}function k(d,v){return d.minX<=v.minX&&d.minY<=v.minY&&v.maxX<=d.maxX&&v.maxY<=d.maxY}function S(d,v){return v.minX<=d.maxX&&v.minY<=d.maxY&&v.maxX>=d.minX&&v.maxY>=d.minY}function X(d){return{children:d,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function C(d,v,l,w,x){for(var A=[v,l];A.length;)if(!((l=A.pop())-(v=A.pop())<=w)){var T=v+Math.ceil((l-v)/w/2)*w;t(d,T,v,l,x),A.push(v,T,T,l)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(d){var v=this.data,l=[];if(!S(d,v))return l;for(var w=this.toBBox,x=[];v;){for(var A=0;A<v.children.length;A++){var T=v.children[A],_=v.leaf?w(T):T;S(d,_)&&(v.leaf?l.push(T):k(d,_)?this._all(T,l):x.push(T))}v=x.pop()}return l},r.prototype.collides=function(d){var v=this.data;if(!S(d,v))return!1;for(var l=[];v;){for(var w=0;w<v.children.length;w++){var x=v.children[w],A=v.leaf?this.toBBox(x):x;if(S(d,A)){if(v.leaf||k(d,A))return!0;l.push(x)}}v=l.pop()}return!1},r.prototype.load=function(d){if(!d||!d.length)return this;if(d.length<this._minEntries){for(var v=0;v<d.length;v++)this.insert(d[v]);return this}var l=this._build(d.slice(),0,d.length-1,0);if(this.data.children.length)if(this.data.height===l.height)this._splitRoot(this.data,l);else{if(this.data.height<l.height){var w=this.data;this.data=l,l=w}this._insert(l,this.data.height-l.height-1,!0)}else this.data=l;return this},r.prototype.insert=function(d){return d&&this._insert(d,this.data.height-1),this},r.prototype.clear=function(){return this.data=X([]),this},r.prototype.remove=function(d,v){if(!d)return this;for(var l,w,x,A=this.data,T=this.toBBox(d),_=[],P=[];A||_.length;){if(A||(A=_.pop(),w=_[_.length-1],l=P.pop(),x=!0),A.leaf){var R=o(d,A.children,v);if(R!==-1)return A.children.splice(R,1),_.push(A),this._condense(_),this}x||A.leaf||!k(A,T)?w?(l++,A=w.children[l],x=!1):A=null:(_.push(A),P.push(l),l=0,w=A,A=A.children[0])}return this},r.prototype.toBBox=function(d){return d},r.prototype.compareMinX=function(d,v){return d.minX-v.minX},r.prototype.compareMinY=function(d,v){return d.minY-v.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(d){return this.data=d,this},r.prototype._all=function(d,v){for(var l=[];d;)d.leaf?v.push.apply(v,d.children):l.push.apply(l,d.children),d=l.pop();return v},r.prototype._build=function(d,v,l,w){var x,A=l-v+1,T=this._maxEntries;if(A<=T)return a(x=X(d.slice(v,l+1)),this.toBBox),x;w||(w=Math.ceil(Math.log(A)/Math.log(T)),T=Math.ceil(A/Math.pow(T,w-1))),(x=X([])).leaf=!1,x.height=w;var _=Math.ceil(A/T),P=_*Math.ceil(Math.sqrt(T));C(d,v,l,P,this.compareMinX);for(var R=v;R<=l;R+=P){var D=Math.min(R+P-1,l);C(d,R,D,_,this.compareMinY);for(var G=R;G<=D;G+=_){var p=Math.min(G+_-1,D);x.children.push(this._build(d,G,p,w-1))}}return a(x,this.toBBox),x},r.prototype._chooseSubtree=function(d,v,l,w){for(;w.push(v),!v.leaf&&w.length-1!==l;){for(var x=1/0,A=1/0,T=void 0,_=0;_<v.children.length;_++){var P=v.children[_],R=g(P),D=(G=d,p=P,(Math.max(p.maxX,G.maxX)-Math.min(p.minX,G.minX))*(Math.max(p.maxY,G.maxY)-Math.min(p.minY,G.minY))-R);D<A?(A=D,x=R<x?R:x,T=P):D===A&&R<x&&(x=R,T=P)}v=T||v.children[0]}var G,p;return v},r.prototype._insert=function(d,v,l){var w=l?d:this.toBBox(d),x=[],A=this._chooseSubtree(w,this.data,v,x);for(A.children.push(d),h(A,w);v>=0&&x[v].children.length>this._maxEntries;)this._split(x,v),v--;this._adjustParentBBoxes(w,x,v)},r.prototype._split=function(d,v){var l=d[v],w=l.children.length,x=this._minEntries;this._chooseSplitAxis(l,x,w);var A=this._chooseSplitIndex(l,x,w),T=X(l.children.splice(A,l.children.length-A));T.height=l.height,T.leaf=l.leaf,a(l,this.toBBox),a(T,this.toBBox),v?d[v-1].children.push(T):this._splitRoot(l,T)},r.prototype._splitRoot=function(d,v){this.data=X([d,v]),this.data.height=d.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(d,v,l){for(var w,x,A,T,_,P,R,D=1/0,G=1/0,p=v;p<=l-v;p++){var M=c(d,0,p,this.toBBox),b=c(d,p,l,this.toBBox),I=(x=M,A=b,T=void 0,_=void 0,P=void 0,R=void 0,T=Math.max(x.minX,A.minX),_=Math.max(x.minY,A.minY),P=Math.min(x.maxX,A.maxX),R=Math.min(x.maxY,A.maxY),Math.max(0,P-T)*Math.max(0,R-_)),N=g(M)+g(b);I<D?(D=I,w=p,G=N<G?N:G):I===D&&N<G&&(G=N,w=p)}return w||l-v},r.prototype._chooseSplitAxis=function(d,v,l){var w=d.leaf?this.compareMinX:u,x=d.leaf?this.compareMinY:f;this._allDistMargin(d,v,l,w)<this._allDistMargin(d,v,l,x)&&d.children.sort(w)},r.prototype._allDistMargin=function(d,v,l,w){d.children.sort(w);for(var x=this.toBBox,A=c(d,0,v,x),T=c(d,l-v,l,x),_=m(A)+m(T),P=v;P<l-v;P++){var R=d.children[P];h(A,d.leaf?x(R):R),_+=m(A)}for(var D=l-v-1;D>=v;D--){var G=d.children[D];h(T,d.leaf?x(G):G),_+=m(T)}return _},r.prototype._adjustParentBBoxes=function(d,v,l){for(var w=l;w>=0;w--)h(v[w],d)},r.prototype._condense=function(d){for(var v=d.length-1,l=void 0;v>=0;v--)d[v].children.length===0?v>0?(l=d[v-1].children).splice(l.indexOf(d[v]),1):this.clear():a(d[v],this.toBBox)},r})})(je)),je.exports}class Pr{constructor(e=[],t=Br){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,i=t[e];for(;e>0;){const r=e-1>>1,o=t[r];if(n(i,o)>=0)break;t[e]=o,e=r}t[e]=i}_down(e){const{data:t,compare:n}=this,i=this.length>>1,r=t[e];for(;e<i;){let o=(e<<1)+1,a=t[o];const c=o+1;if(c<this.length&&n(t[c],a)<0&&(o=c,a=t[c]),n(a,r)>=0)break;t[e]=a,e=o}t[e]=r}}function Br(s,e){return s<e?-1:s>e?1:0}const Ir=Object.freeze(Object.defineProperty({__proto__:null,default:Pr},Symbol.toStringTag,{value:"Module"})),Or=kr(Ir);var _e={exports:{}},en,bn;function Tr(){return bn||(bn=1,en=function(e,t,n,i){var r=e[0],o=e[1],a=!1;n===void 0&&(n=0),i===void 0&&(i=t.length);for(var c=(i-n)/2,h=0,u=c-1;h<c;u=h++){var f=t[n+h*2+0],g=t[n+h*2+1],m=t[n+u*2+0],k=t[n+u*2+1],S=g>o!=k>o&&r<(m-f)*(o-g)/(k-g)+f;S&&(a=!a)}return a}),en}var nn,xn;function Nr(){return xn||(xn=1,nn=function(e,t,n,i){var r=e[0],o=e[1],a=!1;n===void 0&&(n=0),i===void 0&&(i=t.length);for(var c=i-n,h=0,u=c-1;h<c;u=h++){var f=t[h+n][0],g=t[h+n][1],m=t[u+n][0],k=t[u+n][1],S=g>o!=k>o&&r<(m-f)*(o-g)/(k-g)+f;S&&(a=!a)}return a}),nn}var _n;function Xr(){if(_n)return _e.exports;_n=1;var s=Tr(),e=Nr();return _e.exports=function(n,i,r,o){return i.length>0&&Array.isArray(i[0])?e(n,i,r,o):s(n,i,r,o)},_e.exports.nested=e,_e.exports.flat=s,_e.exports}var ke={exports:{}},Yr=ke.exports,Mn;function Rr(){return Mn||(Mn=1,(function(s,e){(function(t,n){n(e)})(Yr,function(t){const i=33306690738754706e-32;function r(S,X,C,d,v){let l,w,x,A,T=X[0],_=d[0],P=0,R=0;_>T==_>-T?(l=T,T=X[++P]):(l=_,_=d[++R]);let D=0;if(P<S&&R<C)for(_>T==_>-T?(x=l-((w=T+l)-T),T=X[++P]):(x=l-((w=_+l)-_),_=d[++R]),l=w,x!==0&&(v[D++]=x);P<S&&R<C;)_>T==_>-T?(x=l-((w=l+T)-(A=w-l))+(T-A),T=X[++P]):(x=l-((w=l+_)-(A=w-l))+(_-A),_=d[++R]),l=w,x!==0&&(v[D++]=x);for(;P<S;)x=l-((w=l+T)-(A=w-l))+(T-A),T=X[++P],l=w,x!==0&&(v[D++]=x);for(;R<C;)x=l-((w=l+_)-(A=w-l))+(_-A),_=d[++R],l=w,x!==0&&(v[D++]=x);return l===0&&D!==0||(v[D++]=l),D}function o(S){return new Float64Array(S)}const a=33306690738754716e-32,c=22204460492503146e-32,h=11093356479670487e-47,u=o(4),f=o(8),g=o(12),m=o(16),k=o(4);t.orient2d=function(S,X,C,d,v,l){const w=(X-l)*(C-v),x=(S-v)*(d-l),A=w-x;if(w===0||x===0||w>0!=x>0)return A;const T=Math.abs(w+x);return Math.abs(A)>=a*T?A:-(function(_,P,R,D,G,p,M){let b,I,N,Y,y,O,L,q,V,z,K,U,ht,ft,pt,mt,wt,gt;const Bt=_-G,Xt=R-G,Mt=P-p,kt=D-p;y=(pt=(q=Bt-(L=(O=134217729*Bt)-(O-Bt)))*(z=kt-(V=(O=134217729*kt)-(O-kt)))-((ft=Bt*kt)-L*V-q*V-L*z))-(K=pt-(wt=(q=Mt-(L=(O=134217729*Mt)-(O-Mt)))*(z=Xt-(V=(O=134217729*Xt)-(O-Xt)))-((mt=Mt*Xt)-L*V-q*V-L*z))),u[0]=pt-(K+y)+(y-wt),y=(ht=ft-((U=ft+K)-(y=U-ft))+(K-y))-(K=ht-mt),u[1]=ht-(K+y)+(y-mt),y=(gt=U+K)-U,u[2]=U-(gt-y)+(K-y),u[3]=gt;let Qt=(function(Yt,E){let B=E[0];for(let F=1;F<Yt;F++)B+=E[F];return B})(4,u),he=c*M;if(Qt>=he||-Qt>=he||(b=_-(Bt+(y=_-Bt))+(y-G),N=R-(Xt+(y=R-Xt))+(y-G),I=P-(Mt+(y=P-Mt))+(y-p),Y=D-(kt+(y=D-kt))+(y-p),b===0&&I===0&&N===0&&Y===0)||(he=h*M+i*Math.abs(Qt),(Qt+=Bt*Y+kt*b-(Mt*N+Xt*I))>=he||-Qt>=he))return Qt;y=(pt=(q=b-(L=(O=134217729*b)-(O-b)))*(z=kt-(V=(O=134217729*kt)-(O-kt)))-((ft=b*kt)-L*V-q*V-L*z))-(K=pt-(wt=(q=I-(L=(O=134217729*I)-(O-I)))*(z=Xt-(V=(O=134217729*Xt)-(O-Xt)))-((mt=I*Xt)-L*V-q*V-L*z))),k[0]=pt-(K+y)+(y-wt),y=(ht=ft-((U=ft+K)-(y=U-ft))+(K-y))-(K=ht-mt),k[1]=ht-(K+y)+(y-mt),y=(gt=U+K)-U,k[2]=U-(gt-y)+(K-y),k[3]=gt;const Ve=r(4,u,4,k,f);y=(pt=(q=Bt-(L=(O=134217729*Bt)-(O-Bt)))*(z=Y-(V=(O=134217729*Y)-(O-Y)))-((ft=Bt*Y)-L*V-q*V-L*z))-(K=pt-(wt=(q=Mt-(L=(O=134217729*Mt)-(O-Mt)))*(z=N-(V=(O=134217729*N)-(O-N)))-((mt=Mt*N)-L*V-q*V-L*z))),k[0]=pt-(K+y)+(y-wt),y=(ht=ft-((U=ft+K)-(y=U-ft))+(K-y))-(K=ht-mt),k[1]=ht-(K+y)+(y-mt),y=(gt=U+K)-U,k[2]=U-(gt-y)+(K-y),k[3]=gt;const We=r(Ve,f,4,k,g);y=(pt=(q=b-(L=(O=134217729*b)-(O-b)))*(z=Y-(V=(O=134217729*Y)-(O-Y)))-((ft=b*Y)-L*V-q*V-L*z))-(K=pt-(wt=(q=I-(L=(O=134217729*I)-(O-I)))*(z=N-(V=(O=134217729*N)-(O-N)))-((mt=I*N)-L*V-q*V-L*z))),k[0]=pt-(K+y)+(y-wt),y=(ht=ft-((U=ft+K)-(y=U-ft))+(K-y))-(K=ht-mt),k[1]=ht-(K+y)+(y-mt),y=(gt=U+K)-U,k[2]=U-(gt-y)+(K-y),k[3]=gt;const be=r(We,g,4,k,m);return m[be-1]})(S,X,C,d,v,l,T)},t.orient2dfast=function(S,X,C,d,v,l){return(X-l)*(C-v)-(S-v)*(d-l)},Object.defineProperty(t,"__esModule",{value:!0})})})(ke,ke.exports)),ke.exports}var kn;function Cr(){if(kn)return Fe.exports;kn=1;var s=Ar(),e=Or,t=Xr(),n=Rr().orient2d;e.default&&(e=e.default),Fe.exports=i,Fe.exports.default=i;function i(l,w,x){w=Math.max(0,w===void 0?2:w),x=x||0;var A=m(l),T=new s(16);T.toBBox=function(L){return{minX:L[0],minY:L[1],maxX:L[0],maxY:L[1]}},T.compareMinX=function(L,q){return L[0]-q[0]},T.compareMinY=function(L,q){return L[1]-q[1]},T.load(l);for(var _=[],P=0,R;P<A.length;P++){var D=A[P];T.remove(D),R=k(D,R),_.push(R)}var G=new s(16);for(P=0;P<_.length;P++)G.insert(g(_[P]));for(var p=w*w,M=x*x;_.length;){var b=_.shift(),I=b.p,N=b.next.p,Y=S(I,N);if(!(Y<M)){var y=Y/p;D=r(T,b.prev.p,I,N,b.next.next.p,y,G),D&&Math.min(S(D,I),S(D,N))<=y&&(_.push(b),_.push(k(D,b)),T.remove(D),G.remove(b),G.insert(g(b)),G.insert(g(b.next)))}}b=R;var O=[];do O.push(b.p),b=b.next;while(b!==R);return O.push(b.p),O}function r(l,w,x,A,T,_,P){for(var R=new e([],o),D=l.data;D;){for(var G=0;G<D.children.length;G++){var p=D.children[G],M=D.leaf?X(p,x,A):a(x,A,p);M>_||R.push({node:p,dist:M})}for(;R.length&&!R.peek().node.children;){var b=R.pop(),I=b.node,N=X(I,w,x),Y=X(I,A,T);if(b.dist<N&&b.dist<Y&&h(x,I,P)&&h(A,I,P))return I}D=R.pop(),D&&(D=D.node)}return null}function o(l,w){return l.dist-w.dist}function a(l,w,x){if(c(l,x)||c(w,x))return 0;var A=C(l[0],l[1],w[0],w[1],x.minX,x.minY,x.maxX,x.minY);if(A===0)return 0;var T=C(l[0],l[1],w[0],w[1],x.minX,x.minY,x.minX,x.maxY);if(T===0)return 0;var _=C(l[0],l[1],w[0],w[1],x.maxX,x.minY,x.maxX,x.maxY);if(_===0)return 0;var P=C(l[0],l[1],w[0],w[1],x.minX,x.maxY,x.maxX,x.maxY);return P===0?0:Math.min(A,T,_,P)}function c(l,w){return l[0]>=w.minX&&l[0]<=w.maxX&&l[1]>=w.minY&&l[1]<=w.maxY}function h(l,w,x){for(var A=Math.min(l[0],w[0]),T=Math.min(l[1],w[1]),_=Math.max(l[0],w[0]),P=Math.max(l[1],w[1]),R=x.search({minX:A,minY:T,maxX:_,maxY:P}),D=0;D<R.length;D++)if(f(R[D].p,R[D].next.p,l,w))return!1;return!0}function u(l,w,x){return n(l[0],l[1],w[0],w[1],x[0],x[1])}function f(l,w,x,A){return l!==A&&w!==x&&u(l,w,x)>0!=u(l,w,A)>0&&u(x,A,l)>0!=u(x,A,w)>0}function g(l){var w=l.p,x=l.next.p;return l.minX=Math.min(w[0],x[0]),l.minY=Math.min(w[1],x[1]),l.maxX=Math.max(w[0],x[0]),l.maxY=Math.max(w[1],x[1]),l}function m(l){for(var w=l[0],x=l[0],A=l[0],T=l[0],_=0;_<l.length;_++){var P=l[_];P[0]<w[0]&&(w=P),P[0]>A[0]&&(A=P),P[1]<x[1]&&(x=P),P[1]>T[1]&&(T=P)}var R=[w,x,A,T],D=R.slice();for(_=0;_<l.length;_++)t(l[_],R)||D.push(l[_]);return v(D)}function k(l,w){var x={p:l,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return w?(x.next=w.next,x.prev=w,w.next.prev=x,w.next=x):(x.prev=x,x.next=x),x}function S(l,w){var x=l[0]-w[0],A=l[1]-w[1];return x*x+A*A}function X(l,w,x){var A=w[0],T=w[1],_=x[0]-A,P=x[1]-T;if(_!==0||P!==0){var R=((l[0]-A)*_+(l[1]-T)*P)/(_*_+P*P);R>1?(A=x[0],T=x[1]):R>0&&(A+=_*R,T+=P*R)}return _=l[0]-A,P=l[1]-T,_*_+P*P}function C(l,w,x,A,T,_,P,R){var D=x-l,G=A-w,p=P-T,M=R-_,b=l-T,I=w-_,N=D*D+G*G,Y=D*p+G*M,y=p*p+M*M,O=D*b+G*I,L=p*b+M*I,q=N*y-Y*Y,V,z,K,U,ht=q,ft=q;q===0?(z=0,ht=1,U=L,ft=y):(z=Y*L-y*O,U=N*L-Y*O,z<0?(z=0,U=L,ft=y):z>ht&&(z=ht,U=L+Y,ft=y)),U<0?(U=0,-O<0?z=0:-O>N?z=ht:(z=-O,ht=N)):U>ft&&(U=ft,-O+Y<0?z=0:-O+Y>N?z=ht:(z=-O+Y,ht=N)),V=z===0?0:z/ht,K=U===0?0:U/ft;var pt=(1-V)*l+V*x,mt=(1-V)*w+V*A,wt=(1-K)*T+K*P,gt=(1-K)*_+K*R,Bt=wt-pt,Xt=gt-mt;return Bt*Bt+Xt*Xt}function d(l,w){return l[0]===w[0]?l[1]-w[1]:l[0]-w[0]}function v(l){l.sort(d);for(var w=[],x=0;x<l.length;x++){for(;w.length>=2&&u(w[w.length-2],w[w.length-1],l[x])<=0;)w.pop();w.push(l[x])}for(var A=[],T=l.length-1;T>=0;T--){for(;A.length>=2&&u(A[A.length-2],A[A.length-1],l[T])<=0;)A.pop();A.push(l[T])}return A.pop(),w.pop(),w.concat(A)}return Fe.exports}var Fr=Cr();const Lr=Mr(Fr);function Sn(s,e={}){e.concavity=e.concavity||1/0;const t=[];if(an(s,i=>{t.push([i[0],i[1]])}),!t.length)return null;const n=Lr(t,e.concavity);return n.length>3?Oe([n]):null}var Se={exports:{}},Dr=Se.exports,En;function $r(){return En||(En=1,(function(s,e){(function(t,n){n(e)})(Dr,function(t){const n=11102230246251565e-32,i=134217729,r=(3+8*n)*n;function o(E,B,F,$,tt){let Q,et,st,it,at=B[0],ut=$[0],J=0,Z=0;ut>at==ut>-at?(Q=at,at=B[++J]):(Q=ut,ut=$[++Z]);let lt=0;if(J<E&&Z<F)for(ut>at==ut>-at?(et=at+Q,st=Q-(et-at),at=B[++J]):(et=ut+Q,st=Q-(et-ut),ut=$[++Z]),Q=et,st!==0&&(tt[lt++]=st);J<E&&Z<F;)ut>at==ut>-at?(et=Q+at,it=et-Q,st=Q-(et-it)+(at-it),at=B[++J]):(et=Q+ut,it=et-Q,st=Q-(et-it)+(ut-it),ut=$[++Z]),Q=et,st!==0&&(tt[lt++]=st);for(;J<E;)et=Q+at,it=et-Q,st=Q-(et-it)+(at-it),at=B[++J],Q=et,st!==0&&(tt[lt++]=st);for(;Z<F;)et=Q+ut,it=et-Q,st=Q-(et-it)+(ut-it),ut=$[++Z],Q=et,st!==0&&(tt[lt++]=st);return(Q!==0||lt===0)&&(tt[lt++]=Q),lt}function a(E,B){let F=B[0];for(let $=1;$<E;$++)F+=B[$];return F}function c(E){return new Float64Array(E)}const h=(3+16*n)*n,u=(2+12*n)*n,f=(9+64*n)*n*n,g=c(4),m=c(8),k=c(12),S=c(16),X=c(4);function C(E,B,F,$,tt,Q,et){let st,it,at,ut,J,Z,lt,_t,nt,H,W,yt,At,Pt,Rt,vt,It,Ft;const Vt=E-tt,Wt=F-tt,Jt=B-Q,Kt=$-Q;Pt=Vt*Kt,Z=i*Vt,lt=Z-(Z-Vt),_t=Vt-lt,Z=i*Kt,nt=Z-(Z-Kt),H=Kt-nt,Rt=_t*H-(Pt-lt*nt-_t*nt-lt*H),vt=Jt*Wt,Z=i*Jt,lt=Z-(Z-Jt),_t=Jt-lt,Z=i*Wt,nt=Z-(Z-Wt),H=Wt-nt,It=_t*H-(vt-lt*nt-_t*nt-lt*H),W=Rt-It,J=Rt-W,g[0]=Rt-(W+J)+(J-It),yt=Pt+W,J=yt-Pt,At=Pt-(yt-J)+(W-J),W=At-vt,J=At-W,g[1]=At-(W+J)+(J-vt),Ft=yt+W,J=Ft-yt,g[2]=yt-(Ft-J)+(W-J),g[3]=Ft;let fe=a(4,g),xe=u*et;if(fe>=xe||-fe>=xe||(J=E-Vt,st=E-(Vt+J)+(J-tt),J=F-Wt,at=F-(Wt+J)+(J-tt),J=B-Jt,it=B-(Jt+J)+(J-Q),J=$-Kt,ut=$-(Kt+J)+(J-Q),st===0&&it===0&&at===0&&ut===0)||(xe=f*et+r*Math.abs(fe),fe+=Vt*ut+Kt*st-(Jt*at+Wt*it),fe>=xe||-fe>=xe))return fe;Pt=st*Kt,Z=i*st,lt=Z-(Z-st),_t=st-lt,Z=i*Kt,nt=Z-(Z-Kt),H=Kt-nt,Rt=_t*H-(Pt-lt*nt-_t*nt-lt*H),vt=it*Wt,Z=i*it,lt=Z-(Z-it),_t=it-lt,Z=i*Wt,nt=Z-(Z-Wt),H=Wt-nt,It=_t*H-(vt-lt*nt-_t*nt-lt*H),W=Rt-It,J=Rt-W,X[0]=Rt-(W+J)+(J-It),yt=Pt+W,J=yt-Pt,At=Pt-(yt-J)+(W-J),W=At-vt,J=At-W,X[1]=At-(W+J)+(J-vt),Ft=yt+W,J=Ft-yt,X[2]=yt-(Ft-J)+(W-J),X[3]=Ft;const Kn=o(4,g,4,X,m);Pt=Vt*ut,Z=i*Vt,lt=Z-(Z-Vt),_t=Vt-lt,Z=i*ut,nt=Z-(Z-ut),H=ut-nt,Rt=_t*H-(Pt-lt*nt-_t*nt-lt*H),vt=Jt*at,Z=i*Jt,lt=Z-(Z-Jt),_t=Jt-lt,Z=i*at,nt=Z-(Z-at),H=at-nt,It=_t*H-(vt-lt*nt-_t*nt-lt*H),W=Rt-It,J=Rt-W,X[0]=Rt-(W+J)+(J-It),yt=Pt+W,J=yt-Pt,At=Pt-(yt-J)+(W-J),W=At-vt,J=At-W,X[1]=At-(W+J)+(J-vt),Ft=yt+W,J=Ft-yt,X[2]=yt-(Ft-J)+(W-J),X[3]=Ft;const Gn=o(Kn,m,4,X,k);Pt=st*ut,Z=i*st,lt=Z-(Z-st),_t=st-lt,Z=i*ut,nt=Z-(Z-ut),H=ut-nt,Rt=_t*H-(Pt-lt*nt-_t*nt-lt*H),vt=it*at,Z=i*it,lt=Z-(Z-it),_t=it-lt,Z=i*at,nt=Z-(Z-at),H=at-nt,It=_t*H-(vt-lt*nt-_t*nt-lt*H),W=Rt-It,J=Rt-W,X[0]=Rt-(W+J)+(J-It),yt=Pt+W,J=yt-Pt,At=Pt-(yt-J)+(W-J),W=At-vt,J=At-W,X[1]=At-(W+J)+(J-vt),Ft=yt+W,J=Ft-yt,X[2]=yt-(Ft-J)+(W-J),X[3]=Ft;const Qn=o(Gn,k,4,X,S);return S[Qn-1]}function d(E,B,F,$,tt,Q){const et=(B-Q)*(F-tt),st=(E-tt)*($-Q),it=et-st,at=Math.abs(et+st);return Math.abs(it)>=h*at?it:-C(E,B,F,$,tt,Q,at)}function v(E,B){var F,$,tt=0,Q,et,st,it,at,ut,J,Z=E[0],lt=E[1],_t=B.length;for(F=0;F<_t;F++){$=0;var nt=B[F],H=nt.length-1;if(ut=nt[0],ut[0]!==nt[H][0]&&ut[1]!==nt[H][1])throw new Error("First and last coordinates in a ring must be the same");for(et=ut[0]-Z,st=ut[1]-lt,$;$<H;$++){if(J=nt[$+1],it=J[0]-Z,at=J[1]-lt,st===0&&at===0){if(it<=0&&et>=0||et<=0&&it>=0)return 0}else if(at>=0&&st<=0||at<=0&&st>=0){if(Q=d(et,it,st,at,0,0),Q===0)return 0;(Q>0&&at>0&&st<=0||Q<0&&at<=0&&st>0)&&tt++}ut=J,st=at,et=it}}return tt%2!==0}function l(E,B,F={}){const $={type:"Feature"};return(F.id===0||F.id)&&($.id=F.id),F.bbox&&($.bbox=F.bbox),$.properties=B||{},$.geometry=E,$}function w(E,B,F={}){if(!E)throw new Error("coordinates is required");if(!Array.isArray(E))throw new Error("coordinates must be an Array");if(E.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!T(E[0])||!T(E[1]))throw new Error("coordinates must contain numbers");return l({type:"Point",coordinates:E},B,F)}function x(E,B,F={}){for(const $ of E){if($.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if($[$.length-1].length!==$[0].length)throw new Error("First and last Position are not equivalent.");for(let tt=0;tt<$[$.length-1].length;tt++)if($[$.length-1][tt]!==$[0][tt])throw new Error("First and last Position are not equivalent.")}return l({type:"Polygon",coordinates:E},B,F)}function A(E,B={}){const F={type:"FeatureCollection"};return B.id&&(F.id=B.id),B.bbox&&(F.bbox=B.bbox),F.features=E,F}function T(E){return!isNaN(E)&&E!==null&&!Array.isArray(E)}function _(E){if(!E)throw new Error("coord is required");if(!Array.isArray(E)){if(E.type==="Feature"&&E.geometry!==null&&E.geometry.type==="Point")return[...E.geometry.coordinates];if(E.type==="Point")return[...E.coordinates]}if(Array.isArray(E)&&E.length>=2&&!Array.isArray(E[0])&&!Array.isArray(E[1]))return[...E];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function P(E){if(Array.isArray(E))return E;if(E.type==="Feature"){if(E.geometry!==null)return E.geometry.coordinates}else if(E.coordinates)return E.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function R(E){return E.type==="Feature"?E.geometry:E}function D(E,B,F={}){if(!E)throw new Error("point is required");if(!B)throw new Error("polygon is required");const $=_(E),tt=R(B),Q=tt.type,et=B.bbox;let st=tt.coordinates;if(et&&G($,et)===!1)return!1;Q==="Polygon"&&(st=[st]);let it=!1;for(var at=0;at<st.length;++at){const ut=v($,st[at]);if(ut===0)return!F.ignoreBoundary;ut&&(it=!0)}return it}function G(E,B){return B[0]<=E[0]&&B[1]<=E[1]&&B[2]>=E[0]&&B[3]>=E[1]}var p=D;function M(E,B){for(let F=0;F<B.features.length;F++)if(p(E,B.features[F]))return B.features[F]}function b(E,B,F){const $=B.geometry.coordinates[0][0],tt=B.geometry.coordinates[0][1],Q=B.geometry.coordinates[0][2],et=E.geometry.coordinates,st=B.properties.a.geom,it=B.properties.b.geom,at=B.properties.c.geom,ut=[tt[0]-$[0],tt[1]-$[1]],J=[Q[0]-$[0],Q[1]-$[1]],Z=[et[0]-$[0],et[1]-$[1]],lt=[it[0]-st[0],it[1]-st[1]],_t=[at[0]-st[0],at[1]-st[1]];let nt=(J[1]*Z[0]-J[0]*Z[1])/(ut[0]*J[1]-ut[1]*J[0]),H=(ut[0]*Z[1]-ut[1]*Z[0])/(ut[0]*J[1]-ut[1]*J[0]);if(F){const W=F[B.properties.a.index],yt=F[B.properties.b.index],At=F[B.properties.c.index];let Pt;if(nt<0||H<0||1-nt-H<0){const Rt=nt/(nt+H),vt=H/(nt+H);Pt=nt/yt/(Rt/yt+vt/At),H=H/At/(Rt/yt+vt/At)}else Pt=nt/yt/(nt/yt+H/At+(1-nt-H)/W),H=H/At/(nt/yt+H/At+(1-nt-H)/W);nt=Pt}return[nt*lt[0]+H*_t[0]+st[0],nt*lt[1]+H*_t[1]+st[1]]}function I(E,B,F,$){const tt=E.geometry.coordinates,Q=F.geometry.coordinates,et=Math.atan2(tt[0]-Q[0],tt[1]-Q[1]),st=y(et,B[0]);if(st===void 0)throw new Error("Unable to determine vertex index");const it=B[1][st];return b(E,it.features[0],$)}function N(E,B,F,$,tt,Q,et,st){let it;if(et&&(it=M(E,A([et]))),!it){if(F){const at=E.geometry.coordinates,ut=F.gridNum,J=F.xOrigin,Z=F.yOrigin,lt=F.xUnit,_t=F.yUnit,nt=F.gridCache,H=Y(at[0],J,lt,ut),W=Y(at[1],Z,_t,ut),yt=nt[H]?nt[H][W]?nt[H][W]:[]:[];B=A(yt.map(At=>B.features[At]))}it=M(E,B)}return st&&st(it),it?b(E,it,Q):I(E,$,tt,Q)}function Y(E,B,F,$){let tt=Math.floor((E-B)/F);return tt>=$&&(tt=$-1),tt}function y(E,B){let F=O(E-B[0]),$=Math.PI*2,tt;for(let Q=0;Q<B.length;Q++){const et=(Q+1)%B.length,st=O(E-B[et]),it=Math.min(Math.abs(F),Math.abs(st));F*st<=0&&it<$&&($=it,tt=Q),F=st}return tt}function O(E,B=!1){const F=B?function($){return!($>=0&&$<Math.PI*2)}:function($){return!($>-1*Math.PI&&$<=Math.PI)};for(;F(E);)E=E+2*Math.PI*(E>0?-1:1);return E}function L(E,B){return B&&B>=2.00703||Array.isArray(E[0])?E:E.map(F=>[F.illstNodes,F.mercNodes,F.startEnd])}function q(E){const B=E.features;for(let F=0;F<B.length;F++){const $=B[F];`${$.properties.a.index}`.substring(0,1)==="b"&&`${$.properties.b.index}`.substring(0,1)==="b"?B[F]={geometry:{type:"Polygon",coordinates:[[$.geometry.coordinates[0][2],$.geometry.coordinates[0][0],$.geometry.coordinates[0][1],$.geometry.coordinates[0][2]]]},properties:{a:{geom:$.properties.c.geom,index:$.properties.c.index},b:{geom:$.properties.a.geom,index:$.properties.a.index},c:{geom:$.properties.b.geom,index:$.properties.b.index}},type:"Feature"}:`${$.properties.c.index}`.substring(0,1)==="b"&&`${$.properties.a.index}`.substring(0,1)==="b"&&(B[F]={geometry:{type:"Polygon",coordinates:[[$.geometry.coordinates[0][1],$.geometry.coordinates[0][2],$.geometry.coordinates[0][0],$.geometry.coordinates[0][1]]]},properties:{a:{geom:$.properties.b.geom,index:$.properties.b.index},b:{geom:$.properties.c.geom,index:$.properties.c.index},c:{geom:$.properties.a.geom,index:$.properties.a.index}},type:"Feature"})}return E}function V(E){const B=["a","b","c","a"].map(Q=>E.properties[Q].geom),F=E.geometry.coordinates[0],$=E.properties,tt={a:{geom:F[0],index:$.a.index},b:{geom:F[1],index:$.b.index},c:{geom:F[2],index:$.c.index}};return x([B],tt)}function z(E){const B=[0,1,2,0].map($=>E[$][0][0]),F={a:{geom:E[0][0][1],index:E[0][1]},b:{geom:E[1][0][1],index:E[1][1]},c:{geom:E[2][0][1],index:E[2][1]}};return x([B],F)}function K(E,B,F,$,tt,Q=!1,et){const st=E.map(it=>{(!et||et<2.00703)&&(it=U(it));const at=isFinite(it)?B[it]:it==="c"?$:it==="b0"?tt[0]:it==="b1"?tt[1]:it==="b2"?tt[2]:it==="b3"?tt[3]:(function(){const ut=it.match(/e(\d+)/);if(ut){const J=parseInt(ut[1]);return F[J]}throw"Bad index value for indexesToTri"})();return Q?[[at[1],at[0]],it]:[[at[0],at[1]],it]});return z(st)}function U(E){return typeof E=="number"?E:E.replace(/^(c|e|b)(?:ent|dgeNode|box)(\d+)?$/,"$1$2")}const ht=2.00703;function ft(E){return!!(E.version||!E.tins&&E.points&&E.tins_points)}function pt(E){return{points:E.points,pointsWeightBuffer:wt(E),strictStatus:gt(E),verticesParams:Bt(E),centroid:Mt(E),edges:L(E.edges||[]),edgeNodes:E.edgeNodes||[],tins:kt(E),kinks:Qt(E.kinks_points),yaxisMode:E.yaxisMode??"invert",strictMode:E.strictMode??"auto",vertexMode:E.vertexMode,bounds:E.bounds,boundsPolygon:E.boundsPolygon,wh:E.wh,xy:E.bounds?E.xy:[0,0]}}function mt(E){const B=he(E),F=B.tins;return{compiled:B,tins:F,points:Ve(F),strictStatus:B.strict_status,pointsWeightBuffer:B.weight_buffer,verticesParams:B.vertices_params,centroid:B.centroid,kinks:B.kinks}}function wt(E){return!E.version||E.version<ht?["forw","bakw"].reduce((B,F)=>{const $=E.weight_buffer[F];return $&&(B[F]=Object.keys($).reduce((tt,Q)=>{const et=U(Q);return tt[et]=$[Q],tt},{})),B},{}):E.weight_buffer}function gt(E){return E.strict_status?E.strict_status:E.kinks_points?"strict_error":E.tins_points.length===2?"loose":"strict"}function Bt(E){const B={forw:[E.vertices_params[0]],bakw:[E.vertices_params[1]]};return B.forw[1]=Xt(E,!1),B.bakw[1]=Xt(E,!0),B}function Xt(E,B){return[0,1,2,3].map(F=>{const $=(F+1)%4,tt=K(["c",`b${F}`,`b${$}`],E.points,E.edgeNodes||[],E.centroid_point,E.vertices_points,B,ht);return A([tt])})}function Mt(E){return{forw:w(E.centroid_point[0],{target:{geom:E.centroid_point[1],index:"c"}}),bakw:w(E.centroid_point[1],{target:{geom:E.centroid_point[0],index:"c"}})}}function kt(E){const B=E.tins_points.length===1?0:1;return{forw:A(E.tins_points[0].map(F=>K(F,E.points,E.edgeNodes||[],E.centroid_point,E.vertices_points,!1,E.version))),bakw:A(E.tins_points[B].map(F=>K(F,E.points,E.edgeNodes||[],E.centroid_point,E.vertices_points,!0,E.version)))}}function Qt(E){if(E)return{bakw:A(E.map(B=>w(B)))}}function he(E){return JSON.parse(JSON.stringify(E).replace('"cent"','"c"').replace(/"bbox(\d+)"/g,'"b$1"'))}function Ve(E){const B=[],F=E.forw.features;for(let $=0;$<F.length;$++){const tt=F[$];["a","b","c"].map((Q,et)=>{const st=tt.geometry.coordinates[0][et],it=tt.properties[Q].geom,at=tt.properties[Q].index;typeof at=="number"&&(B[at]=[st,it])})}return B}const We=ht,Yt=class Yt{constructor(){ct(this,"points",[]);ct(this,"pointsWeightBuffer");ct(this,"strict_status");ct(this,"vertices_params");ct(this,"centroid");ct(this,"edgeNodes");ct(this,"edges");ct(this,"tins");ct(this,"kinks");ct(this,"yaxisMode",Yt.YAXIS_INVERT);ct(this,"strictMode",Yt.MODE_AUTO);ct(this,"vertexMode",Yt.VERTEX_PLAIN);ct(this,"bounds");ct(this,"boundsPolygon");ct(this,"wh");ct(this,"xy");ct(this,"indexedTins");ct(this,"stateFull",!1);ct(this,"stateTriangle");ct(this,"stateBackward")}setCompiled(B){if(ft(B)){this.applyModernState(pt(B));return}this.applyLegacyState(mt(B))}applyModernState(B){this.points=B.points,this.pointsWeightBuffer=B.pointsWeightBuffer,this.strict_status=B.strictStatus,this.vertices_params=B.verticesParams,this.centroid=B.centroid,this.edges=B.edges,this.edgeNodes=B.edgeNodes||[],this.tins=B.tins,this.addIndexedTin(),this.kinks=B.kinks,this.yaxisMode=B.yaxisMode??Yt.YAXIS_INVERT,this.vertexMode=B.vertexMode??Yt.VERTEX_PLAIN,this.strictMode=B.strictMode??Yt.MODE_AUTO,B.bounds?(this.bounds=B.bounds,this.boundsPolygon=B.boundsPolygon,this.xy=B.xy,this.wh=B.wh):(this.bounds=void 0,this.boundsPolygon=void 0,this.xy=B.xy??[0,0],B.wh&&(this.wh=B.wh))}applyLegacyState(B){this.tins=B.tins,this.addIndexedTin(),this.strict_status=B.strictStatus,this.pointsWeightBuffer=B.pointsWeightBuffer,this.vertices_params=B.verticesParams,this.centroid=B.centroid,this.kinks=B.kinks,this.points=B.points}addIndexedTin(){const B=this.tins,F=B.forw,$=B.bakw,tt=Math.ceil(Math.sqrt(F.features.length));if(tt<3){this.indexedTins=void 0;return}let Q=[],et=[];const st=F.features.map(nt=>{let H=[];return P(nt)[0].map(W=>{Q.length===0?Q=[Array.from(W),Array.from(W)]:(W[0]<Q[0][0]&&(Q[0][0]=W[0]),W[0]>Q[1][0]&&(Q[1][0]=W[0]),W[1]<Q[0][1]&&(Q[0][1]=W[1]),W[1]>Q[1][1]&&(Q[1][1]=W[1])),H.length===0?H=[Array.from(W),Array.from(W)]:(W[0]<H[0][0]&&(H[0][0]=W[0]),W[0]>H[1][0]&&(H[1][0]=W[0]),W[1]<H[0][1]&&(H[0][1]=W[1]),W[1]>H[1][1]&&(H[1][1]=W[1]))}),H}),it=(Q[1][0]-Q[0][0])/tt,at=(Q[1][1]-Q[0][1])/tt,ut=st.reduce((nt,H,W)=>{const yt=Y(H[0][0],Q[0][0],it,tt),At=Y(H[1][0],Q[0][0],it,tt),Pt=Y(H[0][1],Q[0][1],at,tt),Rt=Y(H[1][1],Q[0][1],at,tt);for(let vt=yt;vt<=At;vt++){nt[vt]||(nt[vt]=[]);for(let It=Pt;It<=Rt;It++)nt[vt][It]||(nt[vt][It]=[]),nt[vt][It].push(W)}return nt},[]),J=$.features.map(nt=>{let H=[];return P(nt)[0].map(W=>{et.length===0?et=[Array.from(W),Array.from(W)]:(W[0]<et[0][0]&&(et[0][0]=W[0]),W[0]>et[1][0]&&(et[1][0]=W[0]),W[1]<et[0][1]&&(et[0][1]=W[1]),W[1]>et[1][1]&&(et[1][1]=W[1])),H.length===0?H=[Array.from(W),Array.from(W)]:(W[0]<H[0][0]&&(H[0][0]=W[0]),W[0]>H[1][0]&&(H[1][0]=W[0]),W[1]<H[0][1]&&(H[0][1]=W[1]),W[1]>H[1][1]&&(H[1][1]=W[1]))}),H}),Z=(et[1][0]-et[0][0])/tt,lt=(et[1][1]-et[0][1])/tt,_t=J.reduce((nt,H,W)=>{const yt=Y(H[0][0],et[0][0],Z,tt),At=Y(H[1][0],et[0][0],Z,tt),Pt=Y(H[0][1],et[0][1],lt,tt),Rt=Y(H[1][1],et[0][1],lt,tt);for(let vt=yt;vt<=At;vt++){nt[vt]||(nt[vt]=[]);for(let It=Pt;It<=Rt;It++)nt[vt][It]||(nt[vt][It]=[]),nt[vt][It].push(W)}return nt},[]);this.indexedTins={forw:{gridNum:tt,xOrigin:Q[0][0],yOrigin:Q[0][1],xUnit:it,yUnit:at,gridCache:ut},bakw:{gridNum:tt,xOrigin:et[0][0],yOrigin:et[0][1],xUnit:Z,yUnit:lt,gridCache:_t}}}transform(B,F,$){if(F&&this.strict_status==Yt.STATUS_ERROR)throw'Backward transform is not allowed if strict_status == "strict_error"';this.yaxisMode==Yt.YAXIS_FOLLOW&&F&&(B=[B[0],-1*B[1]]);const tt=w(B);if(this.bounds&&!F&&!$&&!p(tt,this.boundsPolygon))return!1;const Q=F?this.tins.bakw:this.tins.forw,et=F?this.indexedTins.bakw:this.indexedTins.forw,st=F?this.vertices_params.bakw:this.vertices_params.forw,it=F?this.centroid.bakw:this.centroid.forw,at=F?this.pointsWeightBuffer.bakw:this.pointsWeightBuffer.forw;let ut,J;this.stateFull&&(this.stateBackward==F?ut=this.stateTriangle:(this.stateBackward=F,this.stateTriangle=void 0),J=lt=>{this.stateTriangle=lt});let Z=N(tt,Q,et,st,it,at,ut,J);if(this.bounds&&F&&!$){const lt=w(Z);if(!p(lt,this.boundsPolygon))return!1}else this.yaxisMode==Yt.YAXIS_FOLLOW&&!F&&(Z=[Z[0],-1*Z[1]]);return Z}};ct(Yt,"VERTEX_PLAIN","plain"),ct(Yt,"VERTEX_BIRDEYE","birdeye"),ct(Yt,"MODE_STRICT","strict"),ct(Yt,"MODE_AUTO","auto"),ct(Yt,"MODE_LOOSE","loose"),ct(Yt,"STATUS_STRICT","strict"),ct(Yt,"STATUS_ERROR","strict_error"),ct(Yt,"STATUS_LOOSE","loose"),ct(Yt,"YAXIS_FOLLOW","follow"),ct(Yt,"YAXIS_INVERT","invert");let be=Yt;t.Transform=be,t.counterTri=V,t.format_version=We,t.normalizeEdges=L,t.rotateVerticesTriangle=q,t.transformArr=N,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})})(Se,Se.exports)),Se.exports}var zt=$r();const An=Math.pow(2,-52),Le=new Uint32Array(512);class cn{static from(e,t=Vr,n=Wr){const i=e.length,r=new Float64Array(i*2);for(let o=0;o<i;o++){const a=e[o];r[2*o]=t(a),r[2*o+1]=n(a)}return new cn(r)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:i,_hullHash:r}=this,o=e.length>>1;let a=1/0,c=1/0,h=-1/0,u=-1/0;for(let _=0;_<o;_++){const P=e[2*_],R=e[2*_+1];P<a&&(a=P),R<c&&(c=R),P>h&&(h=P),R>u&&(u=R),this._ids[_]=_}const f=(a+h)/2,g=(c+u)/2;let m,k,S;for(let _=0,P=1/0;_<o;_++){const R=rn(f,g,e[2*_],e[2*_+1]);R<P&&(m=_,P=R)}const X=e[2*m],C=e[2*m+1];for(let _=0,P=1/0;_<o;_++){if(_===m)continue;const R=rn(X,C,e[2*_],e[2*_+1]);R<P&&R>0&&(k=_,P=R)}let d=e[2*k],v=e[2*k+1],l=1/0;for(let _=0;_<o;_++){if(_===m||_===k)continue;const P=Ur(X,C,d,v,e[2*_],e[2*_+1]);P<l&&(S=_,l=P)}let w=e[2*S],x=e[2*S+1];if(l===1/0){for(let R=0;R<o;R++)this._dists[R]=e[2*R]-e[0]||e[2*R+1]-e[1];ye(this._ids,this._dists,0,o-1);const _=new Uint32Array(o);let P=0;for(let R=0,D=-1/0;R<o;R++){const G=this._ids[R],p=this._dists[G];p>D&&(_[P++]=G,D=p)}this.hull=_.subarray(0,P),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(ee(X,C,d,v,w,x)<0){const _=k,P=d,R=v;k=S,d=w,v=x,S=_,w=P,x=R}const A=zr(X,C,d,v,w,x);this._cx=A.x,this._cy=A.y;for(let _=0;_<o;_++)this._dists[_]=rn(e[2*_],e[2*_+1],A.x,A.y);ye(this._ids,this._dists,0,o-1),this._hullStart=m;let T=3;n[m]=t[S]=k,n[k]=t[m]=S,n[S]=t[k]=m,i[m]=0,i[k]=1,i[S]=2,r.fill(-1),r[this._hashKey(X,C)]=m,r[this._hashKey(d,v)]=k,r[this._hashKey(w,x)]=S,this.trianglesLen=0,this._addTriangle(m,k,S,-1,-1,-1);for(let _=0,P,R;_<this._ids.length;_++){const D=this._ids[_],G=e[2*D],p=e[2*D+1];if(_>0&&Math.abs(G-P)<=An&&Math.abs(p-R)<=An||(P=G,R=p,D===m||D===k||D===S))continue;let M=0;for(let y=0,O=this._hashKey(G,p);y<this._hashSize&&(M=r[(O+y)%this._hashSize],!(M!==-1&&M!==n[M]));y++);M=t[M];let b=M,I;for(;I=n[b],ee(G,p,e[2*b],e[2*b+1],e[2*I],e[2*I+1])>=0;)if(b=I,b===M){b=-1;break}if(b===-1)continue;let N=this._addTriangle(b,D,n[b],-1,-1,i[b]);i[D]=this._legalize(N+2),i[b]=N,T++;let Y=n[b];for(;I=n[Y],ee(G,p,e[2*Y],e[2*Y+1],e[2*I],e[2*I+1])<0;)N=this._addTriangle(Y,D,I,i[D],-1,i[Y]),i[D]=this._legalize(N+2),n[Y]=Y,T--,Y=I;if(b===M)for(;I=t[b],ee(G,p,e[2*I],e[2*I+1],e[2*b],e[2*b+1])<0;)N=this._addTriangle(I,D,b,-1,i[b],i[I]),this._legalize(N+2),i[I]=N,n[b]=b,T--,b=I;this._hullStart=t[D]=b,n[b]=t[Y]=D,n[D]=Y,r[this._hashKey(G,p)]=D,r[this._hashKey(e[2*b],e[2*b+1])]=b}this.hull=new Uint32Array(T);for(let _=0,P=this._hullStart;_<T;_++)this.hull[_]=P,P=n[P];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(qr(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:i}=this;let r=0,o=0;for(;;){const a=n[e],c=e-e%3;if(o=c+(e+2)%3,a===-1){if(r===0)break;e=Le[--r];continue}const h=a-a%3,u=c+(e+1)%3,f=h+(a+2)%3,g=t[o],m=t[e],k=t[u],S=t[f];if(jr(i[2*g],i[2*g+1],i[2*m],i[2*m+1],i[2*k],i[2*k+1],i[2*S],i[2*S+1])){t[e]=S,t[a]=g;const C=n[f];if(C===-1){let v=this._hullStart;do{if(this._hullTri[v]===f){this._hullTri[v]=e;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(e,C),this._link(a,n[o]),this._link(o,f);const d=h+(a+1)%3;r<Le.length&&(Le[r++]=d)}else{if(r===0)break;e=Le[--r]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,n,i,r,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,i),this._link(a+1,r),this._link(a+2,o),this.trianglesLen+=3,a}}function qr(s,e){const t=s/(Math.abs(s)+Math.abs(e));return(e>0?3-t:1+t)/4}function rn(s,e,t,n){const i=s-t,r=e-n;return i*i+r*r}function jr(s,e,t,n,i,r,o,a){const c=s-o,h=e-a,u=t-o,f=n-a,g=i-o,m=r-a,k=c*c+h*h,S=u*u+f*f,X=g*g+m*m;return c*(f*X-S*m)-h*(u*X-S*g)+k*(u*m-f*g)<0}function Ur(s,e,t,n,i,r){const o=t-s,a=n-e,c=i-s,h=r-e,u=o*o+a*a,f=c*c+h*h,g=.5/(o*h-a*c),m=(h*u-a*f)*g,k=(o*f-c*u)*g;return m*m+k*k}function zr(s,e,t,n,i,r){const o=t-s,a=n-e,c=i-s,h=r-e,u=o*o+a*a,f=c*c+h*h,g=.5/(o*h-a*c),m=s+(h*u-a*f)*g,k=e+(o*f-c*u)*g;return{x:m,y:k}}function ye(s,e,t,n){if(n-t<=20)for(let i=t+1;i<=n;i++){const r=s[i],o=e[r];let a=i-1;for(;a>=t&&e[s[a]]>o;)s[a+1]=s[a--];s[a+1]=r}else{const i=t+n>>1;let r=t+1,o=n;Me(s,i,r),e[s[t]]>e[s[n]]&&Me(s,t,n),e[s[r]]>e[s[n]]&&Me(s,r,n),e[s[t]]>e[s[r]]&&Me(s,t,r);const a=s[r],c=e[a];for(;;){do r++;while(e[s[r]]<c);do o--;while(e[s[o]]>c);if(o<r)break;Me(s,r,o)}s[t+1]=s[o],s[o]=a,n-r+1>=o-t?(ye(s,e,r,n),ye(s,e,t,o-1)):(ye(s,e,t,o-1),ye(s,e,r,n))}}function Me(s,e,t){const n=s[e];s[e]=s[t],s[t]=n}function Vr(s){return s[0]}function Wr(s){return s[1]}class Jr{constructor(e,t){ct(this,"bs");ct(this,"width");this.width=e,this.bs=t}add(e){const t=Math.floor(e/this.width),n=e%this.width;return this.bs[t]|=1<<n,this}delete(e){const t=Math.floor(e/this.width),n=e%this.width;return this.bs[t]&=~(1<<n),this}set(e,t){const n=Math.floor(e/this.width),r=1<<e%this.width;return this.bs[n]^=(-Number(t)^this.bs[n])&r,t}has(e){const t=Math.floor(e/this.width),n=e%this.width;return(this.bs[t]&1<<n)!==0}forEach(e){const t=this.bs.length;for(let n=0;n<t;n++){let i=0;for(;this.bs[n]&&i<this.width;)this.bs[n]&1<<i&&e(n*this.width+i),i++}return this}}class Pn extends Jr{constructor(e){super(8,new Uint8Array(Math.ceil(e/8)).fill(0))}}function de(s){return s%3===2?s-2:s+1}function ne(s){return s%3===0?s+2:s-1}function Bn(s,e,t,n,i,r,o,a){const c=ee(s,e,i,r,o,a),h=ee(t,n,i,r,o,a);if(c>0&&h>0||c<0&&h<0)return!1;const u=ee(i,r,s,e,t,n),f=ee(o,a,s,e,t,n);return u>0&&f>0||u<0&&f<0?!1:c===0&&h===0&&u===0&&f===0?!(Math.max(i,o)<Math.min(s,t)||Math.max(s,t)<Math.min(i,o)||Math.max(r,a)<Math.min(e,n)||Math.max(e,n)<Math.min(r,a)):!0}class Kr{constructor(e){ct(this,"del");this.del=e}}class $n extends Kr{constructor(t,n){if(!t||typeof t!="object"||!t.triangles||!t.halfedges||!t.coords)throw new Error("Expected an object with Delaunator output");if(t.triangles.length%3||t.halfedges.length!==t.triangles.length||t.coords.length%2)throw new Error("Delaunator output appears inconsistent");if(t.triangles.length<3)throw new Error("No edges in triangulation");super(t);ct(this,"vertMap");ct(this,"flips");ct(this,"consd");const i=2**32-1,r=t.coords.length>>1,o=t.triangles.length;this.vertMap=new Uint32Array(r).fill(i),this.flips=new Pn(o),this.consd=new Pn(o);for(let a=0;a<o;a++){const c=t.triangles[a];this.vertMap[c]===i&&this.updateVert(a)}n&&this.constrainAll(n)}constrainOne(t,n){const{triangles:i,halfedges:r}=this.del,o=this.vertMap[t];let a=o;do{const u=i[a],f=de(a);if(u===n)return this.protect(a);const g=ne(a),m=i[g];if(m===n)return this.protect(f),f;if(this.intersectSegments(t,n,m,u)){a=g;break}a=r[f]}while(a!==-1&&a!==o);let c=a,h=-1;for(;a!==-1;){const u=r[a],f=ne(a),g=ne(u),m=de(u);if(u===-1)throw new Error("Constraining edge exited the hull");if(this.consd.has(a))throw new Error("Edge intersects already constrained edge");if(this.isCollinear(t,n,i[a])||this.isCollinear(t,n,i[u]))throw new Error("Constraining edge intersects point");if(!this.intersectSegments(i[a],i[u],i[f],i[g])){if(h===-1&&(h=a),i[g]===n){if(a===h)throw new Error("Infinite loop: non-convex quadrilateral");a=h,h=-1;continue}if(this.intersectSegments(t,n,i[g],i[u]))a=g;else if(this.intersectSegments(t,n,i[m],i[g]))a=m;else if(h===a)throw new Error("Infinite loop: no further intersect after non-convex");continue}if(this.flipDiagonal(a),this.intersectSegments(t,n,i[f],i[g])&&(h===-1&&(h=f),h===f))throw new Error("Infinite loop: flipped diagonal still intersects");i[g]===n?(c=g,a=h,h=-1):this.intersectSegments(t,n,i[m],i[g])&&(a=m)}return this.protect(c),this.delaunify(!0),this.findEdge(t,n)}delaunify(t=!1){const{halfedges:n}=this.del,i=this.flips,r=this.consd,o=n.length;let a;do{a=0;for(let c=0;c<o;c++){if(r.has(c))continue;i.delete(c);const h=n[c];h!==-1&&(i.delete(h),this.isDelaunay(c)||(this.flipDiagonal(c),a++))}}while(t&&a>0);return this}constrainAll(t){const n=t.length;for(let i=0;i<n;i++){const r=t[i];this.constrainOne(r[0],r[1])}return this}isConstrained(t){return this.consd.has(t)}findEdge(t,n){const i=this.vertMap[n],{triangles:r,halfedges:o}=this.del;let a=i,c=-1;do{if(r[a]===t)return a;c=de(a),a=o[c]}while(a!==-1&&a!==i);return r[de(c)]===t?-c:1/0}protect(t){const n=this.del.halfedges[t],i=this.flips,r=this.consd;return i.delete(t),r.add(t),n!==-1?(i.delete(n),r.add(n),n):-t}markFlip(t){const n=this.del.halfedges,i=this.flips;if(this.consd.has(t))return!1;const o=n[t];return o!==-1&&(i.add(t),i.add(o)),!0}flipDiagonal(t){const{triangles:n,halfedges:i}=this.del,r=this.flips,o=this.consd,a=i[t],c=ne(t),h=de(t),u=ne(a),f=de(a),g=i[c],m=i[u];if(o.has(t))throw new Error("Trying to flip a constrained edge");return n[t]=n[u],i[t]=m,r.set(t,r.has(u))||o.set(t,o.has(u)),m!==-1&&(i[m]=t),i[c]=u,n[a]=n[c],i[a]=g,r.set(a,r.has(c))||o.set(a,o.has(c)),g!==-1&&(i[g]=a),i[u]=c,this.markFlip(t),this.markFlip(h),this.markFlip(a),this.markFlip(f),r.add(c),o.delete(c),r.add(u),o.delete(u),this.updateVert(t),this.updateVert(h),this.updateVert(a),this.updateVert(f),c}isCollinear(t,n,i){const r=this.del.coords;return ee(r[t*2],r[t*2+1],r[n*2],r[n*2+1],r[i*2],r[i*2+1])===0}inCircle(t,n,i,r){const o=this.del.coords;return fr(o[t*2],o[t*2+1],o[n*2],o[n*2+1],o[i*2],o[i*2+1],o[r*2],o[r*2+1])<0}isDelaunay(t){const{triangles:n,halfedges:i}=this.del,r=i[t];if(r===-1)return!0;const o=n[ne(t)],a=n[t],c=n[de(t)],h=n[ne(r)];return!this.inCircle(o,a,c,h)}updateVert(t){const{triangles:n,halfedges:i}=this.del,r=this.vertMap,o=n[t];let a=ne(t),c=i[a];for(;c!==-1&&c!==t;)a=ne(c),c=i[a];return r[o]=a,a}intersectSegments(t,n,i,r){const o=this.del.coords;return t===i||t===r||n===i||n===r?!1:Bn(o[t*2],o[t*2+1],o[n*2],o[n*2+1],o[i*2],o[i*2+1],o[r*2],o[r*2+1])}}ct($n,"intersectSegments",Bn);function Ee(s,e,t){if(e||(e=[]),typeof s!="object"||s.type!=="FeatureCollection")throw"Argument points must be FeatureCollection";if(!Array.isArray(e))throw"Argument points must be Array of Array";const n=s.features.map(c=>c.geometry.coordinates),i=cn.from(n);let r;const o=[];i.triangles.length!==0&&e.length!==0&&(r=new $n(i),r.constrainAll(e));for(let c=0;c<i.triangles.length;c+=3)o.push([i.triangles[c],i.triangles[c+1],i.triangles[c+2]]);const a=["a","b","c"];return Gt(o.map(c=>{const h={},u=c.map((f,g)=>{const m=s.features[f],k=m.geometry.coordinates,S=[k[0],k[1]];return k.length===3?S[2]=k[2]:h[a[g]]=m.properties[t],S});return u[3]=u[0],Oe([u],h)}))}function qn(s,e,t,n,i,r){return Object.keys(s).reduce((o,a)=>{const c=s[a],h=c.forw,u=c.bakw,f={forw:[h[0]-e.forw[0],h[1]-e.forw[1]],bakw:[u[0]-e.bakw[0],u[1]-e.bakw[1]]},g=f.forw[0]===0?1/0:((f.forw[0]<0?t:n)-e.forw[0])/f.forw[0],m=f.forw[1]===0?1/0:((f.forw[1]<0?i:r)-e.forw[1])/f.forw[1];if(Math.abs(g)/Math.abs(m)<1.1){const k={forw:[f.forw[0]*g+e.forw[0],f.forw[1]*g+e.forw[1]],bakw:[f.bakw[0]*g+e.bakw[0],f.bakw[1]*g+e.bakw[1]]};f.forw[0]<0?o[3].push(k):o[1].push(k)}if(Math.abs(m)/Math.abs(g)<1.1){const k={forw:[f.forw[0]*m+e.forw[0],f.forw[1]*m+e.forw[1]],bakw:[f.bakw[0]*m+e.bakw[0],f.bakw[1]*m+e.bakw[1]]};f.forw[1]<0?o[0].push(k):o[2].push(k)}return o},[[],[],[],[]])}function Gr(s,e){const t=[[],[],[],[]],n=[];return Object.keys(s).forEach(i=>{const r=s[i],o=r.forw,a=r.bakw,c=[o[0]-e.forw[0],o[1]-e.forw[1]],h=[a[0]-e.bakw[0],e.bakw[1]-a[1]],u={forw:c,bakw:h};if(n.push(u),c[0]===0||c[1]===0)return;let f=0;c[0]>0&&(f+=1),c[1]>0&&(f+=2),t[f].push(u)}),{perQuad:t,aggregate:n}}function Qr(s){let e=1/0,t=0,n=0;return s.forEach(i=>{const{forw:r,bakw:o}=i,a=Math.hypot(r[0],r[1]),c=Math.hypot(o[0],o[1]);if(c===0)return;const h=a/c,u=Math.atan2(r[0],r[1])-Math.atan2(o[0],o[1]);e=Math.min(e,h),t+=Math.cos(u),n+=Math.sin(u)}),isFinite(e)?[e,Math.atan2(n,t)]:[1,0]}function jn(s,e,t){const{perQuad:n,aggregate:i}=Gr(s,e),r=n.every(c=>c.length>0),a=(t==="birdeye"?r?n:[i]:[i]).map(c=>Qr(c));return a.length===1?[a[0],a[0],a[0],a[0]]:a}function Hr(s,e,t){const n=[1,1,1,1];for(let i=0;i<4;i++){const r=(i+1)%4,o=ln([s[i].bakw,s[r].bakw]);e[i].map(a=>{const c=ln([t.bakw,a.bakw]),h=_r(o,c);if(h.features.length>0&&h.features[0].geometry){const u=h.features[0],f=Math.sqrt(Math.pow(a.bakw[0]-t.bakw[0],2)+Math.pow(a.bakw[1]-t.bakw[1],2)),g=Math.sqrt(Math.pow(u.geometry.coordinates[0]-t.bakw[0],2)+Math.pow(u.geometry.coordinates[1]-t.bakw[1],2)),m=f/g;m>n[i]&&(n[i]=m),m>n[r]&&(n[r]=m)}})}s.forEach((i,r)=>{const o=n[r],a=[(i.bakw[0]-t.bakw[0])*o+t.bakw[0],(i.bakw[1]-t.bakw[1])*o+t.bakw[1]];i.bakw=a})}function Un(s,e,t,n){const i=s.map((o,a)=>{const c=e[a],h=[c[0]-t.forw[0],c[1]-t.forw[1]],f=Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2))/o[0],g=Math.atan2(h[0],h[1])-o[1],m=[t.bakw[0]+f*Math.sin(g),t.bakw[1]-f*Math.cos(g)];return{forw:c,bakw:m}}),r=i[2];return i[2]=i[3],i[3]=r,Hr(i,n,t),i}function Zr(s){const{convexBuf:e,centroid:t,bbox:n,minx:i,maxx:r,miny:o,maxy:a}=s,c=qn(e,t,i,r,o,a),h=jn(e,t,"plain");return Un(h,n,t,c)}function ti(s){const{convexBuf:e,centroid:t,bbox:n,minx:i,maxx:r,miny:o,maxy:a}=s,c=qn(e,t,i,r,o,a),h=jn(e,t,"birdeye");return Un(h,n,t,c)}function zn(s){const t=new ei(s).findSegmentIntersections(),n=Jn(t),i=new Map;return n.forEach(r=>{i.set(`${r.x}:${r.y}`,r)}),Array.from(i.values()).map(r=>me([r.x,r.y]))}class ei{constructor(e){ct(this,"_xx");ct(this,"_yy");ct(this,"_ii");ct(this,"_nn");ct(this,"_zz");ct(this,"_zlimit",0);ct(this,"_bb");ct(this,"_allBounds");ct(this,"_arcIter");ct(this,"_filteredArcIter");ct(this,"buf");this.initArcs(e)}initArcs(e){const t=[],n=[],i=e.map(r=>{const o=r?r.length:0;for(let a=0;a<o;a++)t.push(r[a][0]),n.push(r[a][1]);return o});this.initXYData(i,t,n)}initXYData(e,t,n){const i=e.length;this._xx=new Float64Array(t),this._yy=new Float64Array(n),this._nn=new Uint32Array(e),this._zz=null,this._zlimit=0,this._filteredArcIter=null,this._ii=new Uint32Array(i);let r=0;for(let o=0;o<i;o++)this._ii[o]=r,r+=e[o];(r!=this._xx.length||this._xx.length!=this._yy.length)&&hn("ArcCollection#initXYData() Counting error"),this.initBounds(),this._arcIter=new xi(this._xx,this._yy)}initBounds(){const e=this.calcArcBounds_(this._xx,this._yy,this._nn);this._bb=e.bb,this._allBounds=e.bounds}calcArcBounds_(e,t,n){const i=n.length,r=new Float64Array(i*4),o=new Ue;let a=0,c,h,u;for(let f=0;f<i;f++)c=n[f],c>0&&(h=f*4,u=_i(e,t,a,c),r[h++]=u[0],r[h++]=u[1],r[h++]=u[2],r[h]=u[3],a+=c,o.mergeBounds(u));return{bb:r,bounds:o}}getBounds(){return this._allBounds.clone()}forEachSegment(e){let t=0;for(let n=0,i=this.size();n<i;n++)t+=this.forEachArcSegment(n,e);return t}size(){return this._ii&&this._ii.length||0}forEachArcSegment(e,t){const n=e>=0,i=n?e:~e,r=this.getRetainedInterval(),o=this._nn[i],a=n?1:-1;let c=n?this._ii[i]:this._ii[i]+o-1,h=c,u=0;for(let f=1;f<o;f++)h+=a,(r===0||this._zz[h]>=r)&&(t(c,h,this._xx,this._yy),c=h,u++);return u}getRetainedInterval(){return this._zlimit}getVertexData(){return{xx:this._xx,yy:this._yy,zz:this._zz,bb:this._bb,nn:this._nn,ii:this._ii}}getUint32Array(e){const t=e*4;return(!this.buf||this.buf.byteLength<t)&&(this.buf=new ArrayBuffer(t)),new Uint32Array(this.buf,0,e)}getAvgSegment2(){let e=0,t=0;const n=this.forEachSegment((i,r,o,a)=>{e+=Math.abs(o[i]-o[r]),t+=Math.abs(a[i]-a[r])});return[e/n||0,t/n||0]}calcSegmentIntersectionStripeCount(){const e=this.getBounds().height(),t=this.getAvgSegment2()[1];let n=1;return t>0&&e>0&&(n=Math.ceil(e/t/20)),n||1}findSegmentIntersections(){const e=this.getBounds(),t=e.ymin,n=e.ymax-t,i=this.calcSegmentIntersectionStripeCount(),r=new Uint32Array(i),o=i>1?S=>Math.floor((i-1)*(S-t)/n):()=>0;let a,c;this.forEachSegment((S,X,C,d)=>{let v=o(d[S]);const l=o(d[X]);for(;r[v]=r[v]+2,v!=l;)v+=l>v?1:-1});const h=this.getUint32Array(ii(r));let u=0;const f=[];si(r,S=>{const X=u;u+=S,f.push(h.subarray(X,u))}),oi(r,0),this.forEachSegment((S,X,C,d)=>{let v=o(d[S]);const l=o(d[X]);let w,x;for(;w=r[v],r[v]=w+2,x=f[v],x[w]=S,x[w+1]=X,v!=l;)v+=l>v?1:-1});const g=this.getVertexData(),m=[];let k;for(a=0;a<i;a++)for(k=ai(f[a],g.xx,g.yy),c=0;c<k.length;c++)m.push(k[c]);return Jn(m)}}function hn(...s){const e=s.join(" ");throw new Error(e)}function fn(s){return s?ri(s)?!0:ni(s)?!1:s.length===0?!0:s.length>0:!1}function ni(s){return s!=null&&s.toString===String.prototype.toString}function ri(s){return Array.isArray(s)}function ii(s,e){fn(s)||hn("utils.sum() expects an array, received:",s);let t=0,n;for(let i=0,r=s.length;i<r;i++)n=s[i],n&&(t+=n);return t}function si(s,e,t){if(!fn(s))throw new Error(`#forEach() takes an array-like argument. ${s}`);for(let n=0,i=s.length;n<i;n++)e.call(t,s[n],n)}function oi(s,e){for(let t=0,n=s.length;t<n;t++)s[t]=e;return s}function ai(s,e,t){const n=s.length-2,i=[];let r,o,a,c,h,u,f,g,m,k,S,X,C,d,v,l,w;for(wi(e,s),l=0;l<n;){for(r=s[l],o=s[l+1],h=e[r],u=e[o],m=t[r],k=t[o],w=l;w<n&&(w+=2,a=s[w],f=e[a],!(u<f));){if(S=t[a],c=s[w+1],g=e[c],X=t[c],m>=S){if(m>X&&k>S&&k>X)continue}else if(m<X&&k<S&&k<X)continue;r==a||r==c||o==a||o==c||(C=ci(h,m,u,k,f,S,g,X),C&&(d=[r,o],v=[a,c],i.push(On(C,d,v,e,t)),C.length==4&&i.push(On(C.slice(2),d,v,e,t))))}l+=2}return i}function ci(s,e,t,n,i,r,o,a){const c=hi(s,e,t,n,i,r,o,a);let h=null;return c&&(h=fi(s,e,t,n,i,r,o,a),h?gi(s,e,t,n,i,r,o,a)&&(h=null):h=mi(s,e,t,n,i,r,o,a)),h}function hi(s,e,t,n,i,r,o,a){return Ae(s,e,t,n,i,r)*Ae(s,e,t,n,o,a)<=0&&Ae(i,r,o,a,s,e)*Ae(i,r,o,a,t,n)<=0}function Ae(s,e,t,n,i,r){return Vn(s-i,e-r,t-i,n-r)}function Vn(s,e,t,n){return s*n-e*t}function fi(s,e,t,n,i,r,o,a){let c=De(s,e,t,n,i,r,o,a),h;return c&&(h=li(c[0],c[1],s,e,t,n,i,r,o,a),h==1?c=De(t,n,s,e,i,r,o,a):h==2?c=De(i,r,o,a,s,e,t,n):h==3&&(c=De(o,a,i,r,s,e,t,n))),c&&di(c,s,e,t,n,i,r,o,a),c}function De(s,e,t,n,i,r,o,a){const c=Vn(t-s,n-e,o-i,a-r),h=1e-18;let u;if(c===0)return null;const f=Ae(i,r,o,a,s,e)/c;return c<=h&&c>=-h?u=ui(s,e,t,n,i,r,o,a):u=[s+f*(t-s),e+f*(n-e)],u}function ui(s,e,t,n,i,r,o,a){let c=null;return!re(s,i,o)&&!re(e,r,a)?c=[s,e]:!re(t,i,o)&&!re(n,r,a)?c=[t,n]:!re(i,s,t)&&!re(r,e,n)?c=[i,r]:!re(o,s,t)&&!re(a,e,n)&&(c=[o,a]),c}function re(s,e,t){let n;return e<t?n=s<e||s>t:e>t?n=s>e||s<t:n=s!=e,n}function li(s,e,...t){let n=-1,i=1/0,r;for(let o=0,a=0,c=t.length;a<c;o++,a+=2)r=pi(s,e,t[a],t[a+1]),r<i&&(i=r,n=o);return n}function pi(s,e,t,n){const i=s-t,r=e-n;return i*i+r*r}function di(s,e,t,n,i,r,o,a,c){let h=s[0],u=s[1];h=$e(h,e,n),h=$e(h,r,a),u=$e(u,t,i),u=$e(u,o,c),s[0]=h,s[1]=u}function $e(s,e,t){let n;return re(s,e,t)&&(n=Math.abs(s-e)<Math.abs(s-t)?e:t,s=n),s}function mi(s,e,t,n,i,r,o,a){const c=Math.min(s,t,i,o),h=Math.max(s,t,i,o),u=Math.min(e,n,r,a),f=Math.max(e,n,r,a),g=f-u>h-c;let m=[];return(g?ce(e,u,f):ce(s,c,h))&&m.push(s,e),(g?ce(n,u,f):ce(t,c,h))&&m.push(t,n),(g?ce(r,u,f):ce(i,c,h))&&m.push(i,r),(g?ce(a,u,f):ce(o,c,h))&&m.push(o,a),(m.length!=2&&m.length!=4||m.length==4&&m[0]==m[2]&&m[1]==m[3])&&(m=null),m}function gi(s,e,t,n,i,r,o,a){return s==i&&e==r||s==o&&e==a||t==i&&n==r||t==o&&n==a}function ce(s,e,t){return s>e&&s<t}function wi(s,e){yi(s,e),Wn(s,e,0,e.length-2)}function yi(s,e){for(let t=0,n=e.length;t<n;t+=2)s[e[t]]>s[e[t+1]]&&vi(e,t,t+1)}function vi(s,e,t){const n=s[e];s[e]=s[t],s[t]=n}function Wn(s,e,t,n){let i=t,r=n,o,a;for(;i<n;){for(o=s[e[t+n>>2<<1]];i<=r;){for(;s[e[i]]<o;)i+=2;for(;s[e[r]]>o;)r-=2;i<=r&&(a=e[i],e[i]=e[r],e[r]=a,a=e[i+1],e[i+1]=e[r+1],e[r+1]=a,i+=2,r-=2)}if(r-t<40?In(s,e,t,r):Wn(s,e,t,r),n-i<40){In(s,e,i,n);return}t=i,r=n}}function In(s,e,t,n){let i,r;for(let o=t+2;o<=n;o+=2){i=e[o],r=e[o+1];let a;for(a=o-2;a>=t&&s[i]<s[e[a]];a-=2)e[a+2]=e[a],e[a+3]=e[a+1];e[a+2]=i,e[a+3]=r}}function On(s,e,t,n,i){const r=s[0],o=s[1];e=Tn(r,o,e[0],e[1],n,i),t=Tn(r,o,t[0],t[1],n,i);const a=e[0]<t[0]?e:t,c=a==e?t:e;return{x:r,y:o,a,b:c}}function Tn(s,e,t,n,i,r){let o=t<n?t:n,a=o===t?n:t;return i[o]==s&&r[o]==e?a=o:i[a]==s&&r[a]==e&&(o=a),[o,a]}function Jn(s){const e={};return s.filter(t=>{const n=bi(t);return n in e?!1:(e[n]=!0,!0)})}function bi(s){return`${s.a.join(",")};${s.b.join(",")}`}class xi{constructor(e,t){ct(this,"_i",0);ct(this,"_n",0);ct(this,"_inc",1);ct(this,"_xx");ct(this,"_yy");ct(this,"i",0);ct(this,"x",0);ct(this,"y",0);this._xx=e,this._yy=t}}function _i(s,e,t,n){let i=t|0;const r=isNaN(n)?s.length-i:n+i;let o,a,c,h,u,f;if(r>0)c=u=s[i],h=f=e[i];else return[void 0,void 0,void 0,void 0];for(i++;i<r;i++)o=s[i],a=e[i],o<c&&(c=o),o>u&&(u=o),a<h&&(h=a),a>f&&(f=a);return[c,h,u,f]}class Ue{constructor(...e){ct(this,"xmin");ct(this,"ymin");ct(this,"xmax");ct(this,"ymax");e.length>0&&this.setBounds(e)}cloneBounds(){return this.clone()}clone(){return new Ue(this.xmin,this.ymin,this.xmax,this.ymax)}width(){return this.xmax-this.xmin||0}height(){return this.ymax-this.ymin||0}setBounds(e,t,n,i){return arguments.length==1&&(fn(e)?(t=e[1],n=e[2],i=e[3],e=e[0]):(t=e.ymin,n=e.xmax,i=e.ymax,e=e.xmin)),this.xmin=e,this.ymin=t,this.xmax=n,this.ymax=i,(e>n||t>i)&&this.update(),this}update(){let e;this.xmin>this.xmax&&(e=this.xmin,this.xmin=this.xmax,this.xmax=e),this.ymin>this.ymax&&(e=this.ymin,this.ymin=this.ymax,this.ymax=e)}mergeBounds(e,...t){let n,i,r,o;return e instanceof Ue?(n=e.xmin,i=e.ymin,r=e.xmax,o=e.ymax):t.length==3?(n=e,i=t[0],r=t[1],o=t[2]):e.length==4?(n=e[0],i=e[1],r=e[2],o=e[3]):hn("Bounds#mergeBounds() invalid argument:",e),this.xmin===void 0?this.setBounds(n,i,r,o):(n<this.xmin&&(this.xmin=n),i<this.ymin&&(this.ymin=i),r>this.xmax&&(this.xmax=r),o>this.ymax&&(this.ymax=o)),this}}function ze(s){const e=["a","b","c"].map(t=>s.properties[t].index);return[[0,1],[0,2],[1,2],[0,1,2]].map(t=>t.map(n=>e[n]).sort().join("-")).sort()}function un(s,e,t){const n=ze(e.forw),i=ze(e.bakw);if(JSON.stringify(n)!=JSON.stringify(i))throw`${JSON.stringify(e,null,2)}
${JSON.stringify(n)}
${JSON.stringify(i)}`;for(let r=0;r<n.length;r++){const o=n[r];s[o]||(s[o]=[]),s[o].push(e)}t&&(t.forw.features.push(e.forw),t.bakw.features.push(e.bakw))}function Nn(s,e,t){const n=ze(e.forw),i=ze(e.bakw);if(JSON.stringify(n)!=JSON.stringify(i))throw`${JSON.stringify(e,null,2)}
${JSON.stringify(n)}
${JSON.stringify(i)}`;if(n.forEach(r=>{const o=s[r];if(!o)return;const a=o.filter(c=>c!==e);a.length===0?delete s[r]:s[r]=a}),t){const r=(o,a)=>{!o||!a||(o.features=o.features.filter(c=>c!==a))};r(t.forw,e.forw),r(t.bakw,e.bakw)}}function Pe(s,e,t){return me(s,{target:{geom:e,index:t}})}function Be(s){return me(s.properties.target.geom,{target:{geom:s.geometry.coordinates,index:s.properties.target.index}})}function sn(s,e){const t=e.geometry.coordinates;return[0,1,2,3].map(n=>{const i=(n+1)%4,r=s[n],o=s[i],a=r.geometry.coordinates,c=Math.atan2(a[0]-t[0],a[1]-t[1]),h=[e,r,o,e].map(g=>g.geometry.coordinates),u={a:{geom:e.properties.target.geom,index:e.properties.target.index},b:{geom:r.properties.target.geom,index:r.properties.target.index},c:{geom:o.properties.target.geom,index:o.properties.target.index}},f=Gt([Oe([h],u)]);return[c,f]}).reduce((n,i)=>(n[0].push(i[0]),n[1].push(i[1]),n),[[],[]])}function Mi(s){const{tins:e,targets:t,includeReciprocals:n}=s,i={};t.forEach(o=>{const a=e[o];if(!a||!a.features)return;i[o]={};const c={};a.features.forEach(h=>{const u=["a","b","c"];for(let f=0;f<3;f++){const g=(f+1)%3,m=u[f],k=u[g],S=h.properties[m].index,X=h.properties[k].index,C=[S,X].sort().join("-");if(c[C])continue;c[C]=!0;const d=h.geometry.coordinates[0][f],v=h.geometry.coordinates[0][g],l=h.properties[m].geom,w=h.properties[k].geom,x=Math.sqrt(Math.pow(l[0]-w[0],2)+Math.pow(l[1]-w[1],2))/Math.sqrt(Math.pow(d[0]-v[0],2)+Math.pow(d[1]-v[1],2)),A=i[o];A[`${S}:${C}`]=x,A[`${X}:${C}`]=x}})});const r={};return n&&(r.bakw={}),t.forEach(o=>{const a=i[o];if(r[o]={},!a)return;const c={};Object.keys(a).forEach(u=>{const[f]=u.split(":");c[f]||(c[f]=[]),c[f].push(a[u])}),Object.keys(c).forEach(u=>{const f=c[u],g=f.reduce((m,k)=>m+k,0)/f.length;r[o][u]=g,n&&r.bakw&&(r.bakw[u]=1/g)});let h=0;for(let u=0;u<4;u++){const f=`b${u}`,g=r[o][f]||0;h+=g}r[o].c=h/4,n&&r.bakw&&(r.bakw.c=1/r[o].c)}),r}function ki(s,e){const t=s.split("-");if(t.length!==2||!t.every(r=>/^-?\d+$/.test(r)))return!1;const[n,i]=t.map(r=>parseInt(r,10)).sort((r,o)=>r-o);return e.some(r=>{if(r.length!==2)return!1;const o=r.map(c=>parseInt(`${c}`,10));if(o.some(c=>Number.isNaN(c)))return!1;const a=o.sort((c,h)=>c-h);return a[0]===n&&a[1]===i})}function qe(s){return["a","b","c"].map((e,t)=>({prop:s.properties[e],geom:s.geometry.coordinates[0][t]}))}function Si(s,e,t){const n=new Set;let i=!1;const r=Object.keys(e);for(const o of r){if(n.has(o))continue;n.add(o);const a=e[o];if(!a||a.length<2)continue;const c=o.split("-");if(c.length!==2||ki(o,t))continue;const h=qe(a[0].bakw),u=qe(a[1].bakw),f=qe(a[0].forw),g=qe(a[1].forw),m=c.map(_=>h.find(P=>`${P.prop.index}`===_)||u.find(P=>`${P.prop.index}`===_)),k=c.map(_=>f.find(P=>`${P.prop.index}`===_)||g.find(P=>`${P.prop.index}`===_));if(m.some(_=>!_)||k.some(_=>!_))continue;const S=[h,u].map(_=>_.find(P=>!c.includes(`${P.prop.index}`))),X=[f,g].map(_=>_.find(P=>!c.includes(`${P.prop.index}`)));if(S.some(_=>!_)||X.some(_=>!_))continue;const C=a[0].bakw.geometry.coordinates[0].slice(0,3).map(_=>we(_)),d=a[1].bakw.geometry.coordinates[0].slice(0,3).map(_=>we(_));if(!(Xn(we(S[0].geom),d)||Xn(we(S[1].geom),C)))continue;const l=k.map(_=>we(_.geom)),w=X.map(_=>we(_.geom)),x=Ei([...l,...w]),A=Ai(x),T=Yn(l[0],l[1],w[0])+Yn(l[0],l[1],w[1]);on(A,T)&&(Nn(e,a[0],s),Nn(e,a[1],s),m.forEach(_=>{if(!_)return;const P=[_.geom,S[0].geom,S[1].geom,_.geom],R={a:_.prop,b:S[0].prop,c:S[1].prop},D=Oe([P],R),G=zt.counterTri(D);un(e,{forw:G,bakw:D},s)}),i=!0)}return i}function we(s){return[s[0],s[1]]}function Xn(s,e){const[t,n]=e[0],[i,r]=e[1],[o,a]=e[2],c=o-t,h=a-n,u=i-t,f=r-n,g=s[0]-t,m=s[1]-n,k=c*c+h*h,S=c*u+h*f,X=c*g+h*m,C=u*u+f*f,d=u*g+f*m,v=k*C-S*S;if(v===0)return!1;const l=1/v,w=(C*X-S*d)*l,x=(k*d-S*X)*l,A=1e-9;return w>=-A&&x>=-A&&w+x<=1+A}function Ei(s){const e=s.map(o=>o.slice()).filter((o,a,c)=>c.findIndex(h=>on(h[0],o[0])&&on(h[1],o[1]))===a);if(e.length<=1)return e;const t=e.sort((o,a)=>o[0]===a[0]?o[1]-a[1]:o[0]-a[0]),n=(o,a,c)=>(a[0]-o[0])*(c[1]-o[1])-(a[1]-o[1])*(c[0]-o[0]),i=[];for(const o of t){for(;i.length>=2&&n(i[i.length-2],i[i.length-1],o)<=0;)i.pop();i.push(o)}const r=[];for(let o=t.length-1;o>=0;o--){const a=t[o];for(;r.length>=2&&n(r[r.length-2],r[r.length-1],a)<=0;)r.pop();r.push(a)}return r.pop(),i.pop(),i.concat(r)}function Ai(s){if(s.length<3)return 0;let e=0;for(let t=0;t<s.length;t++){const[n,i]=s[t],[r,o]=s[(t+1)%s.length];e+=n*o-r*i}return Math.abs(e)/2}function Yn(s,e,t){return Math.abs((s[0]*(e[1]-t[1])+e[0]*(t[1]-s[1])+t[0]*(s[1]-e[1]))/2)}function on(s,e,t=1e-9){return Math.abs(s-e)<=t}const Pi=2.00703,Rn=typeof zt.format_version<"u"?zt.format_version:Pi;class Nt extends zt.Transform{constructor(t={}){super();ct(this,"importance");ct(this,"priority");ct(this,"pointsSet");t.bounds?this.setBounds(t.bounds):(this.setWh(t.wh),this.vertexMode=t.vertexMode||Nt.VERTEX_PLAIN),this.strictMode=t.strictMode||Nt.MODE_AUTO,this.yaxisMode=t.yaxisMode||Nt.YAXIS_INVERT,this.importance=t.importance||0,this.priority=t.priority||0,this.stateFull=t.stateFull||!1,t.points&&this.setPoints(t.points),t.edges&&this.setEdges(t.edges)}getFormatVersion(){return Rn}setPoints(t){this.yaxisMode===Nt.YAXIS_FOLLOW&&(t=t.map(n=>[n[0],[n[1][0],-1*n[1][1]]])),this.points=t,this.tins=void 0,this.indexedTins=void 0}setEdges(t=[]){this.edges=zt.normalizeEdges(t),this.edgeNodes=void 0,this.tins=void 0,this.indexedTins=void 0}setBounds(t){this.bounds=t;let n=t[0][0],i=n,r=t[0][1],o=r;const a=[t[0]];for(let c=1;c<t.length;c++){const h=t[c];h[0]<n&&(n=h[0]),h[0]>i&&(i=h[0]),h[1]<r&&(r=h[1]),h[1]>o&&(o=h[1]),a.push(h)}a.push(t[0]),this.boundsPolygon=Oe([a]),this.xy=[n,r],this.wh=[i-n,o-r],this.vertexMode=Nt.VERTEX_PLAIN,this.tins=void 0,this.indexedTins=void 0}getCompiled(){var i;const t={};t.version=Rn,t.points=this.points,t.weight_buffer=this.pointsWeightBuffer,t.centroid_point=[this.centroid.forw.geometry.coordinates,this.centroid.forw.properties.target.geom],t.vertices_params=[this.vertices_params.forw[0],this.vertices_params.bakw[0]],t.vertices_points=[];const n=this.vertices_params.forw[1];return n&&[0,1,2,3].map(r=>{const o=n[r].features[0],a=o.geometry.coordinates[0][1],c=o.properties.b.geom;t.vertices_points[r]=[a,c]}),t.strict_status=this.strict_status,t.tins_points=[[]],this.tins.forw.features.map(r=>{t.tins_points[0].push(["a","b","c"].map(o=>r.properties[o].index))}),this.strict_status===Nt.STATUS_LOOSE?(t.tins_points[1]=[],this.tins.bakw.features.map(r=>{t.tins_points[1].push(["a","b","c"].map(o=>r.properties[o].index))})):this.strict_status===Nt.STATUS_ERROR&&((i=this.kinks)!=null&&i.bakw)&&(t.kinks_points=this.kinks.bakw.features.map(r=>r.geometry.coordinates)),t.yaxisMode=this.yaxisMode,t.vertexMode=this.vertexMode,t.strictMode=this.strictMode,this.bounds?(t.bounds=this.bounds,t.boundsPolygon=this.boundsPolygon,t.xy=this.xy,t.wh=this.wh):t.wh=this.wh,t.edges=this.edges,t.edgeNodes=this.edgeNodes,t}setWh(t){this.wh=t||[100,100],this.xy=[0,0],this.bounds=void 0,this.boundsPolygon=void 0,this.tins=void 0,this.indexedTins=void 0}setVertexMode(t){this.vertexMode=t,this.tins=void 0,this.indexedTins=void 0}setStrictMode(t){this.strictMode=t,this.tins=void 0,this.indexedTins=void 0}calcurateStrictTin(){var r;const t=this.tins.forw.features.map(o=>zt.counterTri(o));this.tins.bakw=Gt(t);const n={};this.tins.forw.features.forEach((o,a)=>{const c=this.tins.bakw.features[a];un(n,{forw:o,bakw:c})}),Si(this.tins,n,((r=this.pointsSet)==null?void 0:r.edges)||[]);const i=["forw","bakw"].map(o=>{const a=this.tins[o].features.map(c=>c.geometry.coordinates[0]);return zn(a)});i[0].length===0&&i[1].length===0?(this.strict_status=Nt.STATUS_STRICT,delete this.kinks):(this.strict_status=Nt.STATUS_ERROR,this.kinks={forw:Gt(i[0]),bakw:Gt(i[1])})}generatePointsSet(){const t={forw:[],bakw:[]};for(let r=0;r<this.points.length;r++){const o=this.points[r][0],a=this.points[r][1],c=Pe(o,a,r);t.forw.push(c),t.bakw.push(Be(c))}const n=[];let i=0;this.edgeNodes=[],this.edges||(this.edges=[]);for(let r=0;r<this.edges.length;r++){const o=this.edges[r][2],a=Object.assign([],this.edges[r][0]),c=Object.assign([],this.edges[r][1]);if(a.length===0&&c.length===0){n.push(o);continue}a.unshift(this.points[o[0]][0]),a.push(this.points[o[1]][0]),c.unshift(this.points[o[0]][1]),c.push(this.points[o[1]][1]);const h=[a,c].map(u=>{const f=u.map((m,k,S)=>{if(k===0)return 0;const X=S[k-1];return Math.sqrt(Math.pow(m[0]-X[0],2)+Math.pow(m[1]-X[1],2))}),g=f.reduce((m,k,S)=>S===0?[0]:(m.push(m[S-1]+k),m),[]);return g.map((m,k,S)=>{const X=m/S[S.length-1];return[u[k],f[k],g[k],X]})});h.map((u,f)=>{const g=h[f?0:1];return u.filter((m,k)=>!(k===0||k===u.length-1||m[4]==="handled")).map(m=>{const k=m[0],S=m[3],X=g.reduce((C,d,v,l)=>{if(C)return C;const w=l[v+1];if(d[3]===S)return d[4]="handled",[d];if(d[3]<S&&w&&w[3]>S)return[d,w]},void 0);if(X&&X.length===1)return f===0?[k,X[0][0],S]:[X[0][0],k,S];if(X&&X.length===2){const C=X[0],d=X[1],v=(S-C[3])/(d[3]-C[3]),l=[(d[0][0]-C[0][0])*v+C[0][0],(d[0][1]-C[0][1])*v+C[0][1]];return f===0?[k,l,S]:[l,k,S]}return[]})}).reduce((u,f)=>u.concat(f),[]).sort((u,f)=>u[2]<f[2]?-1:1).map((u,f,g)=>{this.edgeNodes[i]=[u[0],u[1]];const m=Pe(u[0],u[1],`e${i}`);i++,t.forw.push(m),t.bakw.push(Be(m)),f===0?n.push([o[0],t.forw.length-1]):n.push([t.forw.length-2,t.forw.length-1]),f===g.length-1&&n.push([t.forw.length-1,o[1]])})}return{forw:t.forw,bakw:t.bakw,edges:n}}validateAndPrepareInputs(){const t=this.xy[0]-.05*this.wh[0],n=this.xy[0]+1.05*this.wh[0],i=this.xy[1]-.05*this.wh[1],r=this.xy[1]+1.05*this.wh[1];if(!this.points.reduce((c,h)=>c&&(this.bounds?lr(h[0],this.boundsPolygon):h[0][0]>=t&&h[0][0]<=n&&h[0][1]>=i&&h[0][1]<=r),!0))throw"SOME POINTS OUTSIDE";let a=[];return this.wh&&(a=[[t,i],[n,i],[t,r],[n,r]]),{pointsSet:this.generatePointsSet(),bbox:a,minx:t,maxx:n,miny:i,maxy:r}}updateTin(){let t=this.strictMode;t!==Nt.MODE_STRICT&&t!==Nt.MODE_LOOSE&&(t=Nt.MODE_AUTO);const{pointsSet:n,bbox:i,minx:r,maxx:o,miny:a,maxy:c}=this.validateAndPrepareInputs(),h={forw:Gt(n.forw),bakw:Gt(n.bakw)},u=Ee(h.forw,n.edges,"target"),f=Ee(h.bakw,n.edges,"target");if(u.features.length===0||f.features.length===0)throw"TOO LINEAR1";const g=Sr(h.forw),m=Sn(h.forw);if(!m)throw"TOO LINEAR2";const k={},S=m.geometry.coordinates[0];let X;try{X=S.map(P=>({forw:P,bakw:zt.transformArr(me(P),u)})),X.forEach(P=>{k[`${P.forw[0]}:${P.forw[1]}`]=P})}catch{throw"TOO LINEAR2"}const C=Sn(h.bakw);if(!C)throw"TOO LINEAR2";const d=C.geometry.coordinates[0];try{X=d.map(P=>({bakw:P,forw:zt.transformArr(me(P),f)})),X.forEach(P=>{k[`${P.forw[0]}:${P.forw[1]}`]=P})}catch{throw"TOO LINEAR2"}const v={forw:g.geometry.coordinates,bakw:zt.transformArr(g,u)},l=Pe(v.forw,v.bakw,"c");this.centroid={forw:l,bakw:Be(l)};const w={convexBuf:k,centroid:v,bbox:i,minx:r,maxx:o,miny:a,maxy:c},x=this.vertexMode===Nt.VERTEX_BIRDEYE?ti(w):Zr(w),A={forw:[],bakw:[]};for(let P=0;P<x.length;P++){const R=x[P].forw,D=x[P].bakw,G=Pe(R,D,`b${P}`),p=Be(G);n.forw.push(G),n.bakw.push(p),A.forw.push(G),A.bakw.push(p)}this.pointsSet={forw:Gt(n.forw),bakw:Gt(n.bakw),edges:n.edges},this.tins={forw:zt.rotateVerticesTriangle(Ee(this.pointsSet.forw,n.edges,"target"))},(t===Nt.MODE_STRICT||t===Nt.MODE_AUTO)&&this.calcurateStrictTin(),(t===Nt.MODE_LOOSE||t===Nt.MODE_AUTO&&this.strict_status===Nt.STATUS_ERROR)&&(this.tins.bakw=zt.rotateVerticesTriangle(Ee(this.pointsSet.bakw,n.edges,"target")),delete this.kinks,this.strict_status=Nt.STATUS_LOOSE),this.vertices_params={forw:sn(A.forw,this.centroid.forw),bakw:sn(A.bakw,this.centroid.bakw)},this.addIndexedTin();const T=["forw"];this.strict_status===Nt.STATUS_LOOSE&&T.push("bakw");const _=this.strict_status===Nt.STATUS_STRICT;this.pointsWeightBuffer=Mi({tins:this.tins,targets:T,includeReciprocals:_})}async updateTinAsync(){this.updateTin()}}exports.Tin=Nt;exports.constrainedTin=Ee;exports.counterPoint=Be;exports.createPoint=Pe;exports.default=Nt;exports.findIntersections=zn;exports.format_version=zt.format_version;exports.insertSearchIndex=un;exports.vertexCalc=sn;
