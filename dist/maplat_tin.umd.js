(function($t,Rt){typeof exports=="object"&&typeof module<"u"?Rt(exports):typeof define=="function"&&define.amd?define(["exports"],Rt):($t=typeof globalThis<"u"?globalThis:$t||self,Rt($t.tin={}))})(this,(function($t){"use strict";const Rt=11102230246251565e-32,rt=134217729,un=(3+8*Rt)*Rt;function Yt(s,t,e,n,r){let i,o,a,c,f=t[0],u=n[0],h=0,p=0;u>f==u>-f?(i=f,f=t[++h]):(i=u,u=n[++p]);let y=0;if(h<s&&p<e)for(u>f==u>-f?(o=f+i,a=i-(o-f),f=t[++h]):(o=u+i,a=i-(o-u),u=n[++p]),i=o,a!==0&&(r[y++]=a);h<s&&p<e;)u>f==u>-f?(o=i+f,c=o-i,a=i-(o-c)+(f-c),f=t[++h]):(o=i+u,c=o-i,a=i-(o-c)+(u-c),u=n[++p]),i=o,a!==0&&(r[y++]=a);for(;h<s;)o=i+f,c=o-i,a=i-(o-c)+(f-c),f=t[++h],i=o,a!==0&&(r[y++]=a);for(;p<e;)o=i+u,c=o-i,a=i-(o-c)+(u-c),u=n[++p],i=o,a!==0&&(r[y++]=a);return(i!==0||y===0)&&(r[y++]=i),y}function Ut(s,t,e,n,r,i,o,a){return Yt(Yt(s,t,e,n,o),o,r,i,a)}function q(s,t,e,n){let r,i,o,a,c,f,u,h,p,y,E;u=rt*e,y=u-(u-e),E=e-y;let k=t[0];r=k*e,u=rt*k,h=u-(u-k),p=k-h,o=p*E-(r-h*y-p*y-h*E);let X=0;o!==0&&(n[X++]=o);for(let C=1;C<s;C++)k=t[C],a=k*e,u=rt*k,h=u-(u-k),p=k-h,c=p*E-(a-h*y-p*y-h*E),i=r+c,f=i-r,o=r-(i-f)+(c-f),o!==0&&(n[X++]=o),r=a+i,o=i-(r-a),o!==0&&(n[X++]=o);return(r!==0||X===0)&&(n[X++]=r),X}function ln(s,t){let e=t[0];for(let n=1;n<s;n++)e+=t[n];return e}function yt(s){return new Float64Array(s)}const Wn=(3+16*Rt)*Rt,Jn=(2+12*Rt)*Rt,Kn=(9+64*Rt)*Rt*Rt,ge=yt(4),dn=yt(8),pn=yt(12),mn=yt(16),Ft=yt(4);function Gn(s,t,e,n,r,i,o){let a,c,f,u,h,p,y,E,k,X,C,m,v,l,g,x,A,I;const b=s-r,T=e-r,Y=t-i,D=n-i;l=b*D,p=rt*b,y=p-(p-b),E=b-y,p=rt*D,k=p-(p-D),X=D-k,g=E*X-(l-y*k-E*k-y*X),x=Y*T,p=rt*Y,y=p-(p-Y),E=Y-y,p=rt*T,k=p-(p-T),X=T-k,A=E*X-(x-y*k-E*k-y*X),C=g-A,h=g-C,ge[0]=g-(C+h)+(h-A),m=l+C,h=m-l,v=l-(m-h)+(C-h),C=v-x,h=v-C,ge[1]=v-(C+h)+(h-x),I=m+C,h=I-m,ge[2]=m-(I-h)+(C-h),ge[3]=I;let Q=ln(4,ge),d=Jn*o;if(Q>=d||-Q>=d||(h=s-b,a=s-(b+h)+(h-r),h=e-T,f=e-(T+h)+(h-r),h=t-Y,c=t-(Y+h)+(h-i),h=n-D,u=n-(D+h)+(h-i),a===0&&c===0&&f===0&&u===0)||(d=Kn*o+un*Math.abs(Q),Q+=b*u+D*a-(Y*f+T*c),Q>=d||-Q>=d))return Q;l=a*D,p=rt*a,y=p-(p-a),E=a-y,p=rt*D,k=p-(p-D),X=D-k,g=E*X-(l-y*k-E*k-y*X),x=c*T,p=rt*c,y=p-(p-c),E=c-y,p=rt*T,k=p-(p-T),X=T-k,A=E*X-(x-y*k-E*k-y*X),C=g-A,h=g-C,Ft[0]=g-(C+h)+(h-A),m=l+C,h=m-l,v=l-(m-h)+(C-h),C=v-x,h=v-C,Ft[1]=v-(C+h)+(h-x),I=m+C,h=I-m,Ft[2]=m-(I-h)+(C-h),Ft[3]=I;const M=Yt(4,ge,4,Ft,dn);l=b*u,p=rt*b,y=p-(p-b),E=b-y,p=rt*u,k=p-(p-u),X=u-k,g=E*X-(l-y*k-E*k-y*X),x=Y*f,p=rt*Y,y=p-(p-Y),E=Y-y,p=rt*f,k=p-(p-f),X=f-k,A=E*X-(x-y*k-E*k-y*X),C=g-A,h=g-C,Ft[0]=g-(C+h)+(h-A),m=l+C,h=m-l,v=l-(m-h)+(C-h),C=v-x,h=v-C,Ft[1]=v-(C+h)+(h-x),I=m+C,h=I-m,Ft[2]=m-(I-h)+(C-h),Ft[3]=I;const _=Yt(M,dn,4,Ft,pn);l=a*u,p=rt*a,y=p-(p-a),E=a-y,p=rt*u,k=p-(p-u),X=u-k,g=E*X-(l-y*k-E*k-y*X),x=c*f,p=rt*c,y=p-(p-c),E=c-y,p=rt*f,k=p-(p-f),X=f-k,A=E*X-(x-y*k-E*k-y*X),C=g-A,h=g-C,Ft[0]=g-(C+h)+(h-A),m=l+C,h=m-l,v=l-(m-h)+(C-h),C=v-x,h=v-C,Ft[1]=v-(C+h)+(h-x),I=m+C,h=I-m,Ft[2]=m-(I-h)+(C-h),Ft[3]=I;const B=Yt(_,pn,4,Ft,mn);return mn[B-1]}function Qt(s,t,e,n,r,i){const o=(t-i)*(e-r),a=(s-r)*(n-i),c=o-a,f=Math.abs(o+a);return Math.abs(c)>=Wn*f?c:-Gn(s,t,e,n,r,i,f)}const Qn=(10+96*Rt)*Rt,Hn=(4+48*Rt)*Rt,Zn=(44+576*Rt)*Rt*Rt,ie=yt(4),oe=yt(4),se=yt(4),Ht=yt(4),Zt=yt(4),te=yt(4),Lt=yt(4),Dt=yt(4),ze=yt(8),Ve=yt(8),We=yt(8),Je=yt(8),Ke=yt(8),Ge=yt(8),Ie=yt(8),Te=yt(8),Ne=yt(8),fe=yt(4),he=yt(4),ue=yt(4),st=yt(8),lt=yt(16),kt=yt(16),St=yt(16),bt=yt(32),ae=yt(32),Bt=yt(48),qt=yt(64);let we=yt(1152),Qe=yt(1152);function Ot(s,t,e){s=Yt(s,we,t,e,Qe);const n=we;return we=Qe,Qe=n,s}function tr(s,t,e,n,r,i,o,a,c){let f,u,h,p,y,E,k,X,C,m,v,l,g,x,A,I,b,T,Y,D,Q,d,M,_,B,N,R,w,O,$,j,V,z,K,U;const ct=s-o,ft=e-o,dt=r-o,pt=t-a,gt=n-a,mt=i-a;j=ft*mt,M=rt*ft,_=M-(M-ft),B=ft-_,M=rt*mt,N=M-(M-mt),R=mt-N,V=B*R-(j-_*N-B*N-_*R),z=dt*gt,M=rt*dt,_=M-(M-dt),B=dt-_,M=rt*gt,N=M-(M-gt),R=gt-N,K=B*R-(z-_*N-B*N-_*R),w=V-K,d=V-w,ie[0]=V-(w+d)+(d-K),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$-z,d=$-w,ie[1]=$-(w+d)+(d-z),U=O+w,d=U-O,ie[2]=O-(U-d)+(w-d),ie[3]=U,j=dt*pt,M=rt*dt,_=M-(M-dt),B=dt-_,M=rt*pt,N=M-(M-pt),R=pt-N,V=B*R-(j-_*N-B*N-_*R),z=ct*mt,M=rt*ct,_=M-(M-ct),B=ct-_,M=rt*mt,N=M-(M-mt),R=mt-N,K=B*R-(z-_*N-B*N-_*R),w=V-K,d=V-w,oe[0]=V-(w+d)+(d-K),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$-z,d=$-w,oe[1]=$-(w+d)+(d-z),U=O+w,d=U-O,oe[2]=O-(U-d)+(w-d),oe[3]=U,j=ct*gt,M=rt*ct,_=M-(M-ct),B=ct-_,M=rt*gt,N=M-(M-gt),R=gt-N,V=B*R-(j-_*N-B*N-_*R),z=ft*pt,M=rt*ft,_=M-(M-ft),B=ft-_,M=rt*pt,N=M-(M-pt),R=pt-N,K=B*R-(z-_*N-B*N-_*R),w=V-K,d=V-w,se[0]=V-(w+d)+(d-K),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$-z,d=$-w,se[1]=$-(w+d)+(d-z),U=O+w,d=U-O,se[2]=O-(U-d)+(w-d),se[3]=U,f=Yt(Yt(Yt(q(q(4,ie,ct,st),st,ct,lt),lt,q(q(4,ie,pt,st),st,pt,kt),kt,bt),bt,Yt(q(q(4,oe,ft,st),st,ft,lt),lt,q(q(4,oe,gt,st),st,gt,kt),kt,ae),ae,qt),qt,Yt(q(q(4,se,dt,st),st,dt,lt),lt,q(q(4,se,mt,st),st,mt,kt),kt,bt),bt,we);let Pt=ln(f,we),Nt=Hn*c;if(Pt>=Nt||-Pt>=Nt||(d=s-ct,u=s-(ct+d)+(d-o),d=t-pt,y=t-(pt+d)+(d-a),d=e-ft,h=e-(ft+d)+(d-o),d=n-gt,E=n-(gt+d)+(d-a),d=r-dt,p=r-(dt+d)+(d-o),d=i-mt,k=i-(mt+d)+(d-a),u===0&&h===0&&p===0&&y===0&&E===0&&k===0)||(Nt=Zn*c+un*Math.abs(Pt),Pt+=(ct*ct+pt*pt)*(ft*k+mt*h-(gt*p+dt*E))+2*(ct*u+pt*y)*(ft*mt-gt*dt)+((ft*ft+gt*gt)*(dt*y+pt*p-(mt*u+ct*k))+2*(ft*h+gt*E)*(dt*pt-mt*ct))+((dt*dt+mt*mt)*(ct*E+gt*u-(pt*h+ft*y))+2*(dt*p+mt*k)*(ct*gt-pt*ft)),Pt>=Nt||-Pt>=Nt))return Pt;if((h!==0||E!==0||p!==0||k!==0)&&(j=ct*ct,M=rt*ct,_=M-(M-ct),B=ct-_,V=B*B-(j-_*_-(_+_)*B),z=pt*pt,M=rt*pt,_=M-(M-pt),B=pt-_,K=B*B-(z-_*_-(_+_)*B),w=V+K,d=w-V,Ht[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,Ht[1]=$-(w-d)+(z-d),U=O+w,d=U-O,Ht[2]=O-(U-d)+(w-d),Ht[3]=U),(p!==0||k!==0||u!==0||y!==0)&&(j=ft*ft,M=rt*ft,_=M-(M-ft),B=ft-_,V=B*B-(j-_*_-(_+_)*B),z=gt*gt,M=rt*gt,_=M-(M-gt),B=gt-_,K=B*B-(z-_*_-(_+_)*B),w=V+K,d=w-V,Zt[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,Zt[1]=$-(w-d)+(z-d),U=O+w,d=U-O,Zt[2]=O-(U-d)+(w-d),Zt[3]=U),(u!==0||y!==0||h!==0||E!==0)&&(j=dt*dt,M=rt*dt,_=M-(M-dt),B=dt-_,V=B*B-(j-_*_-(_+_)*B),z=mt*mt,M=rt*mt,_=M-(M-mt),B=mt-_,K=B*B-(z-_*_-(_+_)*B),w=V+K,d=w-V,te[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,te[1]=$-(w-d)+(z-d),U=O+w,d=U-O,te[2]=O-(U-d)+(w-d),te[3]=U),u!==0&&(X=q(4,ie,u,ze),f=Ot(f,Ut(q(X,ze,2*ct,lt),lt,q(q(4,te,u,st),st,gt,kt),kt,q(q(4,Zt,u,st),st,-mt,St),St,bt,Bt),Bt)),y!==0&&(C=q(4,ie,y,Ve),f=Ot(f,Ut(q(C,Ve,2*pt,lt),lt,q(q(4,Zt,y,st),st,dt,kt),kt,q(q(4,te,y,st),st,-ft,St),St,bt,Bt),Bt)),h!==0&&(m=q(4,oe,h,We),f=Ot(f,Ut(q(m,We,2*ft,lt),lt,q(q(4,Ht,h,st),st,mt,kt),kt,q(q(4,te,h,st),st,-pt,St),St,bt,Bt),Bt)),E!==0&&(v=q(4,oe,E,Je),f=Ot(f,Ut(q(v,Je,2*gt,lt),lt,q(q(4,te,E,st),st,ct,kt),kt,q(q(4,Ht,E,st),st,-dt,St),St,bt,Bt),Bt)),p!==0&&(l=q(4,se,p,Ke),f=Ot(f,Ut(q(l,Ke,2*dt,lt),lt,q(q(4,Zt,p,st),st,pt,kt),kt,q(q(4,Ht,p,st),st,-gt,St),St,bt,Bt),Bt)),k!==0&&(g=q(4,se,k,Ge),f=Ot(f,Ut(q(g,Ge,2*mt,lt),lt,q(q(4,Ht,k,st),st,ft,kt),kt,q(q(4,Zt,k,st),st,-ct,St),St,bt,Bt),Bt)),u!==0||y!==0){if(h!==0||E!==0||p!==0||k!==0?(j=h*mt,M=rt*h,_=M-(M-h),B=h-_,M=rt*mt,N=M-(M-mt),R=mt-N,V=B*R-(j-_*N-B*N-_*R),z=ft*k,M=rt*ft,_=M-(M-ft),B=ft-_,M=rt*k,N=M-(M-k),R=k-N,K=B*R-(z-_*N-B*N-_*R),w=V+K,d=w-V,Lt[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,Lt[1]=$-(w-d)+(z-d),U=O+w,d=U-O,Lt[2]=O-(U-d)+(w-d),Lt[3]=U,j=p*-gt,M=rt*p,_=M-(M-p),B=p-_,M=rt*-gt,N=M-(M- -gt),R=-gt-N,V=B*R-(j-_*N-B*N-_*R),z=dt*-E,M=rt*dt,_=M-(M-dt),B=dt-_,M=rt*-E,N=M-(M- -E),R=-E-N,K=B*R-(z-_*N-B*N-_*R),w=V+K,d=w-V,Dt[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,Dt[1]=$-(w-d)+(z-d),U=O+w,d=U-O,Dt[2]=O-(U-d)+(w-d),Dt[3]=U,A=Yt(4,Lt,4,Dt,Te),j=h*k,M=rt*h,_=M-(M-h),B=h-_,M=rt*k,N=M-(M-k),R=k-N,V=B*R-(j-_*N-B*N-_*R),z=p*E,M=rt*p,_=M-(M-p),B=p-_,M=rt*E,N=M-(M-E),R=E-N,K=B*R-(z-_*N-B*N-_*R),w=V-K,d=V-w,he[0]=V-(w+d)+(d-K),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$-z,d=$-w,he[1]=$-(w+d)+(d-z),U=O+w,d=U-O,he[2]=O-(U-d)+(w-d),he[3]=U,T=4):(Te[0]=0,A=1,he[0]=0,T=1),u!==0){const xt=q(A,Te,u,St);f=Ot(f,Yt(q(X,ze,u,lt),lt,q(xt,St,2*ct,bt),bt,Bt),Bt);const Mt=q(T,he,u,st);f=Ot(f,Ut(q(Mt,st,2*ct,lt),lt,q(Mt,st,u,kt),kt,q(xt,St,u,bt),bt,ae,qt),qt),E!==0&&(f=Ot(f,q(q(4,te,u,st),st,E,lt),lt)),k!==0&&(f=Ot(f,q(q(4,Zt,-u,st),st,k,lt),lt))}if(y!==0){const xt=q(A,Te,y,St);f=Ot(f,Yt(q(C,Ve,y,lt),lt,q(xt,St,2*pt,bt),bt,Bt),Bt);const Mt=q(T,he,y,st);f=Ot(f,Ut(q(Mt,st,2*pt,lt),lt,q(Mt,st,y,kt),kt,q(xt,St,y,bt),bt,ae,qt),qt)}}if(h!==0||E!==0){if(p!==0||k!==0||u!==0||y!==0?(j=p*pt,M=rt*p,_=M-(M-p),B=p-_,M=rt*pt,N=M-(M-pt),R=pt-N,V=B*R-(j-_*N-B*N-_*R),z=dt*y,M=rt*dt,_=M-(M-dt),B=dt-_,M=rt*y,N=M-(M-y),R=y-N,K=B*R-(z-_*N-B*N-_*R),w=V+K,d=w-V,Lt[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,Lt[1]=$-(w-d)+(z-d),U=O+w,d=U-O,Lt[2]=O-(U-d)+(w-d),Lt[3]=U,D=-mt,Q=-k,j=u*D,M=rt*u,_=M-(M-u),B=u-_,M=rt*D,N=M-(M-D),R=D-N,V=B*R-(j-_*N-B*N-_*R),z=ct*Q,M=rt*ct,_=M-(M-ct),B=ct-_,M=rt*Q,N=M-(M-Q),R=Q-N,K=B*R-(z-_*N-B*N-_*R),w=V+K,d=w-V,Dt[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,Dt[1]=$-(w-d)+(z-d),U=O+w,d=U-O,Dt[2]=O-(U-d)+(w-d),Dt[3]=U,I=Yt(4,Lt,4,Dt,Ne),j=p*y,M=rt*p,_=M-(M-p),B=p-_,M=rt*y,N=M-(M-y),R=y-N,V=B*R-(j-_*N-B*N-_*R),z=u*k,M=rt*u,_=M-(M-u),B=u-_,M=rt*k,N=M-(M-k),R=k-N,K=B*R-(z-_*N-B*N-_*R),w=V-K,d=V-w,ue[0]=V-(w+d)+(d-K),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$-z,d=$-w,ue[1]=$-(w+d)+(d-z),U=O+w,d=U-O,ue[2]=O-(U-d)+(w-d),ue[3]=U,Y=4):(Ne[0]=0,I=1,ue[0]=0,Y=1),h!==0){const xt=q(I,Ne,h,St);f=Ot(f,Yt(q(m,We,h,lt),lt,q(xt,St,2*ft,bt),bt,Bt),Bt);const Mt=q(Y,ue,h,st);f=Ot(f,Ut(q(Mt,st,2*ft,lt),lt,q(Mt,st,h,kt),kt,q(xt,St,h,bt),bt,ae,qt),qt),k!==0&&(f=Ot(f,q(q(4,Ht,h,st),st,k,lt),lt)),y!==0&&(f=Ot(f,q(q(4,te,-h,st),st,y,lt),lt))}if(E!==0){const xt=q(I,Ne,E,St);f=Ot(f,Yt(q(v,Je,E,lt),lt,q(xt,St,2*gt,bt),bt,Bt),Bt);const Mt=q(Y,ue,E,st);f=Ot(f,Ut(q(Mt,st,2*gt,lt),lt,q(Mt,st,E,kt),kt,q(xt,St,E,bt),bt,ae,qt),qt)}}if(p!==0||k!==0){if(u!==0||y!==0||h!==0||E!==0?(j=u*gt,M=rt*u,_=M-(M-u),B=u-_,M=rt*gt,N=M-(M-gt),R=gt-N,V=B*R-(j-_*N-B*N-_*R),z=ct*E,M=rt*ct,_=M-(M-ct),B=ct-_,M=rt*E,N=M-(M-E),R=E-N,K=B*R-(z-_*N-B*N-_*R),w=V+K,d=w-V,Lt[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,Lt[1]=$-(w-d)+(z-d),U=O+w,d=U-O,Lt[2]=O-(U-d)+(w-d),Lt[3]=U,D=-pt,Q=-y,j=h*D,M=rt*h,_=M-(M-h),B=h-_,M=rt*D,N=M-(M-D),R=D-N,V=B*R-(j-_*N-B*N-_*R),z=ft*Q,M=rt*ft,_=M-(M-ft),B=ft-_,M=rt*Q,N=M-(M-Q),R=Q-N,K=B*R-(z-_*N-B*N-_*R),w=V+K,d=w-V,Dt[0]=V-(w-d)+(K-d),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$+z,d=w-$,Dt[1]=$-(w-d)+(z-d),U=O+w,d=U-O,Dt[2]=O-(U-d)+(w-d),Dt[3]=U,x=Yt(4,Lt,4,Dt,Ie),j=u*E,M=rt*u,_=M-(M-u),B=u-_,M=rt*E,N=M-(M-E),R=E-N,V=B*R-(j-_*N-B*N-_*R),z=h*y,M=rt*h,_=M-(M-h),B=h-_,M=rt*y,N=M-(M-y),R=y-N,K=B*R-(z-_*N-B*N-_*R),w=V-K,d=V-w,fe[0]=V-(w+d)+(d-K),O=j+w,d=O-j,$=j-(O-d)+(w-d),w=$-z,d=$-w,fe[1]=$-(w+d)+(d-z),U=O+w,d=U-O,fe[2]=O-(U-d)+(w-d),fe[3]=U,b=4):(Ie[0]=0,x=1,fe[0]=0,b=1),p!==0){const xt=q(x,Ie,p,St);f=Ot(f,Yt(q(l,Ke,p,lt),lt,q(xt,St,2*dt,bt),bt,Bt),Bt);const Mt=q(b,fe,p,st);f=Ot(f,Ut(q(Mt,st,2*dt,lt),lt,q(Mt,st,p,kt),kt,q(xt,St,p,bt),bt,ae,qt),qt),y!==0&&(f=Ot(f,q(q(4,Zt,p,st),st,y,lt),lt)),E!==0&&(f=Ot(f,q(q(4,Ht,-p,st),st,E,lt),lt))}if(k!==0){const xt=q(x,Ie,k,St);f=Ot(f,Yt(q(g,Ge,k,lt),lt,q(xt,St,2*mt,bt),bt,Bt),Bt);const Mt=q(b,fe,k,st);f=Ot(f,Ut(q(Mt,st,2*mt,lt),lt,q(Mt,st,k,kt),kt,q(xt,St,k,bt),bt,ae,qt),qt)}}return we[f-1]}function er(s,t,e,n,r,i,o,a){const c=s-o,f=e-o,u=r-o,h=t-a,p=n-a,y=i-a,E=f*y,k=u*p,X=c*c+h*h,C=u*h,m=c*y,v=f*f+p*p,l=c*p,g=f*h,x=u*u+y*y,A=X*(E-k)+v*(C-m)+x*(l-g),I=(Math.abs(E)+Math.abs(k))*X+(Math.abs(C)+Math.abs(m))*v+(Math.abs(l)+Math.abs(g))*x,b=Qn*I;return A>b||-A>b?A:tr(s,t,e,n,r,i,o,a,I)}function nr(s,t){var e,n,r=0,i,o,a,c,f,u,h,p=s[0],y=s[1],E=t.length;for(e=0;e<E;e++){n=0;var k=t[e],X=k.length-1;if(u=k[0],u[0]!==k[X][0]&&u[1]!==k[X][1])throw new Error("First and last coordinates in a ring must be the same");for(o=u[0]-p,a=u[1]-y,n;n<X;n++){if(h=k[n+1],c=h[0]-p,f=h[1]-y,a===0&&f===0){if(c<=0&&o>=0||o<=0&&c>=0)return 0}else if(f>=0&&a<=0||f<=0&&a>=0){if(i=Qt(o,c,a,f,0,0),i===0)return 0;(i>0&&f>0&&a<=0||i<0&&f<=0&&a>0)&&r++}u=h,a=f,o=c}}return r%2!==0}function be(s,t,e={}){const n={type:"Feature"};return(e.id===0||e.id)&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.properties=t||{},n.geometry=s,n}function le(s,t,e={}){if(!s)throw new Error("coordinates is required");if(!Array.isArray(s))throw new Error("coordinates must be an Array");if(s.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!wn(s[0])||!wn(s[1]))throw new Error("coordinates must contain numbers");return be({type:"Point",coordinates:s},t,e)}function _e(s,t,e={}){for(const r of s){if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(r[r.length-1].length!==r[0].length)throw new Error("First and last Position are not equivalent.");for(let i=0;i<r[r.length-1].length;i++)if(r[r.length-1][i]!==r[0][i])throw new Error("First and last Position are not equivalent.")}return be({type:"Polygon",coordinates:s},t,e)}function gn(s,t,e={}){if(s.length<2)throw new Error("coordinates must be an array of two or more positions");return be({type:"LineString",coordinates:s},t,e)}function Vt(s,t={}){const e={type:"FeatureCollection"};return t.id&&(e.id=t.id),t.bbox&&(e.bbox=t.bbox),e.features=s,e}function wn(s){return!isNaN(s)&&s!==null&&!Array.isArray(s)}function rr(s){if(!s)throw new Error("coord is required");if(!Array.isArray(s)){if(s.type==="Feature"&&s.geometry!==null&&s.geometry.type==="Point")return[...s.geometry.coordinates];if(s.type==="Point")return[...s.coordinates]}if(Array.isArray(s)&&s.length>=2&&!Array.isArray(s[0])&&!Array.isArray(s[1]))return[...s];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ir(s){return s.type==="Feature"?s.geometry:s}function or(s,t,e={}){if(!s)throw new Error("point is required");if(!t)throw new Error("polygon is required");const n=rr(s),r=ir(t),i=r.type,o=t.bbox;let a=r.coordinates;if(o&&sr(n,o)===!1)return!1;i==="Polygon"&&(a=[a]);let c=!1;for(var f=0;f<a.length;++f){const u=nr(n,a[f]);if(u===0)return!e.ignoreBoundary;u&&(c=!0)}return c}function sr(s,t){return t[0]<=s[0]&&t[1]<=s[1]&&t[2]>=s[0]&&t[3]>=s[1]}var ar=or;function He(s,t,e){if(s!==null)for(var n,r,i,o,a,c,f,u=0,h=0,p,y=s.type,E=y==="FeatureCollection",k=y==="Feature",X=E?s.features.length:1,C=0;C<X;C++){f=E?s.features[C].geometry:k?s.geometry:s,p=f?f.type==="GeometryCollection":!1,a=p?f.geometries.length:1;for(var m=0;m<a;m++){var v=0,l=0;if(o=p?f.geometries[m]:f,o!==null){c=o.coordinates;var g=o.type;switch(u=e&&(g==="Polygon"||g==="MultiPolygon")?1:0,g){case null:break;case"Point":if(t(c,h,C,v,l)===!1)return!1;h++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(t(c[n],h,C,v,l)===!1)return!1;h++,g==="MultiPoint"&&v++}g==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(r=0;r<c[n].length-u;r++){if(t(c[n][r],h,C,v,l)===!1)return!1;h++}g==="MultiLineString"&&v++,g==="Polygon"&&l++}g==="Polygon"&&v++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(l=0,r=0;r<c[n].length;r++){for(i=0;i<c[n][r].length-u;i++){if(t(c[n][r][i],h,C,v,l)===!1)return!1;h++}l++}v++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(He(o.geometries[n],t,e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function cr(s,t={}){let e=0,n=0,r=0;return He(s,function(i){e+=i[0],n+=i[1],r++},!0),le([e/r,n/r],t.properties)}var fr=cr;function hr(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function ur(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var t=s.default;if(typeof t=="function"){var e=function n(){var r=!1;try{r=this instanceof n}catch{}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var r=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return s[n]}})}),e}var Xe={exports:{}},Re={exports:{}},lr=Re.exports,yn;function dr(){return yn||(yn=1,(function(s,t){(function(e,n){s.exports=n()})(lr,function(){function e(m,v,l,g,x){(function A(I,b,T,Y,D){for(;Y>T;){if(Y-T>600){var Q=Y-T+1,d=b-T+1,M=Math.log(Q),_=.5*Math.exp(2*M/3),B=.5*Math.sqrt(M*_*(Q-_)/Q)*(d-Q/2<0?-1:1),N=Math.max(T,Math.floor(b-d*_/Q+B)),R=Math.min(Y,Math.floor(b+(Q-d)*_/Q+B));A(I,b,N,R,D)}var w=I[b],O=T,$=Y;for(n(I,T,b),D(I[Y],w)>0&&n(I,T,Y);O<$;){for(n(I,O,$),O++,$--;D(I[O],w)<0;)O++;for(;D(I[$],w)>0;)$--}D(I[T],w)===0?n(I,T,$):n(I,++$,Y),$<=b&&(T=$+1),b<=$&&(Y=$-1)}})(m,v,l||0,g||m.length-1,x||r)}function n(m,v,l){var g=m[v];m[v]=m[l],m[l]=g}function r(m,v){return m<v?-1:m>v?1:0}var i=function(m){m===void 0&&(m=9),this._maxEntries=Math.max(4,m),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(m,v,l){if(!l)return v.indexOf(m);for(var g=0;g<v.length;g++)if(l(m,v[g]))return g;return-1}function a(m,v){c(m,0,m.children.length,v,m)}function c(m,v,l,g,x){x||(x=X(null)),x.minX=1/0,x.minY=1/0,x.maxX=-1/0,x.maxY=-1/0;for(var A=v;A<l;A++){var I=m.children[A];f(x,m.leaf?g(I):I)}return x}function f(m,v){return m.minX=Math.min(m.minX,v.minX),m.minY=Math.min(m.minY,v.minY),m.maxX=Math.max(m.maxX,v.maxX),m.maxY=Math.max(m.maxY,v.maxY),m}function u(m,v){return m.minX-v.minX}function h(m,v){return m.minY-v.minY}function p(m){return(m.maxX-m.minX)*(m.maxY-m.minY)}function y(m){return m.maxX-m.minX+(m.maxY-m.minY)}function E(m,v){return m.minX<=v.minX&&m.minY<=v.minY&&v.maxX<=m.maxX&&v.maxY<=m.maxY}function k(m,v){return v.minX<=m.maxX&&v.minY<=m.maxY&&v.maxX>=m.minX&&v.maxY>=m.minY}function X(m){return{children:m,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function C(m,v,l,g,x){for(var A=[v,l];A.length;)if(!((l=A.pop())-(v=A.pop())<=g)){var I=v+Math.ceil((l-v)/g/2)*g;e(m,I,v,l,x),A.push(v,I,I,l)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(m){var v=this.data,l=[];if(!k(m,v))return l;for(var g=this.toBBox,x=[];v;){for(var A=0;A<v.children.length;A++){var I=v.children[A],b=v.leaf?g(I):I;k(m,b)&&(v.leaf?l.push(I):E(m,b)?this._all(I,l):x.push(I))}v=x.pop()}return l},i.prototype.collides=function(m){var v=this.data;if(!k(m,v))return!1;for(var l=[];v;){for(var g=0;g<v.children.length;g++){var x=v.children[g],A=v.leaf?this.toBBox(x):x;if(k(m,A)){if(v.leaf||E(m,A))return!0;l.push(x)}}v=l.pop()}return!1},i.prototype.load=function(m){if(!m||!m.length)return this;if(m.length<this._minEntries){for(var v=0;v<m.length;v++)this.insert(m[v]);return this}var l=this._build(m.slice(),0,m.length-1,0);if(this.data.children.length)if(this.data.height===l.height)this._splitRoot(this.data,l);else{if(this.data.height<l.height){var g=this.data;this.data=l,l=g}this._insert(l,this.data.height-l.height-1,!0)}else this.data=l;return this},i.prototype.insert=function(m){return m&&this._insert(m,this.data.height-1),this},i.prototype.clear=function(){return this.data=X([]),this},i.prototype.remove=function(m,v){if(!m)return this;for(var l,g,x,A=this.data,I=this.toBBox(m),b=[],T=[];A||b.length;){if(A||(A=b.pop(),g=b[b.length-1],l=T.pop(),x=!0),A.leaf){var Y=o(m,A.children,v);if(Y!==-1)return A.children.splice(Y,1),b.push(A),this._condense(b),this}x||A.leaf||!E(A,I)?g?(l++,A=g.children[l],x=!1):A=null:(b.push(A),T.push(l),l=0,g=A,A=A.children[0])}return this},i.prototype.toBBox=function(m){return m},i.prototype.compareMinX=function(m,v){return m.minX-v.minX},i.prototype.compareMinY=function(m,v){return m.minY-v.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(m){return this.data=m,this},i.prototype._all=function(m,v){for(var l=[];m;)m.leaf?v.push.apply(v,m.children):l.push.apply(l,m.children),m=l.pop();return v},i.prototype._build=function(m,v,l,g){var x,A=l-v+1,I=this._maxEntries;if(A<=I)return a(x=X(m.slice(v,l+1)),this.toBBox),x;g||(g=Math.ceil(Math.log(A)/Math.log(I)),I=Math.ceil(A/Math.pow(I,g-1))),(x=X([])).leaf=!1,x.height=g;var b=Math.ceil(A/I),T=b*Math.ceil(Math.sqrt(I));C(m,v,l,T,this.compareMinX);for(var Y=v;Y<=l;Y+=T){var D=Math.min(Y+T-1,l);C(m,Y,D,b,this.compareMinY);for(var Q=Y;Q<=D;Q+=b){var d=Math.min(Q+b-1,D);x.children.push(this._build(m,Q,d,g-1))}}return a(x,this.toBBox),x},i.prototype._chooseSubtree=function(m,v,l,g){for(;g.push(v),!v.leaf&&g.length-1!==l;){for(var x=1/0,A=1/0,I=void 0,b=0;b<v.children.length;b++){var T=v.children[b],Y=p(T),D=(Q=m,d=T,(Math.max(d.maxX,Q.maxX)-Math.min(d.minX,Q.minX))*(Math.max(d.maxY,Q.maxY)-Math.min(d.minY,Q.minY))-Y);D<A?(A=D,x=Y<x?Y:x,I=T):D===A&&Y<x&&(x=Y,I=T)}v=I||v.children[0]}var Q,d;return v},i.prototype._insert=function(m,v,l){var g=l?m:this.toBBox(m),x=[],A=this._chooseSubtree(g,this.data,v,x);for(A.children.push(m),f(A,g);v>=0&&x[v].children.length>this._maxEntries;)this._split(x,v),v--;this._adjustParentBBoxes(g,x,v)},i.prototype._split=function(m,v){var l=m[v],g=l.children.length,x=this._minEntries;this._chooseSplitAxis(l,x,g);var A=this._chooseSplitIndex(l,x,g),I=X(l.children.splice(A,l.children.length-A));I.height=l.height,I.leaf=l.leaf,a(l,this.toBBox),a(I,this.toBBox),v?m[v-1].children.push(I):this._splitRoot(l,I)},i.prototype._splitRoot=function(m,v){this.data=X([m,v]),this.data.height=m.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(m,v,l){for(var g,x,A,I,b,T,Y,D=1/0,Q=1/0,d=v;d<=l-v;d++){var M=c(m,0,d,this.toBBox),_=c(m,d,l,this.toBBox),B=(x=M,A=_,I=void 0,b=void 0,T=void 0,Y=void 0,I=Math.max(x.minX,A.minX),b=Math.max(x.minY,A.minY),T=Math.min(x.maxX,A.maxX),Y=Math.min(x.maxY,A.maxY),Math.max(0,T-I)*Math.max(0,Y-b)),N=p(M)+p(_);B<D?(D=B,g=d,Q=N<Q?N:Q):B===D&&N<Q&&(Q=N,g=d)}return g||l-v},i.prototype._chooseSplitAxis=function(m,v,l){var g=m.leaf?this.compareMinX:u,x=m.leaf?this.compareMinY:h;this._allDistMargin(m,v,l,g)<this._allDistMargin(m,v,l,x)&&m.children.sort(g)},i.prototype._allDistMargin=function(m,v,l,g){m.children.sort(g);for(var x=this.toBBox,A=c(m,0,v,x),I=c(m,l-v,l,x),b=y(A)+y(I),T=v;T<l-v;T++){var Y=m.children[T];f(A,m.leaf?x(Y):Y),b+=y(A)}for(var D=l-v-1;D>=v;D--){var Q=m.children[D];f(I,m.leaf?x(Q):Q),b+=y(I)}return b},i.prototype._adjustParentBBoxes=function(m,v,l){for(var g=l;g>=0;g--)f(v[g],m)},i.prototype._condense=function(m){for(var v=m.length-1,l=void 0;v>=0;v--)m[v].children.length===0?v>0?(l=m[v-1].children).splice(l.indexOf(m[v]),1):this.clear():a(m[v],this.toBBox)},i})})(Re)),Re.exports}let pr=class{constructor(t=[],e=mr){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,i=e[t];for(;t<r;){let o=(t<<1)+1,a=e[o];const c=o+1;if(c<this.length&&n(e[c],a)<0&&(o=c,a=e[c]),n(a,i)>=0)break;e[t]=a,t=o}e[t]=i}};function mr(s,t){return s<t?-1:s>t?1:0}const gr=ur(Object.freeze(Object.defineProperty({__proto__:null,default:pr},Symbol.toStringTag,{value:"Module"})));var xe={exports:{}},Ze,vn;function wr(){return vn||(vn=1,Ze=function(t,e,n,r){var i=t[0],o=t[1],a=!1;n===void 0&&(n=0),r===void 0&&(r=e.length);for(var c=(r-n)/2,f=0,u=c-1;f<c;u=f++){var h=e[n+f*2+0],p=e[n+f*2+1],y=e[n+u*2+0],E=e[n+u*2+1],k=p>o!=E>o&&i<(y-h)*(o-p)/(E-p)+h;k&&(a=!a)}return a}),Ze}var tn,bn;function yr(){return bn||(bn=1,tn=function(t,e,n,r){var i=t[0],o=t[1],a=!1;n===void 0&&(n=0),r===void 0&&(r=e.length);for(var c=r-n,f=0,u=c-1;f<c;u=f++){var h=e[f+n][0],p=e[f+n][1],y=e[u+n][0],E=e[u+n][1],k=p>o!=E>o&&i<(y-h)*(o-p)/(E-p)+h;k&&(a=!a)}return a}),tn}var _n;function vr(){if(_n)return xe.exports;_n=1;var s=wr(),t=yr();return xe.exports=function(n,r,i,o){return r.length>0&&Array.isArray(r[0])?t(n,r,i,o):s(n,r,i,o)},xe.exports.nested=t,xe.exports.flat=s,xe.exports}var Me={exports:{}},br=Me.exports,xn;function _r(){return xn||(xn=1,(function(s,t){(function(e,n){n(t)})(br,function(e){const r=33306690738754706e-32;function i(k,X,C,m,v){let l,g,x,A,I=X[0],b=m[0],T=0,Y=0;b>I==b>-I?(l=I,I=X[++T]):(l=b,b=m[++Y]);let D=0;if(T<k&&Y<C)for(b>I==b>-I?(x=l-((g=I+l)-I),I=X[++T]):(x=l-((g=b+l)-b),b=m[++Y]),l=g,x!==0&&(v[D++]=x);T<k&&Y<C;)b>I==b>-I?(x=l-((g=l+I)-(A=g-l))+(I-A),I=X[++T]):(x=l-((g=l+b)-(A=g-l))+(b-A),b=m[++Y]),l=g,x!==0&&(v[D++]=x);for(;T<k;)x=l-((g=l+I)-(A=g-l))+(I-A),I=X[++T],l=g,x!==0&&(v[D++]=x);for(;Y<C;)x=l-((g=l+b)-(A=g-l))+(b-A),b=m[++Y],l=g,x!==0&&(v[D++]=x);return l===0&&D!==0||(v[D++]=l),D}function o(k){return new Float64Array(k)}const a=33306690738754716e-32,c=22204460492503146e-32,f=11093356479670487e-47,u=o(4),h=o(8),p=o(12),y=o(16),E=o(4);e.orient2d=function(k,X,C,m,v,l){const g=(X-l)*(C-v),x=(k-v)*(m-l),A=g-x;if(g===0||x===0||g>0!=x>0)return A;const I=Math.abs(g+x);return Math.abs(A)>=a*I?A:-(function(b,T,Y,D,Q,d,M){let _,B,N,R,w,O,$,j,V,z,K,U,ct,ft,dt,pt,gt,mt;const Pt=b-Q,Nt=Y-Q,xt=T-d,Mt=D-d;w=(dt=(j=Pt-($=(O=134217729*Pt)-(O-Pt)))*(z=Mt-(V=(O=134217729*Mt)-(O-Mt)))-((ft=Pt*Mt)-$*V-j*V-$*z))-(K=dt-(gt=(j=xt-($=(O=134217729*xt)-(O-xt)))*(z=Nt-(V=(O=134217729*Nt)-(O-Nt)))-((pt=xt*Nt)-$*V-j*V-$*z))),u[0]=dt-(K+w)+(w-gt),w=(ct=ft-((U=ft+K)-(w=U-ft))+(K-w))-(K=ct-pt),u[1]=ct-(K+w)+(w-pt),w=(mt=U+K)-U,u[2]=U-(mt-w)+(K-w),u[3]=mt;let ee=(function(S,P){let F=P[0];for(let L=1;L<S;L++)F+=P[L];return F})(4,u),pe=c*M;if(ee>=pe||-ee>=pe||(_=b-(Pt+(w=b-Pt))+(w-Q),N=Y-(Nt+(w=Y-Nt))+(w-Q),B=T-(xt+(w=T-xt))+(w-d),R=D-(Mt+(w=D-Mt))+(w-d),_===0&&B===0&&N===0&&R===0)||(pe=f*M+r*Math.abs(ee),(ee+=Pt*R+Mt*_-(xt*N+Nt*B))>=pe||-ee>=pe))return ee;w=(dt=(j=_-($=(O=134217729*_)-(O-_)))*(z=Mt-(V=(O=134217729*Mt)-(O-Mt)))-((ft=_*Mt)-$*V-j*V-$*z))-(K=dt-(gt=(j=B-($=(O=134217729*B)-(O-B)))*(z=Nt-(V=(O=134217729*Nt)-(O-Nt)))-((pt=B*Nt)-$*V-j*V-$*z))),E[0]=dt-(K+w)+(w-gt),w=(ct=ft-((U=ft+K)-(w=U-ft))+(K-w))-(K=ct-pt),E[1]=ct-(K+w)+(w-pt),w=(mt=U+K)-U,E[2]=U-(mt-w)+(K-w),E[3]=mt;const fn=i(4,u,4,E,h);w=(dt=(j=Pt-($=(O=134217729*Pt)-(O-Pt)))*(z=R-(V=(O=134217729*R)-(O-R)))-((ft=Pt*R)-$*V-j*V-$*z))-(K=dt-(gt=(j=xt-($=(O=134217729*xt)-(O-xt)))*(z=N-(V=(O=134217729*N)-(O-N)))-((pt=xt*N)-$*V-j*V-$*z))),E[0]=dt-(K+w)+(w-gt),w=(ct=ft-((U=ft+K)-(w=U-ft))+(K-w))-(K=ct-pt),E[1]=ct-(K+w)+(w-pt),w=(mt=U+K)-U,E[2]=U-(mt-w)+(K-w),E[3]=mt;const hn=i(fn,h,4,E,p);w=(dt=(j=_-($=(O=134217729*_)-(O-_)))*(z=R-(V=(O=134217729*R)-(O-R)))-((ft=_*R)-$*V-j*V-$*z))-(K=dt-(gt=(j=B-($=(O=134217729*B)-(O-B)))*(z=N-(V=(O=134217729*N)-(O-N)))-((pt=B*N)-$*V-j*V-$*z))),E[0]=dt-(K+w)+(w-gt),w=(ct=ft-((U=ft+K)-(w=U-ft))+(K-w))-(K=ct-pt),E[1]=ct-(K+w)+(w-pt),w=(mt=U+K)-U,E[2]=U-(mt-w)+(K-w),E[3]=mt;const jt=i(hn,p,4,E,y);return y[jt-1]})(k,X,C,m,v,l,I)},e.orient2dfast=function(k,X,C,m,v,l){return(X-l)*(C-v)-(k-v)*(m-l)},Object.defineProperty(e,"__esModule",{value:!0})})})(Me,Me.exports)),Me.exports}var Mn;function xr(){if(Mn)return Xe.exports;Mn=1;var s=dr(),t=gr,e=vr(),n=_r().orient2d;t.default&&(t=t.default),Xe.exports=r,Xe.exports.default=r;function r(l,g,x){g=Math.max(0,g===void 0?2:g),x=x||0;var A=y(l),I=new s(16);I.toBBox=function($){return{minX:$[0],minY:$[1],maxX:$[0],maxY:$[1]}},I.compareMinX=function($,j){return $[0]-j[0]},I.compareMinY=function($,j){return $[1]-j[1]},I.load(l);for(var b=[],T=0,Y;T<A.length;T++){var D=A[T];I.remove(D),Y=E(D,Y),b.push(Y)}var Q=new s(16);for(T=0;T<b.length;T++)Q.insert(p(b[T]));for(var d=g*g,M=x*x;b.length;){var _=b.shift(),B=_.p,N=_.next.p,R=k(B,N);if(!(R<M)){var w=R/d;D=i(I,_.prev.p,B,N,_.next.next.p,w,Q),D&&Math.min(k(D,B),k(D,N))<=w&&(b.push(_),b.push(E(D,_)),I.remove(D),Q.remove(_),Q.insert(p(_)),Q.insert(p(_.next)))}}_=Y;var O=[];do O.push(_.p),_=_.next;while(_!==Y);return O.push(_.p),O}function i(l,g,x,A,I,b,T){for(var Y=new t([],o),D=l.data;D;){for(var Q=0;Q<D.children.length;Q++){var d=D.children[Q],M=D.leaf?X(d,x,A):a(x,A,d);M>b||Y.push({node:d,dist:M})}for(;Y.length&&!Y.peek().node.children;){var _=Y.pop(),B=_.node,N=X(B,g,x),R=X(B,A,I);if(_.dist<N&&_.dist<R&&f(x,B,T)&&f(A,B,T))return B}D=Y.pop(),D&&(D=D.node)}return null}function o(l,g){return l.dist-g.dist}function a(l,g,x){if(c(l,x)||c(g,x))return 0;var A=C(l[0],l[1],g[0],g[1],x.minX,x.minY,x.maxX,x.minY);if(A===0)return 0;var I=C(l[0],l[1],g[0],g[1],x.minX,x.minY,x.minX,x.maxY);if(I===0)return 0;var b=C(l[0],l[1],g[0],g[1],x.maxX,x.minY,x.maxX,x.maxY);if(b===0)return 0;var T=C(l[0],l[1],g[0],g[1],x.minX,x.maxY,x.maxX,x.maxY);return T===0?0:Math.min(A,I,b,T)}function c(l,g){return l[0]>=g.minX&&l[0]<=g.maxX&&l[1]>=g.minY&&l[1]<=g.maxY}function f(l,g,x){for(var A=Math.min(l[0],g[0]),I=Math.min(l[1],g[1]),b=Math.max(l[0],g[0]),T=Math.max(l[1],g[1]),Y=x.search({minX:A,minY:I,maxX:b,maxY:T}),D=0;D<Y.length;D++)if(h(Y[D].p,Y[D].next.p,l,g))return!1;return!0}function u(l,g,x){return n(l[0],l[1],g[0],g[1],x[0],x[1])}function h(l,g,x,A){return l!==A&&g!==x&&u(l,g,x)>0!=u(l,g,A)>0&&u(x,A,l)>0!=u(x,A,g)>0}function p(l){var g=l.p,x=l.next.p;return l.minX=Math.min(g[0],x[0]),l.minY=Math.min(g[1],x[1]),l.maxX=Math.max(g[0],x[0]),l.maxY=Math.max(g[1],x[1]),l}function y(l){for(var g=l[0],x=l[0],A=l[0],I=l[0],b=0;b<l.length;b++){var T=l[b];T[0]<g[0]&&(g=T),T[0]>A[0]&&(A=T),T[1]<x[1]&&(x=T),T[1]>I[1]&&(I=T)}var Y=[g,x,A,I],D=Y.slice();for(b=0;b<l.length;b++)e(l[b],Y)||D.push(l[b]);return v(D)}function E(l,g){var x={p:l,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return g?(x.next=g.next,x.prev=g,g.next.prev=x,g.next=x):(x.prev=x,x.next=x),x}function k(l,g){var x=l[0]-g[0],A=l[1]-g[1];return x*x+A*A}function X(l,g,x){var A=g[0],I=g[1],b=x[0]-A,T=x[1]-I;if(b!==0||T!==0){var Y=((l[0]-A)*b+(l[1]-I)*T)/(b*b+T*T);Y>1?(A=x[0],I=x[1]):Y>0&&(A+=b*Y,I+=T*Y)}return b=l[0]-A,T=l[1]-I,b*b+T*T}function C(l,g,x,A,I,b,T,Y){var D=x-l,Q=A-g,d=T-I,M=Y-b,_=l-I,B=g-b,N=D*D+Q*Q,R=D*d+Q*M,w=d*d+M*M,O=D*_+Q*B,$=d*_+M*B,j=N*w-R*R,V,z,K,U,ct=j,ft=j;j===0?(z=0,ct=1,U=$,ft=w):(z=R*$-w*O,U=N*$-R*O,z<0?(z=0,U=$,ft=w):z>ct&&(z=ct,U=$+R,ft=w)),U<0?(U=0,-O<0?z=0:-O>N?z=ct:(z=-O,ct=N)):U>ft&&(U=ft,-O+R<0?z=0:-O+R>N?z=ct:(z=-O+R,ct=N)),V=z===0?0:z/ct,K=U===0?0:U/ft;var dt=(1-V)*l+V*x,pt=(1-V)*g+V*A,gt=(1-K)*I+K*T,mt=(1-K)*b+K*Y,Pt=gt-dt,Nt=mt-pt;return Pt*Pt+Nt*Nt}function m(l,g){return l[0]===g[0]?l[1]-g[1]:l[0]-g[0]}function v(l){l.sort(m);for(var g=[],x=0;x<l.length;x++){for(;g.length>=2&&u(g[g.length-2],g[g.length-1],l[x])<=0;)g.pop();g.push(l[x])}for(var A=[],I=l.length-1;I>=0;I--){for(;A.length>=2&&u(A[A.length-2],A[A.length-1],l[I])<=0;)A.pop();A.push(l[I])}return A.pop(),g.pop(),g.concat(A)}return Xe.exports}var Mr=xr();const kr=hr(Mr);function Sr(s,t={}){t.concavity=t.concavity||1/0;const e=[];if(He(s,r=>{e.push([r[0],r[1]])}),!e.length)return null;const n=kr(e,t.concavity);return n.length>3?_e([n]):null}var kn=Sr,ke={exports:{}},Er=ke.exports,Sn;function Ar(){return Sn||(Sn=1,(function(s,t){(function(e,n){n(t)})(Er,function(e){const n=11102230246251565e-32,r=134217729,i=(3+8*n)*n;function o(S,P,F,L,tt){let G,et,ot,it,at=P[0],ht=L[0],J=0,Z=0;ht>at==ht>-at?(G=at,at=P[++J]):(G=ht,ht=L[++Z]);let ut=0;if(J<S&&Z<F)for(ht>at==ht>-at?(et=at+G,ot=G-(et-at),at=P[++J]):(et=ht+G,ot=G-(et-ht),ht=L[++Z]),G=et,ot!==0&&(tt[ut++]=ot);J<S&&Z<F;)ht>at==ht>-at?(et=G+at,it=et-G,ot=G-(et-it)+(at-it),at=P[++J]):(et=G+ht,it=et-G,ot=G-(et-it)+(ht-it),ht=L[++Z]),G=et,ot!==0&&(tt[ut++]=ot);for(;J<S;)et=G+at,it=et-G,ot=G-(et-it)+(at-it),at=P[++J],G=et,ot!==0&&(tt[ut++]=ot);for(;Z<F;)et=G+ht,it=et-G,ot=G-(et-it)+(ht-it),ht=L[++Z],G=et,ot!==0&&(tt[ut++]=ot);return(G!==0||ut===0)&&(tt[ut++]=G),ut}function a(S,P){let F=P[0];for(let L=1;L<S;L++)F+=P[L];return F}function c(S){return new Float64Array(S)}const f=(3+16*n)*n,u=(2+12*n)*n,h=(9+64*n)*n*n,p=c(4),y=c(8),E=c(12),k=c(16),X=c(4);function C(S,P,F,L,tt,G,et){let ot,it,at,ht,J,Z,ut,_t,nt,H,W,wt,Et,At,Xt,vt,Tt,Ct;const Wt=S-tt,Jt=F-tt,Kt=P-G,Gt=L-G;At=Wt*Gt,Z=r*Wt,ut=Z-(Z-Wt),_t=Wt-ut,Z=r*Gt,nt=Z-(Z-Gt),H=Gt-nt,Xt=_t*H-(At-ut*nt-_t*nt-ut*H),vt=Kt*Jt,Z=r*Kt,ut=Z-(Z-Kt),_t=Kt-ut,Z=r*Jt,nt=Z-(Z-Jt),H=Jt-nt,Tt=_t*H-(vt-ut*nt-_t*nt-ut*H),W=Xt-Tt,J=Xt-W,p[0]=Xt-(W+J)+(J-Tt),wt=At+W,J=wt-At,Et=At-(wt-J)+(W-J),W=Et-vt,J=Et-W,p[1]=Et-(W+J)+(J-vt),Ct=wt+W,J=Ct-wt,p[2]=wt-(Ct-J)+(W-J),p[3]=Ct;let me=a(4,p),Oe=u*et;if(me>=Oe||-me>=Oe||(J=S-Wt,ot=S-(Wt+J)+(J-tt),J=F-Jt,at=F-(Jt+J)+(J-tt),J=P-Kt,it=P-(Kt+J)+(J-G),J=L-Gt,ht=L-(Gt+J)+(J-G),ot===0&&it===0&&at===0&&ht===0)||(Oe=h*et+i*Math.abs(me),me+=Wt*ht+Gt*ot-(Kt*at+Jt*it),me>=Oe||-me>=Oe))return me;At=ot*Gt,Z=r*ot,ut=Z-(Z-ot),_t=ot-ut,Z=r*Gt,nt=Z-(Z-Gt),H=Gt-nt,Xt=_t*H-(At-ut*nt-_t*nt-ut*H),vt=it*Jt,Z=r*it,ut=Z-(Z-it),_t=it-ut,Z=r*Jt,nt=Z-(Z-Jt),H=Jt-nt,Tt=_t*H-(vt-ut*nt-_t*nt-ut*H),W=Xt-Tt,J=Xt-W,X[0]=Xt-(W+J)+(J-Tt),wt=At+W,J=wt-At,Et=At-(wt-J)+(W-J),W=Et-vt,J=Et-W,X[1]=Et-(W+J)+(J-vt),Ct=wt+W,J=Ct-wt,X[2]=wt-(Ct-J)+(W-J),X[3]=Ct;const Si=o(4,p,4,X,y);At=Wt*ht,Z=r*Wt,ut=Z-(Z-Wt),_t=Wt-ut,Z=r*ht,nt=Z-(Z-ht),H=ht-nt,Xt=_t*H-(At-ut*nt-_t*nt-ut*H),vt=Kt*at,Z=r*Kt,ut=Z-(Z-Kt),_t=Kt-ut,Z=r*at,nt=Z-(Z-at),H=at-nt,Tt=_t*H-(vt-ut*nt-_t*nt-ut*H),W=Xt-Tt,J=Xt-W,X[0]=Xt-(W+J)+(J-Tt),wt=At+W,J=wt-At,Et=At-(wt-J)+(W-J),W=Et-vt,J=Et-W,X[1]=Et-(W+J)+(J-vt),Ct=wt+W,J=Ct-wt,X[2]=wt-(Ct-J)+(W-J),X[3]=Ct;const Ei=o(Si,y,4,X,E);At=ot*ht,Z=r*ot,ut=Z-(Z-ot),_t=ot-ut,Z=r*ht,nt=Z-(Z-ht),H=ht-nt,Xt=_t*H-(At-ut*nt-_t*nt-ut*H),vt=it*at,Z=r*it,ut=Z-(Z-it),_t=it-ut,Z=r*at,nt=Z-(Z-at),H=at-nt,Tt=_t*H-(vt-ut*nt-_t*nt-ut*H),W=Xt-Tt,J=Xt-W,X[0]=Xt-(W+J)+(J-Tt),wt=At+W,J=wt-At,Et=At-(wt-J)+(W-J),W=Et-vt,J=Et-W,X[1]=Et-(W+J)+(J-vt),Ct=wt+W,J=Ct-wt,X[2]=wt-(Ct-J)+(W-J),X[3]=Ct;const Ai=o(Ei,E,4,X,k);return k[Ai-1]}function m(S,P,F,L,tt,G){const et=(P-G)*(F-tt),ot=(S-tt)*(L-G),it=et-ot,at=Math.abs(et+ot);return Math.abs(it)>=f*at?it:-C(S,P,F,L,tt,G,at)}function v(S,P){var F,L,tt=0,G,et,ot,it,at,ht,J,Z=S[0],ut=S[1],_t=P.length;for(F=0;F<_t;F++){L=0;var nt=P[F],H=nt.length-1;if(ht=nt[0],ht[0]!==nt[H][0]&&ht[1]!==nt[H][1])throw new Error("First and last coordinates in a ring must be the same");for(et=ht[0]-Z,ot=ht[1]-ut,L;L<H;L++){if(J=nt[L+1],it=J[0]-Z,at=J[1]-ut,ot===0&&at===0){if(it<=0&&et>=0||et<=0&&it>=0)return 0}else if(at>=0&&ot<=0||at<=0&&ot>=0){if(G=m(et,it,ot,at,0,0),G===0)return 0;(G>0&&at>0&&ot<=0||G<0&&at<=0&&ot>0)&&tt++}ht=J,ot=at,et=it}}return tt%2!==0}function l(S,P,F={}){const L={type:"Feature"};return(F.id===0||F.id)&&(L.id=F.id),F.bbox&&(L.bbox=F.bbox),L.properties=P||{},L.geometry=S,L}function g(S,P,F={}){if(!S)throw new Error("coordinates is required");if(!Array.isArray(S))throw new Error("coordinates must be an Array");if(S.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!I(S[0])||!I(S[1]))throw new Error("coordinates must contain numbers");return l({type:"Point",coordinates:S},P,F)}function x(S,P,F={}){for(const L of S){if(L.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(L[L.length-1].length!==L[0].length)throw new Error("First and last Position are not equivalent.");for(let tt=0;tt<L[L.length-1].length;tt++)if(L[L.length-1][tt]!==L[0][tt])throw new Error("First and last Position are not equivalent.")}return l({type:"Polygon",coordinates:S},P,F)}function A(S,P={}){const F={type:"FeatureCollection"};return P.id&&(F.id=P.id),P.bbox&&(F.bbox=P.bbox),F.features=S,F}function I(S){return!isNaN(S)&&S!==null&&!Array.isArray(S)}function b(S){if(!S)throw new Error("coord is required");if(!Array.isArray(S)){if(S.type==="Feature"&&S.geometry!==null&&S.geometry.type==="Point")return[...S.geometry.coordinates];if(S.type==="Point")return[...S.coordinates]}if(Array.isArray(S)&&S.length>=2&&!Array.isArray(S[0])&&!Array.isArray(S[1]))return[...S];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function T(S){if(Array.isArray(S))return S;if(S.type==="Feature"){if(S.geometry!==null)return S.geometry.coordinates}else if(S.coordinates)return S.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Y(S){return S.type==="Feature"?S.geometry:S}function D(S,P,F={}){if(!S)throw new Error("point is required");if(!P)throw new Error("polygon is required");const L=b(S),tt=Y(P),G=tt.type,et=P.bbox;let ot=tt.coordinates;if(et&&Q(L,et)===!1)return!1;G==="Polygon"&&(ot=[ot]);let it=!1;for(var at=0;at<ot.length;++at){const ht=v(L,ot[at]);if(ht===0)return!F.ignoreBoundary;ht&&(it=!0)}return it}function Q(S,P){return P[0]<=S[0]&&P[1]<=S[1]&&P[2]>=S[0]&&P[3]>=S[1]}var d=D;function M(S,P){for(let F=0;F<P.features.length;F++)if(d(S,P.features[F]))return P.features[F]}function _(S,P,F){const L=P.geometry.coordinates[0][0],tt=P.geometry.coordinates[0][1],G=P.geometry.coordinates[0][2],et=S.geometry.coordinates,ot=P.properties.a.geom,it=P.properties.b.geom,at=P.properties.c.geom,ht=[tt[0]-L[0],tt[1]-L[1]],J=[G[0]-L[0],G[1]-L[1]],Z=[et[0]-L[0],et[1]-L[1]],ut=[it[0]-ot[0],it[1]-ot[1]],_t=[at[0]-ot[0],at[1]-ot[1]];let nt=(J[1]*Z[0]-J[0]*Z[1])/(ht[0]*J[1]-ht[1]*J[0]),H=(ht[0]*Z[1]-ht[1]*Z[0])/(ht[0]*J[1]-ht[1]*J[0]);if(F){const W=F[P.properties.a.index],wt=F[P.properties.b.index],Et=F[P.properties.c.index];let At;if(nt<0||H<0||1-nt-H<0){const Xt=nt/(nt+H),vt=H/(nt+H);At=nt/wt/(Xt/wt+vt/Et),H=H/Et/(Xt/wt+vt/Et)}else At=nt/wt/(nt/wt+H/Et+(1-nt-H)/W),H=H/Et/(nt/wt+H/Et+(1-nt-H)/W);nt=At}return[nt*ut[0]+H*_t[0]+ot[0],nt*ut[1]+H*_t[1]+ot[1]]}function B(S,P,F,L){const tt=S.geometry.coordinates,G=F.geometry.coordinates,et=Math.atan2(tt[0]-G[0],tt[1]-G[1]),ot=w(et,P[0]);if(ot===void 0)throw new Error("Unable to determine vertex index");const it=P[1][ot];return _(S,it.features[0],L)}function N(S,P,F,L,tt,G,et,ot){let it;if(et&&(it=M(S,A([et]))),!it){if(F){const at=S.geometry.coordinates,ht=F.gridNum,J=F.xOrigin,Z=F.yOrigin,ut=F.xUnit,_t=F.yUnit,nt=F.gridCache,H=R(at[0],J,ut,ht),W=R(at[1],Z,_t,ht),wt=nt[H]?nt[H][W]?nt[H][W]:[]:[];P=A(wt.map(Et=>P.features[Et]))}it=M(S,P)}return ot&&ot(it),it?_(S,it,G):B(S,L,tt,G)}function R(S,P,F,L){let tt=Math.floor((S-P)/F);return tt>=L&&(tt=L-1),tt}function w(S,P){let F=O(S-P[0]),L=Math.PI*2,tt;for(let G=0;G<P.length;G++){const et=(G+1)%P.length,ot=O(S-P[et]),it=Math.min(Math.abs(F),Math.abs(ot));F*ot<=0&&it<L&&(L=it,tt=G),F=ot}return tt}function O(S,P=!1){const F=P?function(L){return!(L>=0&&L<Math.PI*2)}:function(L){return!(L>-1*Math.PI&&L<=Math.PI)};for(;F(S);)S=S+2*Math.PI*(S>0?-1:1);return S}function $(S,P){return P&&P>=2.00703||Array.isArray(S[0])?S:S.map(F=>[F.illstNodes,F.mercNodes,F.startEnd])}function j(S){const P=S.features;for(let F=0;F<P.length;F++){const L=P[F];`${L.properties.a.index}`.substring(0,1)==="b"&&`${L.properties.b.index}`.substring(0,1)==="b"?P[F]={geometry:{type:"Polygon",coordinates:[[L.geometry.coordinates[0][2],L.geometry.coordinates[0][0],L.geometry.coordinates[0][1],L.geometry.coordinates[0][2]]]},properties:{a:{geom:L.properties.c.geom,index:L.properties.c.index},b:{geom:L.properties.a.geom,index:L.properties.a.index},c:{geom:L.properties.b.geom,index:L.properties.b.index}},type:"Feature"}:`${L.properties.c.index}`.substring(0,1)==="b"&&`${L.properties.a.index}`.substring(0,1)==="b"&&(P[F]={geometry:{type:"Polygon",coordinates:[[L.geometry.coordinates[0][1],L.geometry.coordinates[0][2],L.geometry.coordinates[0][0],L.geometry.coordinates[0][1]]]},properties:{a:{geom:L.properties.b.geom,index:L.properties.b.index},b:{geom:L.properties.c.geom,index:L.properties.c.index},c:{geom:L.properties.a.geom,index:L.properties.a.index}},type:"Feature"})}return S}function V(S){const P=["a","b","c","a"].map(G=>S.properties[G].geom),F=S.geometry.coordinates[0],L=S.properties,tt={a:{geom:F[0],index:L.a.index},b:{geom:F[1],index:L.b.index},c:{geom:F[2],index:L.c.index}};return x([P],tt)}function z(S){const P=[0,1,2,0].map(L=>S[L][0][0]),F={a:{geom:S[0][0][1],index:S[0][1]},b:{geom:S[1][0][1],index:S[1][1]},c:{geom:S[2][0][1],index:S[2][1]}};return x([P],F)}function K(S,P,F,L,tt,G=!1,et){const ot=S.map(it=>{(!et||et<2.00703)&&(it=U(it));const at=isFinite(it)?P[it]:it==="c"?L:it==="b0"?tt[0]:it==="b1"?tt[1]:it==="b2"?tt[2]:it==="b3"?tt[3]:(function(){const ht=it.match(/e(\d+)/);if(ht){const J=parseInt(ht[1]);return F[J]}throw"Bad index value for indexesToTri"})();return G?[[at[1],at[0]],it]:[[at[0],at[1]],it]});return z(ot)}function U(S){return typeof S=="number"?S:S.replace(/^(c|e|b)(?:ent|dgeNode|box)(\d+)?$/,"$1$2")}const ct=2.00703;function ft(S){return!!(S.version||!S.tins&&S.points&&S.tins_points)}function dt(S){return{points:S.points,pointsWeightBuffer:gt(S),strictStatus:mt(S),verticesParams:Pt(S),centroid:xt(S),edges:$(S.edges||[]),edgeNodes:S.edgeNodes||[],tins:Mt(S),kinks:ee(S.kinks_points),yaxisMode:S.yaxisMode??"invert",strictMode:S.strictMode??"auto",vertexMode:S.vertexMode,bounds:S.bounds,boundsPolygon:S.boundsPolygon,wh:S.wh,xy:S.bounds?S.xy:[0,0]}}function pt(S){const P=pe(S),F=P.tins;return{compiled:P,tins:F,points:fn(F),strictStatus:P.strict_status,pointsWeightBuffer:P.weight_buffer,verticesParams:P.vertices_params,centroid:P.centroid,kinks:P.kinks}}function gt(S){return!S.version||S.version<ct?["forw","bakw"].reduce((P,F)=>{const L=S.weight_buffer[F];return L&&(P[F]=Object.keys(L).reduce((tt,G)=>{const et=U(G);return tt[et]=L[G],tt},{})),P},{}):S.weight_buffer}function mt(S){return S.strict_status?S.strict_status:S.kinks_points?"strict_error":S.tins_points.length===2?"loose":"strict"}function Pt(S){const P={forw:[S.vertices_params[0]],bakw:[S.vertices_params[1]]};return P.forw[1]=Nt(S,!1),P.bakw[1]=Nt(S,!0),P}function Nt(S,P){return[0,1,2,3].map(F=>{const L=(F+1)%4,tt=K(["c",`b${F}`,`b${L}`],S.points,S.edgeNodes||[],S.centroid_point,S.vertices_points,P,ct);return A([tt])})}function xt(S){return{forw:g(S.centroid_point[0],{target:{geom:S.centroid_point[1],index:"c"}}),bakw:g(S.centroid_point[1],{target:{geom:S.centroid_point[0],index:"c"}})}}function Mt(S){const P=S.tins_points.length===1?0:1;return{forw:A(S.tins_points[0].map(F=>K(F,S.points,S.edgeNodes||[],S.centroid_point,S.vertices_points,!1,S.version))),bakw:A(S.tins_points[P].map(F=>K(F,S.points,S.edgeNodes||[],S.centroid_point,S.vertices_points,!0,S.version)))}}function ee(S){if(S)return{bakw:A(S.map(P=>g(P)))}}function pe(S){return JSON.parse(JSON.stringify(S).replace('"cent"','"c"').replace(/"bbox(\d+)"/g,'"b$1"'))}function fn(S){const P=[],F=S.forw.features;for(let L=0;L<F.length;L++){const tt=F[L];["a","b","c"].map((G,et)=>{const ot=tt.geometry.coordinates[0][et],it=tt.properties[G].geom,at=tt.properties[G].index;typeof at=="number"&&(P[at]=[ot,it])})}return P}const hn=ct;class jt{static VERTEX_PLAIN="plain";static VERTEX_BIRDEYE="birdeye";static MODE_STRICT="strict";static MODE_AUTO="auto";static MODE_LOOSE="loose";static STATUS_STRICT="strict";static STATUS_ERROR="strict_error";static STATUS_LOOSE="loose";static YAXIS_FOLLOW="follow";static YAXIS_INVERT="invert";points=[];pointsWeightBuffer;strict_status;vertices_params;centroid;edgeNodes;edges;tins;kinks;yaxisMode=jt.YAXIS_INVERT;strictMode=jt.MODE_AUTO;vertexMode=jt.VERTEX_PLAIN;bounds;boundsPolygon;wh;xy;indexedTins;stateFull=!1;stateTriangle;stateBackward;constructor(){}setCompiled(P){if(ft(P)){this.applyModernState(dt(P));return}this.applyLegacyState(pt(P))}applyModernState(P){this.points=P.points,this.pointsWeightBuffer=P.pointsWeightBuffer,this.strict_status=P.strictStatus,this.vertices_params=P.verticesParams,this.centroid=P.centroid,this.edges=P.edges,this.edgeNodes=P.edgeNodes||[],this.tins=P.tins,this.addIndexedTin(),this.kinks=P.kinks,this.yaxisMode=P.yaxisMode??jt.YAXIS_INVERT,this.vertexMode=P.vertexMode??jt.VERTEX_PLAIN,this.strictMode=P.strictMode??jt.MODE_AUTO,P.bounds?(this.bounds=P.bounds,this.boundsPolygon=P.boundsPolygon,this.xy=P.xy,this.wh=P.wh):(this.bounds=void 0,this.boundsPolygon=void 0,this.xy=P.xy??[0,0],P.wh&&(this.wh=P.wh))}applyLegacyState(P){this.tins=P.tins,this.addIndexedTin(),this.strict_status=P.strictStatus,this.pointsWeightBuffer=P.pointsWeightBuffer,this.vertices_params=P.verticesParams,this.centroid=P.centroid,this.kinks=P.kinks,this.points=P.points}addIndexedTin(){const P=this.tins,F=P.forw,L=P.bakw,tt=Math.ceil(Math.sqrt(F.features.length));if(tt<3){this.indexedTins=void 0;return}let G=[],et=[];const ot=F.features.map(nt=>{let H=[];return T(nt)[0].map(W=>{G.length===0?G=[Array.from(W),Array.from(W)]:(W[0]<G[0][0]&&(G[0][0]=W[0]),W[0]>G[1][0]&&(G[1][0]=W[0]),W[1]<G[0][1]&&(G[0][1]=W[1]),W[1]>G[1][1]&&(G[1][1]=W[1])),H.length===0?H=[Array.from(W),Array.from(W)]:(W[0]<H[0][0]&&(H[0][0]=W[0]),W[0]>H[1][0]&&(H[1][0]=W[0]),W[1]<H[0][1]&&(H[0][1]=W[1]),W[1]>H[1][1]&&(H[1][1]=W[1]))}),H}),it=(G[1][0]-G[0][0])/tt,at=(G[1][1]-G[0][1])/tt,ht=ot.reduce((nt,H,W)=>{const wt=R(H[0][0],G[0][0],it,tt),Et=R(H[1][0],G[0][0],it,tt),At=R(H[0][1],G[0][1],at,tt),Xt=R(H[1][1],G[0][1],at,tt);for(let vt=wt;vt<=Et;vt++){nt[vt]||(nt[vt]=[]);for(let Tt=At;Tt<=Xt;Tt++)nt[vt][Tt]||(nt[vt][Tt]=[]),nt[vt][Tt].push(W)}return nt},[]),J=L.features.map(nt=>{let H=[];return T(nt)[0].map(W=>{et.length===0?et=[Array.from(W),Array.from(W)]:(W[0]<et[0][0]&&(et[0][0]=W[0]),W[0]>et[1][0]&&(et[1][0]=W[0]),W[1]<et[0][1]&&(et[0][1]=W[1]),W[1]>et[1][1]&&(et[1][1]=W[1])),H.length===0?H=[Array.from(W),Array.from(W)]:(W[0]<H[0][0]&&(H[0][0]=W[0]),W[0]>H[1][0]&&(H[1][0]=W[0]),W[1]<H[0][1]&&(H[0][1]=W[1]),W[1]>H[1][1]&&(H[1][1]=W[1]))}),H}),Z=(et[1][0]-et[0][0])/tt,ut=(et[1][1]-et[0][1])/tt,_t=J.reduce((nt,H,W)=>{const wt=R(H[0][0],et[0][0],Z,tt),Et=R(H[1][0],et[0][0],Z,tt),At=R(H[0][1],et[0][1],ut,tt),Xt=R(H[1][1],et[0][1],ut,tt);for(let vt=wt;vt<=Et;vt++){nt[vt]||(nt[vt]=[]);for(let Tt=At;Tt<=Xt;Tt++)nt[vt][Tt]||(nt[vt][Tt]=[]),nt[vt][Tt].push(W)}return nt},[]);this.indexedTins={forw:{gridNum:tt,xOrigin:G[0][0],yOrigin:G[0][1],xUnit:it,yUnit:at,gridCache:ht},bakw:{gridNum:tt,xOrigin:et[0][0],yOrigin:et[0][1],xUnit:Z,yUnit:ut,gridCache:_t}}}transform(P,F,L){if(F&&this.strict_status==jt.STATUS_ERROR)throw'Backward transform is not allowed if strict_status == "strict_error"';this.yaxisMode==jt.YAXIS_FOLLOW&&F&&(P=[P[0],-1*P[1]]);const tt=g(P);if(this.bounds&&!F&&!L&&!d(tt,this.boundsPolygon))return!1;const G=F?this.tins.bakw:this.tins.forw,et=F?this.indexedTins.bakw:this.indexedTins.forw,ot=F?this.vertices_params.bakw:this.vertices_params.forw,it=F?this.centroid.bakw:this.centroid.forw,at=F?this.pointsWeightBuffer.bakw:this.pointsWeightBuffer.forw;let ht,J;this.stateFull&&(this.stateBackward==F?ht=this.stateTriangle:(this.stateBackward=F,this.stateTriangle=void 0),J=ut=>{this.stateTriangle=ut});let Z=N(tt,G,et,ot,it,at,ht,J);if(this.bounds&&F&&!L){const ut=g(Z);if(!d(ut,this.boundsPolygon))return!1}else this.yaxisMode==jt.YAXIS_FOLLOW&&!F&&(Z=[Z[0],-1*Z[1]]);return Z}}e.Transform=jt,e.counterTri=V,e.format_version=hn,e.normalizeEdges=$,e.rotateVerticesTriangle=j,e.transformArr=N,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})})(ke,ke.exports)),ke.exports}var zt=Ar();const En=Math.pow(2,-52),Ye=new Uint32Array(512);class en{static from(t,e=Tr,n=Nr){const r=t.length,i=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];i[2*o]=e(a),i[2*o+1]=n(a)}return new en(i)}constructor(t){const e=t.length>>1;if(e>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let a=1/0,c=1/0,f=-1/0,u=-1/0;for(let b=0;b<o;b++){const T=t[2*b],Y=t[2*b+1];T<a&&(a=T),Y<c&&(c=Y),T>f&&(f=T),Y>u&&(u=Y),this._ids[b]=b}const h=(a+f)/2,p=(c+u)/2;let y,E,k;for(let b=0,T=1/0;b<o;b++){const Y=nn(h,p,t[2*b],t[2*b+1]);Y<T&&(y=b,T=Y)}const X=t[2*y],C=t[2*y+1];for(let b=0,T=1/0;b<o;b++){if(b===y)continue;const Y=nn(X,C,t[2*b],t[2*b+1]);Y<T&&Y>0&&(E=b,T=Y)}let m=t[2*E],v=t[2*E+1],l=1/0;for(let b=0;b<o;b++){if(b===y||b===E)continue;const T=Or(X,C,m,v,t[2*b],t[2*b+1]);T<l&&(k=b,l=T)}let g=t[2*k],x=t[2*k+1];if(l===1/0){for(let Y=0;Y<o;Y++)this._dists[Y]=t[2*Y]-t[0]||t[2*Y+1]-t[1];ye(this._ids,this._dists,0,o-1);const b=new Uint32Array(o);let T=0;for(let Y=0,D=-1/0;Y<o;Y++){const Q=this._ids[Y],d=this._dists[Q];d>D&&(b[T++]=Q,D=d)}this.hull=b.subarray(0,T),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Qt(X,C,m,v,g,x)<0){const b=E,T=m,Y=v;E=k,m=g,v=x,k=b,g=T,x=Y}const A=Ir(X,C,m,v,g,x);this._cx=A.x,this._cy=A.y;for(let b=0;b<o;b++)this._dists[b]=nn(t[2*b],t[2*b+1],A.x,A.y);ye(this._ids,this._dists,0,o-1),this._hullStart=y;let I=3;n[y]=e[k]=E,n[E]=e[y]=k,n[k]=e[E]=y,r[y]=0,r[E]=1,r[k]=2,i.fill(-1),i[this._hashKey(X,C)]=y,i[this._hashKey(m,v)]=E,i[this._hashKey(g,x)]=k,this.trianglesLen=0,this._addTriangle(y,E,k,-1,-1,-1);for(let b=0,T,Y;b<this._ids.length;b++){const D=this._ids[b],Q=t[2*D],d=t[2*D+1];if(b>0&&Math.abs(Q-T)<=En&&Math.abs(d-Y)<=En||(T=Q,Y=d,D===y||D===E||D===k))continue;let M=0;for(let w=0,O=this._hashKey(Q,d);w<this._hashSize&&(M=i[(O+w)%this._hashSize],!(M!==-1&&M!==n[M]));w++);M=e[M];let _=M,B;for(;B=n[_],Qt(Q,d,t[2*_],t[2*_+1],t[2*B],t[2*B+1])>=0;)if(_=B,_===M){_=-1;break}if(_===-1)continue;let N=this._addTriangle(_,D,n[_],-1,-1,r[_]);r[D]=this._legalize(N+2),r[_]=N,I++;let R=n[_];for(;B=n[R],Qt(Q,d,t[2*R],t[2*R+1],t[2*B],t[2*B+1])<0;)N=this._addTriangle(R,D,B,r[D],-1,r[R]),r[D]=this._legalize(N+2),n[R]=R,I--,R=B;if(_===M)for(;B=e[_],Qt(Q,d,t[2*B],t[2*B+1],t[2*_],t[2*_+1])<0;)N=this._addTriangle(B,D,_,-1,r[_],r[B]),this._legalize(N+2),r[B]=N,n[_]=_,I--,_=B;this._hullStart=e[D]=_,n[_]=e[R]=D,n[D]=R,i[this._hashKey(Q,d)]=D,i[this._hashKey(t[2*_],t[2*_+1])]=_}this.hull=new Uint32Array(I);for(let b=0,T=this._hullStart;b<I;b++)this.hull[b]=T,T=n[T];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(Pr(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[t],c=t-t%3;if(o=c+(t+2)%3,a===-1){if(i===0)break;t=Ye[--i];continue}const f=a-a%3,u=c+(t+1)%3,h=f+(a+2)%3,p=e[o],y=e[t],E=e[u],k=e[h];if(Br(r[2*p],r[2*p+1],r[2*y],r[2*y+1],r[2*E],r[2*E+1],r[2*k],r[2*k+1])){e[t]=k,e[a]=p;const C=n[h];if(C===-1){let v=this._hullStart;do{if(this._hullTri[v]===h){this._hullTri[v]=t;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(t,C),this._link(a,n[o]),this._link(o,h);const m=f+(a+1)%3;i<Ye.length&&(Ye[i++]=m)}else{if(i===0)break;t=Ye[--i]}}return o}_link(t,e){this._halfedges[t]=e,e!==-1&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function Pr(s,t){const e=s/(Math.abs(s)+Math.abs(t));return(t>0?3-e:1+e)/4}function nn(s,t,e,n){const r=s-e,i=t-n;return r*r+i*i}function Br(s,t,e,n,r,i,o,a){const c=s-o,f=t-a,u=e-o,h=n-a,p=r-o,y=i-a,E=c*c+f*f,k=u*u+h*h,X=p*p+y*y;return c*(h*X-k*y)-f*(u*X-k*p)+E*(u*y-h*p)<0}function Or(s,t,e,n,r,i){const o=e-s,a=n-t,c=r-s,f=i-t,u=o*o+a*a,h=c*c+f*f,p=.5/(o*f-a*c),y=(f*u-a*h)*p,E=(o*h-c*u)*p;return y*y+E*E}function Ir(s,t,e,n,r,i){const o=e-s,a=n-t,c=r-s,f=i-t,u=o*o+a*a,h=c*c+f*f,p=.5/(o*f-a*c),y=s+(f*u-a*h)*p,E=t+(o*h-c*u)*p;return{x:y,y:E}}function ye(s,t,e,n){if(n-e<=20)for(let r=e+1;r<=n;r++){const i=s[r],o=t[i];let a=r-1;for(;a>=e&&t[s[a]]>o;)s[a+1]=s[a--];s[a+1]=i}else{const r=e+n>>1;let i=e+1,o=n;Se(s,r,i),t[s[e]]>t[s[n]]&&Se(s,e,n),t[s[i]]>t[s[n]]&&Se(s,i,n),t[s[e]]>t[s[i]]&&Se(s,e,i);const a=s[i],c=t[a];for(;;){do i++;while(t[s[i]]<c);do o--;while(t[s[o]]>c);if(o<i)break;Se(s,i,o)}s[e+1]=s[o],s[o]=a,n-i+1>=o-e?(ye(s,t,i,n),ye(s,t,e,o-1)):(ye(s,t,e,o-1),ye(s,t,i,n))}}function Se(s,t,e){const n=s[t];s[t]=s[e],s[e]=n}function Tr(s){return s[0]}function Nr(s){return s[1]}class Xr{bs;width;constructor(t,e){this.width=t,this.bs=e}add(t){const e=Math.floor(t/this.width),n=t%this.width;return this.bs[e]|=1<<n,this}delete(t){const e=Math.floor(t/this.width),n=t%this.width;return this.bs[e]&=~(1<<n),this}set(t,e){const n=Math.floor(t/this.width),i=1<<t%this.width;return this.bs[n]^=(-Number(e)^this.bs[n])&i,e}has(t){const e=Math.floor(t/this.width),n=t%this.width;return(this.bs[e]&1<<n)!==0}forEach(t){const e=this.bs.length;for(let n=0;n<e;n++){let r=0;for(;this.bs[n]&&r<this.width;)this.bs[n]&1<<r&&t(n*this.width+r),r++}return this}}class An extends Xr{constructor(t){super(8,new Uint8Array(Math.ceil(t/8)).fill(0))}}function de(s){return s%3===2?s-2:s+1}function ne(s){return s%3===0?s+2:s-1}function Pn(s,t,e,n,r,i,o,a){const c=Qt(s,t,r,i,o,a),f=Qt(e,n,r,i,o,a);if(c>0&&f>0||c<0&&f<0)return!1;const u=Qt(r,i,s,t,e,n),h=Qt(o,a,s,t,e,n);return u>0&&h>0||u<0&&h<0?!1:c===0&&f===0&&u===0&&h===0?!(Math.max(r,o)<Math.min(s,e)||Math.max(s,e)<Math.min(r,o)||Math.max(i,a)<Math.min(t,n)||Math.max(t,n)<Math.min(i,a)):!0}class Rr{del;constructor(t){this.del=t}}class Yr extends Rr{vertMap;flips;consd;constructor(t,e){if(!t||typeof t!="object"||!t.triangles||!t.halfedges||!t.coords)throw new Error("Expected an object with Delaunator output");if(t.triangles.length%3||t.halfedges.length!==t.triangles.length||t.coords.length%2)throw new Error("Delaunator output appears inconsistent");if(t.triangles.length<3)throw new Error("No edges in triangulation");super(t);const n=2**32-1,r=t.coords.length>>1,i=t.triangles.length;this.vertMap=new Uint32Array(r).fill(n),this.flips=new An(i),this.consd=new An(i);for(let o=0;o<i;o++){const a=t.triangles[o];this.vertMap[a]===n&&this.updateVert(o)}e&&this.constrainAll(e)}constrainOne(t,e){const{triangles:n,halfedges:r}=this.del,i=this.vertMap[t];let o=i;do{const f=n[o],u=de(o);if(f===e)return this.protect(o);const h=ne(o),p=n[h];if(p===e)return this.protect(u),u;if(this.intersectSegments(t,e,p,f)){o=h;break}o=r[u]}while(o!==-1&&o!==i);let a=o,c=-1;for(;o!==-1;){const f=r[o],u=ne(o),h=ne(f),p=de(f);if(f===-1)throw new Error("Constraining edge exited the hull");if(this.consd.has(o))throw new Error("Edge intersects already constrained edge");if(this.isCollinear(t,e,n[o])||this.isCollinear(t,e,n[f]))throw new Error("Constraining edge intersects point");if(!this.intersectSegments(n[o],n[f],n[u],n[h])){if(c===-1&&(c=o),n[h]===e){if(o===c)throw new Error("Infinite loop: non-convex quadrilateral");o=c,c=-1;continue}if(this.intersectSegments(t,e,n[h],n[f]))o=h;else if(this.intersectSegments(t,e,n[p],n[h]))o=p;else if(c===o)throw new Error("Infinite loop: no further intersect after non-convex");continue}if(this.flipDiagonal(o),this.intersectSegments(t,e,n[u],n[h])&&(c===-1&&(c=u),c===u))throw new Error("Infinite loop: flipped diagonal still intersects");n[h]===e?(a=h,o=c,c=-1):this.intersectSegments(t,e,n[p],n[h])&&(o=p)}return this.protect(a),this.delaunify(!0),this.findEdge(t,e)}delaunify(t=!1){const{halfedges:e}=this.del,n=this.flips,r=this.consd,i=e.length;let o;do{o=0;for(let a=0;a<i;a++){if(r.has(a))continue;n.delete(a);const c=e[a];c!==-1&&(n.delete(c),this.isDelaunay(a)||(this.flipDiagonal(a),o++))}}while(t&&o>0);return this}constrainAll(t){const e=t.length;for(let n=0;n<e;n++){const r=t[n];this.constrainOne(r[0],r[1])}return this}isConstrained(t){return this.consd.has(t)}findEdge(t,e){const n=this.vertMap[e],{triangles:r,halfedges:i}=this.del;let o=n,a=-1;do{if(r[o]===t)return o;a=de(o),o=i[a]}while(o!==-1&&o!==n);return r[de(a)]===t?-a:1/0}protect(t){const e=this.del.halfedges[t],n=this.flips,r=this.consd;return n.delete(t),r.add(t),e!==-1?(n.delete(e),r.add(e),e):-t}markFlip(t){const e=this.del.halfedges,n=this.flips;if(this.consd.has(t))return!1;const i=e[t];return i!==-1&&(n.add(t),n.add(i)),!0}flipDiagonal(t){const{triangles:e,halfedges:n}=this.del,r=this.flips,i=this.consd,o=n[t],a=ne(t),c=de(t),f=ne(o),u=de(o),h=n[a],p=n[f];if(i.has(t))throw new Error("Trying to flip a constrained edge");return e[t]=e[f],n[t]=p,r.set(t,r.has(f))||i.set(t,i.has(f)),p!==-1&&(n[p]=t),n[a]=f,e[o]=e[a],n[o]=h,r.set(o,r.has(a))||i.set(o,i.has(a)),h!==-1&&(n[h]=o),n[f]=a,this.markFlip(t),this.markFlip(c),this.markFlip(o),this.markFlip(u),r.add(a),i.delete(a),r.add(f),i.delete(f),this.updateVert(t),this.updateVert(c),this.updateVert(o),this.updateVert(u),a}isCollinear(t,e,n){const r=this.del.coords;return Qt(r[t*2],r[t*2+1],r[e*2],r[e*2+1],r[n*2],r[n*2+1])===0}inCircle(t,e,n,r){const i=this.del.coords;return er(i[t*2],i[t*2+1],i[e*2],i[e*2+1],i[n*2],i[n*2+1],i[r*2],i[r*2+1])<0}isDelaunay(t){const{triangles:e,halfedges:n}=this.del,r=n[t];if(r===-1)return!0;const i=e[ne(t)],o=e[t],a=e[de(t)],c=e[ne(r)];return!this.inCircle(i,o,a,c)}updateVert(t){const{triangles:e,halfedges:n}=this.del,r=this.vertMap,i=e[t];let o=ne(t),a=n[o];for(;a!==-1&&a!==t;)o=ne(a),a=n[o];return r[i]=o,o}intersectSegments(t,e,n,r){const i=this.del.coords;return t===n||t===r||e===n||e===r?!1:Pn(i[t*2],i[t*2+1],i[e*2],i[e*2+1],i[n*2],i[n*2+1],i[r*2],i[r*2+1])}static intersectSegments=Pn}function Ee(s,t,e){if(t||(t=[]),typeof s!="object"||s.type!=="FeatureCollection")throw"Argument points must be FeatureCollection";if(!Array.isArray(t))throw"Argument points must be Array of Array";const n=s.features.map(c=>c.geometry.coordinates),r=en.from(n);let i;const o=[];r.triangles.length!==0&&t.length!==0&&(i=new Yr(r),i.constrainAll(t));for(let c=0;c<r.triangles.length;c+=3)o.push([r.triangles[c],r.triangles[c+1],r.triangles[c+2]]);const a=["a","b","c"];return Vt(o.map(c=>{const f={},u=c.map((h,p)=>{const y=s.features[h],E=y.geometry.coordinates,k=[E[0],E[1]];return E.length===3?k[2]=E[2]:f[a[p]]=y.properties[e],k});return u[3]=u[0],_e([u],f)}))}class Bn{constructor(t=[],e=Cr){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,i=e[t];for(;t<r;){let o=(t<<1)+1,a=e[o];const c=o+1;if(c<this.length&&n(e[c],a)<0&&(o=c,a=e[c]),n(a,i)>=0)break;e[t]=a,t=o}e[t]=i}}function Cr(s,t){return s<t?-1:s>t?1:0}function On(s,t){return s.p.x>t.p.x?1:s.p.x<t.p.x?-1:s.p.y!==t.p.y?s.p.y>t.p.y?1:-1:1}function Fr(s,t){return s.rightSweepEvent.p.x>t.rightSweepEvent.p.x?1:s.rightSweepEvent.p.x<t.rightSweepEvent.p.x?-1:s.rightSweepEvent.p.y!==t.rightSweepEvent.p.y?s.rightSweepEvent.p.y<t.rightSweepEvent.p.y?1:-1:1}class In{constructor(t,e,n,r){this.p={x:t[0],y:t[1]},this.featureId=e,this.ringId=n,this.eventId=r,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(t){return this.p.x===t.p.x&&this.p.y===t.p.y}}function Lr(s,t){if(s.type==="FeatureCollection"){const e=s.features;for(let n=0;n<e.length;n++)Tn(e[n],t)}else Tn(s,t)}let Ce=0,Fe=0,Le=0;function Tn(s,t){const e=s.type==="Feature"?s.geometry:s;let n=e.coordinates;(e.type==="Polygon"||e.type==="MultiLineString")&&(n=[n]),e.type==="LineString"&&(n=[[n]]);for(let r=0;r<n.length;r++)for(let i=0;i<n[r].length;i++){let o=n[r][i][0],a=null;Fe=Fe+1;for(let c=0;c<n[r][i].length-1;c++){a=n[r][i][c+1];const f=new In(o,Ce,Fe,Le),u=new In(a,Ce,Fe,Le+1);f.otherEvent=u,u.otherEvent=f,On(f,u)>0?(u.isLeftEndpoint=!0,f.isLeftEndpoint=!1):(f.isLeftEndpoint=!0,u.isLeftEndpoint=!1),t.push(f),t.push(u),o=a,Le=Le+1}}Ce=Ce+1}class Dr{constructor(t){this.leftSweepEvent=t,this.rightSweepEvent=t.otherEvent}}function $r(s,t){if(s===null||t===null||s.leftSweepEvent.ringId===t.leftSweepEvent.ringId&&(s.rightSweepEvent.isSamePoint(t.leftSweepEvent)||s.rightSweepEvent.isSamePoint(t.leftSweepEvent)||s.rightSweepEvent.isSamePoint(t.rightSweepEvent)||s.leftSweepEvent.isSamePoint(t.leftSweepEvent)||s.leftSweepEvent.isSamePoint(t.rightSweepEvent)))return!1;const e=s.leftSweepEvent.p.x,n=s.leftSweepEvent.p.y,r=s.rightSweepEvent.p.x,i=s.rightSweepEvent.p.y,o=t.leftSweepEvent.p.x,a=t.leftSweepEvent.p.y,c=t.rightSweepEvent.p.x,f=t.rightSweepEvent.p.y,u=(f-a)*(r-e)-(c-o)*(i-n),h=(c-o)*(n-a)-(f-a)*(e-o),p=(r-e)*(n-a)-(i-n)*(e-o);if(u===0)return!1;const y=h/u,E=p/u;if(y>=0&&y<=1&&E>=0&&E<=1){const k=e+y*(r-e),X=n+y*(i-n);return[k,X]}return!1}function qr(s,t){t=t||!1;const e=[],n=new Bn([],Fr);for(;s.length;){const r=s.pop();if(r.isLeftEndpoint){const i=new Dr(r);for(let o=0;o<n.data.length;o++){const a=n.data[o];if(t&&a.leftSweepEvent.featureId===r.featureId)continue;const c=$r(i,a);c!==!1&&e.push(c)}n.push(i)}else r.isLeftEndpoint===!1&&n.pop()}return e}function jr(s,t){const e=new Bn([],On);return Lr(s,e),qr(e,t)}var Ur=jr;function zr(s,t,e={}){const{removeDuplicates:n=!0,ignoreSelfIntersections:r=!0}=e;let i=[];s.type==="FeatureCollection"?i=i.concat(s.features):s.type==="Feature"?i.push(s):(s.type==="LineString"||s.type==="Polygon"||s.type==="MultiLineString"||s.type==="MultiPolygon")&&i.push(be(s)),t.type==="FeatureCollection"?i=i.concat(t.features):t.type==="Feature"?i.push(t):(t.type==="LineString"||t.type==="Polygon"||t.type==="MultiLineString"||t.type==="MultiPolygon")&&i.push(be(t));const o=Ur(Vt(i),r);let a=[];if(n){const c={};o.forEach(f=>{const u=f.join(",");c[u]||(c[u]=!0,a.push(f))})}else a=o;return Vt(a.map(c=>le(c)))}var Vr=zr;function Nn(s,t,e,n,r,i){return Object.keys(s).reduce((o,a)=>{const c=s[a],f=c.forw,u=c.bakw,h={forw:[f[0]-t.forw[0],f[1]-t.forw[1]],bakw:[u[0]-t.bakw[0],u[1]-t.bakw[1]]},p=h.forw[0]===0?1/0:((h.forw[0]<0?e:n)-t.forw[0])/h.forw[0],y=h.forw[1]===0?1/0:((h.forw[1]<0?r:i)-t.forw[1])/h.forw[1];if(Math.abs(p)/Math.abs(y)<1.1){const E={forw:[h.forw[0]*p+t.forw[0],h.forw[1]*p+t.forw[1]],bakw:[h.bakw[0]*p+t.bakw[0],h.bakw[1]*p+t.bakw[1]]};h.forw[0]<0?o[3].push(E):o[1].push(E)}if(Math.abs(y)/Math.abs(p)<1.1){const E={forw:[h.forw[0]*y+t.forw[0],h.forw[1]*y+t.forw[1]],bakw:[h.bakw[0]*y+t.bakw[0],h.bakw[1]*y+t.bakw[1]]};h.forw[1]<0?o[0].push(E):o[2].push(E)}return o},[[],[],[],[]])}function Wr(s,t){const e=[[],[],[],[]],n=[];return Object.keys(s).forEach(r=>{const i=s[r],o=i.forw,a=i.bakw,c=[o[0]-t.forw[0],o[1]-t.forw[1]],f=[a[0]-t.bakw[0],t.bakw[1]-a[1]],u={forw:c,bakw:f};if(n.push(u),c[0]===0||c[1]===0)return;let h=0;c[0]>0&&(h+=1),c[1]>0&&(h+=2),e[h].push(u)}),{perQuad:e,aggregate:n}}function Jr(s){let t=1/0,e=0,n=0;return s.forEach(r=>{const{forw:i,bakw:o}=r,a=Math.hypot(i[0],i[1]),c=Math.hypot(o[0],o[1]);if(c===0)return;const f=a/c,u=Math.atan2(i[0],i[1])-Math.atan2(o[0],o[1]);t=Math.min(t,f),e+=Math.cos(u),n+=Math.sin(u)}),isFinite(t)?[t,Math.atan2(n,e)]:[1,0]}function Xn(s,t,e){const{perQuad:n,aggregate:r}=Wr(s,t),i=n.every(c=>c.length>0),a=(e==="birdeye"?i?n:[r]:[r]).map(c=>Jr(c));return a.length===1?[a[0],a[0],a[0],a[0]]:a}function Kr(s,t,e){const n=[1,1,1,1];for(let r=0;r<4;r++){const i=(r+1)%4,o=gn([s[r].bakw,s[i].bakw]);t[r].map(a=>{const c=gn([e.bakw,a.bakw]),f=Vr(o,c);if(f.features.length>0&&f.features[0].geometry){const u=f.features[0],h=Math.sqrt(Math.pow(a.bakw[0]-e.bakw[0],2)+Math.pow(a.bakw[1]-e.bakw[1],2)),p=Math.sqrt(Math.pow(u.geometry.coordinates[0]-e.bakw[0],2)+Math.pow(u.geometry.coordinates[1]-e.bakw[1],2)),y=h/p;y>n[r]&&(n[r]=y),y>n[i]&&(n[i]=y)}})}s.forEach((r,i)=>{const o=n[i],a=[(r.bakw[0]-e.bakw[0])*o+e.bakw[0],(r.bakw[1]-e.bakw[1])*o+e.bakw[1]];r.bakw=a})}function Rn(s,t,e,n){const r=s.map((o,a)=>{const c=t[a],f=[c[0]-e.forw[0],c[1]-e.forw[1]],h=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2))/o[0],p=Math.atan2(f[0],f[1])-o[1],y=[e.bakw[0]+h*Math.sin(p),e.bakw[1]-h*Math.cos(p)];return{forw:c,bakw:y}}),i=r[2];return r[2]=r[3],r[3]=i,Kr(r,n,e),r}function Gr(s){const{convexBuf:t,centroid:e,bbox:n,minx:r,maxx:i,miny:o,maxy:a}=s,c=Nn(t,e,r,i,o,a),f=Xn(t,e,"plain");return Rn(f,n,e,c)}function Qr(s){const{convexBuf:t,centroid:e,bbox:n,minx:r,maxx:i,miny:o,maxy:a}=s,c=Nn(t,e,r,i,o,a),f=Xn(t,e,"birdeye");return Rn(f,n,e,c)}function Yn(s){const e=new Hr(s).findSegmentIntersections(),n=qn(e),r=new Map;return n.forEach(i=>{r.set(`${i.x}:${i.y}`,i)}),Array.from(r.values()).map(i=>le([i.x,i.y]))}class Hr{_xx;_yy;_ii;_nn;_zz;_zlimit=0;_bb;_allBounds;_arcIter;_filteredArcIter;buf;constructor(t){this.initArcs(t)}initArcs(t){const e=[],n=[],r=t.map(i=>{const o=i?i.length:0;for(let a=0;a<o;a++)e.push(i[a][0]),n.push(i[a][1]);return o});this.initXYData(r,e,n)}initXYData(t,e,n){const r=t.length;this._xx=new Float64Array(e),this._yy=new Float64Array(n),this._nn=new Uint32Array(t),this._zz=null,this._zlimit=0,this._filteredArcIter=null,this._ii=new Uint32Array(r);let i=0;for(let o=0;o<r;o++)this._ii[o]=i,i+=t[o];(i!=this._xx.length||this._xx.length!=this._yy.length)&&rn("ArcCollection#initXYData() Counting error"),this.initBounds(),this._arcIter=new yi(this._xx,this._yy)}initBounds(){const t=this.calcArcBounds_(this._xx,this._yy,this._nn);this._bb=t.bb,this._allBounds=t.bounds}calcArcBounds_(t,e,n){const r=n.length,i=new Float64Array(r*4),o=new qe;let a=0,c,f,u;for(let h=0;h<r;h++)c=n[h],c>0&&(f=h*4,u=vi(t,e,a,c),i[f++]=u[0],i[f++]=u[1],i[f++]=u[2],i[f]=u[3],a+=c,o.mergeBounds(u));return{bb:i,bounds:o}}getBounds(){return this._allBounds.clone()}forEachSegment(t){let e=0;for(let n=0,r=this.size();n<r;n++)e+=this.forEachArcSegment(n,t);return e}size(){return this._ii&&this._ii.length||0}forEachArcSegment(t,e){const n=t>=0,r=n?t:~t,i=this.getRetainedInterval(),o=this._nn[r],a=n?1:-1;let c=n?this._ii[r]:this._ii[r]+o-1,f=c,u=0;for(let h=1;h<o;h++)f+=a,(i===0||this._zz[f]>=i)&&(e(c,f,this._xx,this._yy),c=f,u++);return u}getRetainedInterval(){return this._zlimit}getVertexData(){return{xx:this._xx,yy:this._yy,zz:this._zz,bb:this._bb,nn:this._nn,ii:this._ii}}getUint32Array(t){const e=t*4;return(!this.buf||this.buf.byteLength<e)&&(this.buf=new ArrayBuffer(e)),new Uint32Array(this.buf,0,t)}getAvgSegment2(){let t=0,e=0;const n=this.forEachSegment((r,i,o,a)=>{t+=Math.abs(o[r]-o[i]),e+=Math.abs(a[r]-a[i])});return[t/n||0,e/n||0]}calcSegmentIntersectionStripeCount(){const t=this.getBounds().height(),e=this.getAvgSegment2()[1];let n=1;return e>0&&t>0&&(n=Math.ceil(t/e/20)),n||1}findSegmentIntersections(){const t=this.getBounds(),e=t.ymin,n=t.ymax-e,r=this.calcSegmentIntersectionStripeCount(),i=new Uint32Array(r),o=r>1?k=>Math.floor((r-1)*(k-e)/n):()=>0;let a,c;this.forEachSegment((k,X,C,m)=>{let v=o(m[k]);const l=o(m[X]);for(;i[v]=i[v]+2,v!=l;)v+=l>v?1:-1});const f=this.getUint32Array(ei(i));let u=0;const h=[];ni(i,k=>{const X=u;u+=k,h.push(f.subarray(X,u))}),ri(i,0),this.forEachSegment((k,X,C,m)=>{let v=o(m[k]);const l=o(m[X]);let g,x;for(;g=i[v],i[v]=g+2,x=h[v],x[g]=k,x[g+1]=X,v!=l;)v+=l>v?1:-1});const p=this.getVertexData(),y=[];let E;for(a=0;a<r;a++)for(E=ii(h[a],p.xx,p.yy),c=0;c<E.length;c++)y.push(E[c]);return qn(y)}}function rn(...s){const t=s.join(" ");throw new Error(t)}function on(s){return s?ti(s)?!0:Zr(s)?!1:s.length===0?!0:s.length>0:!1}function Zr(s){return s!=null&&s.toString===String.prototype.toString}function ti(s){return Array.isArray(s)}function ei(s,t){on(s)||rn("utils.sum() expects an array, received:",s);let e=0,n;for(let r=0,i=s.length;r<i;r++)n=s[r],n&&(e+=n);return e}function ni(s,t,e){if(!on(s))throw new Error(`#forEach() takes an array-like argument. ${s}`);for(let n=0,r=s.length;n<r;n++)t.call(e,s[n],n)}function ri(s,t){for(let e=0,n=s.length;e<n;e++)s[e]=t;return s}function ii(s,t,e){const n=s.length-2,r=[];let i,o,a,c,f,u,h,p,y,E,k,X,C,m,v,l,g;for(pi(t,s),l=0;l<n;){for(i=s[l],o=s[l+1],f=t[i],u=t[o],y=e[i],E=e[o],g=l;g<n&&(g+=2,a=s[g],h=t[a],!(u<h));){if(k=e[a],c=s[g+1],p=t[c],X=e[c],y>=k){if(y>X&&E>k&&E>X)continue}else if(y<X&&E<k&&E<X)continue;i==a||i==c||o==a||o==c||(C=oi(f,y,u,E,h,k,p,X),C&&(m=[i,o],v=[a,c],r.push(Dn(C,m,v,t,e)),C.length==4&&r.push(Dn(C.slice(2),m,v,t,e))))}l+=2}return r}function oi(s,t,e,n,r,i,o,a){const c=si(s,t,e,n,r,i,o,a);let f=null;return c&&(f=ai(s,t,e,n,r,i,o,a),f?di(s,t,e,n,r,i,o,a)&&(f=null):f=li(s,t,e,n,r,i,o,a)),f}function si(s,t,e,n,r,i,o,a){return Ae(s,t,e,n,r,i)*Ae(s,t,e,n,o,a)<=0&&Ae(r,i,o,a,s,t)*Ae(r,i,o,a,e,n)<=0}function Ae(s,t,e,n,r,i){return Cn(s-r,t-i,e-r,n-i)}function Cn(s,t,e,n){return s*n-t*e}function ai(s,t,e,n,r,i,o,a){let c=De(s,t,e,n,r,i,o,a),f;return c&&(f=fi(c[0],c[1],s,t,e,n,r,i,o,a),f==1?c=De(e,n,s,t,r,i,o,a):f==2?c=De(r,i,o,a,s,t,e,n):f==3&&(c=De(o,a,r,i,s,t,e,n))),c&&ui(c,s,t,e,n,r,i,o,a),c}function De(s,t,e,n,r,i,o,a){const c=Cn(e-s,n-t,o-r,a-i),f=1e-18;let u;if(c===0)return null;const h=Ae(r,i,o,a,s,t)/c;return c<=f&&c>=-f?u=ci(s,t,e,n,r,i,o,a):u=[s+h*(e-s),t+h*(n-t)],u}function ci(s,t,e,n,r,i,o,a){let c=null;return!re(s,r,o)&&!re(t,i,a)?c=[s,t]:!re(e,r,o)&&!re(n,i,a)?c=[e,n]:!re(r,s,e)&&!re(i,t,n)?c=[r,i]:!re(o,s,e)&&!re(a,t,n)&&(c=[o,a]),c}function re(s,t,e){let n;return t<e?n=s<t||s>e:t>e?n=s>t||s<e:n=s!=t,n}function fi(s,t,...e){let n=-1,r=1/0,i;for(let o=0,a=0,c=e.length;a<c;o++,a+=2)i=hi(s,t,e[a],e[a+1]),i<r&&(r=i,n=o);return n}function hi(s,t,e,n){const r=s-e,i=t-n;return r*r+i*i}function ui(s,t,e,n,r,i,o,a,c){let f=s[0],u=s[1];f=$e(f,t,n),f=$e(f,i,a),u=$e(u,e,r),u=$e(u,o,c),s[0]=f,s[1]=u}function $e(s,t,e){let n;return re(s,t,e)&&(n=Math.abs(s-t)<Math.abs(s-e)?t:e,s=n),s}function li(s,t,e,n,r,i,o,a){const c=Math.min(s,e,r,o),f=Math.max(s,e,r,o),u=Math.min(t,n,i,a),h=Math.max(t,n,i,a),p=h-u>f-c;let y=[];return(p?ce(t,u,h):ce(s,c,f))&&y.push(s,t),(p?ce(n,u,h):ce(e,c,f))&&y.push(e,n),(p?ce(i,u,h):ce(r,c,f))&&y.push(r,i),(p?ce(a,u,h):ce(o,c,f))&&y.push(o,a),(y.length!=2&&y.length!=4||y.length==4&&y[0]==y[2]&&y[1]==y[3])&&(y=null),y}function di(s,t,e,n,r,i,o,a){return s==r&&t==i||s==o&&t==a||e==r&&n==i||e==o&&n==a}function ce(s,t,e){return s>t&&s<e}function pi(s,t){mi(s,t),Fn(s,t,0,t.length-2)}function mi(s,t){for(let e=0,n=t.length;e<n;e+=2)s[t[e]]>s[t[e+1]]&&gi(t,e,e+1)}function gi(s,t,e){const n=s[t];s[t]=s[e],s[e]=n}function Fn(s,t,e,n){let r=e,i=n,o,a;for(;r<n;){for(o=s[t[e+n>>2<<1]];r<=i;){for(;s[t[r]]<o;)r+=2;for(;s[t[i]]>o;)i-=2;r<=i&&(a=t[r],t[r]=t[i],t[i]=a,a=t[r+1],t[r+1]=t[i+1],t[i+1]=a,r+=2,i-=2)}if(i-e<40?Ln(s,t,e,i):Fn(s,t,e,i),n-r<40){Ln(s,t,r,n);return}e=r,i=n}}function Ln(s,t,e,n){let r,i;for(let o=e+2;o<=n;o+=2){r=t[o],i=t[o+1];let a;for(a=o-2;a>=e&&s[r]<s[t[a]];a-=2)t[a+2]=t[a],t[a+3]=t[a+1];t[a+2]=r,t[a+3]=i}}function Dn(s,t,e,n,r){const i=s[0],o=s[1];t=$n(i,o,t[0],t[1],n,r),e=$n(i,o,e[0],e[1],n,r);const a=t[0]<e[0]?t:e,c=a==t?e:t;return{x:i,y:o,a,b:c}}function $n(s,t,e,n,r,i){let o=e<n?e:n,a=o===e?n:e;return r[o]==s&&i[o]==t?a=o:r[a]==s&&i[a]==t&&(o=a),[o,a]}function qn(s){const t={};return s.filter(e=>{const n=wi(e);return n in t?!1:(t[n]=!0,!0)})}function wi(s){return`${s.a.join(",")};${s.b.join(",")}`}class yi{_i=0;_n=0;_inc=1;_xx;_yy;i=0;x=0;y=0;constructor(t,e){this._xx=t,this._yy=e}}function vi(s,t,e,n){let r=e|0;const i=isNaN(n)?s.length-r:n+r;let o,a,c,f,u,h;if(i>0)c=u=s[r],f=h=t[r];else return[void 0,void 0,void 0,void 0];for(r++;r<i;r++)o=s[r],a=t[r],o<c&&(c=o),o>u&&(u=o),a<f&&(f=a),a>h&&(h=a);return[c,f,u,h]}class qe{xmin;ymin;xmax;ymax;constructor(...t){t.length>0&&this.setBounds(t)}cloneBounds(){return this.clone()}clone(){return new qe(this.xmin,this.ymin,this.xmax,this.ymax)}width(){return this.xmax-this.xmin||0}height(){return this.ymax-this.ymin||0}setBounds(t,e,n,r){return arguments.length==1&&(on(t)?(e=t[1],n=t[2],r=t[3],t=t[0]):(e=t.ymin,n=t.xmax,r=t.ymax,t=t.xmin)),this.xmin=t,this.ymin=e,this.xmax=n,this.ymax=r,(t>n||e>r)&&this.update(),this}update(){let t;this.xmin>this.xmax&&(t=this.xmin,this.xmin=this.xmax,this.xmax=t),this.ymin>this.ymax&&(t=this.ymin,this.ymin=this.ymax,this.ymax=t)}mergeBounds(t,...e){let n,r,i,o;return t instanceof qe?(n=t.xmin,r=t.ymin,i=t.xmax,o=t.ymax):e.length==3?(n=t,r=e[0],i=e[1],o=e[2]):t.length==4?(n=t[0],r=t[1],i=t[2],o=t[3]):rn("Bounds#mergeBounds() invalid argument:",t),this.xmin===void 0?this.setBounds(n,r,i,o):(n<this.xmin&&(this.xmin=n),r<this.ymin&&(this.ymin=r),i>this.xmax&&(this.xmax=i),o>this.ymax&&(this.ymax=o)),this}}function je(s){const t=["a","b","c"].map(e=>s.properties[e].index);return[[0,1],[0,2],[1,2],[0,1,2]].map(e=>e.map(n=>t[n]).sort().join("-")).sort()}function sn(s,t,e){const n=je(t.forw),r=je(t.bakw);if(JSON.stringify(n)!=JSON.stringify(r))throw`${JSON.stringify(t,null,2)}
${JSON.stringify(n)}
${JSON.stringify(r)}`;for(let i=0;i<n.length;i++){const o=n[i];s[o]||(s[o]=[]),s[o].push(t)}e&&(e.forw.features.push(t.forw),e.bakw.features.push(t.bakw))}function jn(s,t,e){const n=je(t.forw),r=je(t.bakw);if(JSON.stringify(n)!=JSON.stringify(r))throw`${JSON.stringify(t,null,2)}
${JSON.stringify(n)}
${JSON.stringify(r)}`;if(n.forEach(i=>{const o=s[i];if(!o)return;const a=o.filter(c=>c!==t);a.length===0?delete s[i]:s[i]=a}),e){const i=(o,a)=>{!o||!a||(o.features=o.features.filter(c=>c!==a))};i(e.forw,t.forw),i(e.bakw,t.bakw)}}function Pe(s,t,e){return le(s,{target:{geom:t,index:e}})}function Be(s){return le(s.properties.target.geom,{target:{geom:s.geometry.coordinates,index:s.properties.target.index}})}function an(s,t){const e=t.geometry.coordinates;return[0,1,2,3].map(n=>{const r=(n+1)%4,i=s[n],o=s[r],a=i.geometry.coordinates,c=Math.atan2(a[0]-e[0],a[1]-e[1]),f=[t,i,o,t].map(p=>p.geometry.coordinates),u={a:{geom:t.properties.target.geom,index:t.properties.target.index},b:{geom:i.properties.target.geom,index:i.properties.target.index},c:{geom:o.properties.target.geom,index:o.properties.target.index}},h=Vt([_e([f],u)]);return[c,h]}).reduce((n,r)=>(n[0].push(r[0]),n[1].push(r[1]),n),[[],[]])}function bi(s){const{tins:t,targets:e,includeReciprocals:n}=s,r={};e.forEach(o=>{const a=t[o];if(!a||!a.features)return;r[o]={};const c={};a.features.forEach(f=>{const u=["a","b","c"];for(let h=0;h<3;h++){const p=(h+1)%3,y=u[h],E=u[p],k=f.properties[y].index,X=f.properties[E].index,C=[k,X].sort().join("-");if(c[C])continue;c[C]=!0;const m=f.geometry.coordinates[0][h],v=f.geometry.coordinates[0][p],l=f.properties[y].geom,g=f.properties[E].geom,x=Math.sqrt(Math.pow(l[0]-g[0],2)+Math.pow(l[1]-g[1],2))/Math.sqrt(Math.pow(m[0]-v[0],2)+Math.pow(m[1]-v[1],2)),A=r[o];A[`${k}:${C}`]=x,A[`${X}:${C}`]=x}})});const i={};return n&&(i.bakw={}),e.forEach(o=>{const a=r[o];if(i[o]={},!a)return;const c={};Object.keys(a).forEach(u=>{const[h]=u.split(":");c[h]||(c[h]=[]),c[h].push(a[u])}),Object.keys(c).forEach(u=>{const h=c[u],p=h.reduce((y,E)=>y+E,0)/h.length;i[o][u]=p,n&&i.bakw&&(i.bakw[u]=1/p)});let f=0;for(let u=0;u<4;u++){const h=`b${u}`,p=i[o][h]||0;f+=p}i[o].c=f/4,n&&i.bakw&&(i.bakw.c=1/i[o].c)}),i}function _i(s,t){const e=s.split("-");if(e.length!==2||!e.every(i=>/^-?\d+$/.test(i)))return!1;const[n,r]=e.map(i=>parseInt(i,10)).sort((i,o)=>i-o);return t.some(i=>{if(i.length!==2)return!1;const o=i.map(c=>parseInt(`${c}`,10));if(o.some(c=>Number.isNaN(c)))return!1;const a=o.sort((c,f)=>c-f);return a[0]===n&&a[1]===r})}function Ue(s){return["a","b","c"].map((t,e)=>({prop:s.properties[t],geom:s.geometry.coordinates[0][e]}))}function xi(s,t,e){const n=new Set;let r=!1;const i=Object.keys(t);for(const o of i){if(n.has(o))continue;n.add(o);const a=t[o];if(!a||a.length<2)continue;const c=o.split("-");if(c.length!==2||_i(o,e))continue;const f=Ue(a[0].bakw),u=Ue(a[1].bakw),h=Ue(a[0].forw),p=Ue(a[1].forw),y=c.map(b=>f.find(T=>`${T.prop.index}`===b)||u.find(T=>`${T.prop.index}`===b)),E=c.map(b=>h.find(T=>`${T.prop.index}`===b)||p.find(T=>`${T.prop.index}`===b));if(y.some(b=>!b)||E.some(b=>!b))continue;const k=[f,u].map(b=>b.find(T=>!c.includes(`${T.prop.index}`))),X=[h,p].map(b=>b.find(T=>!c.includes(`${T.prop.index}`)));if(k.some(b=>!b)||X.some(b=>!b))continue;const C=a[0].bakw.geometry.coordinates[0].slice(0,3).map(b=>ve(b)),m=a[1].bakw.geometry.coordinates[0].slice(0,3).map(b=>ve(b));if(!(Un(ve(k[0].geom),m)||Un(ve(k[1].geom),C)))continue;const l=E.map(b=>ve(b.geom)),g=X.map(b=>ve(b.geom)),x=Mi([...l,...g]),A=ki(x),I=zn(l[0],l[1],g[0])+zn(l[0],l[1],g[1]);cn(A,I)&&(jn(t,a[0],s),jn(t,a[1],s),y.forEach(b=>{if(!b)return;const T=[b.geom,k[0].geom,k[1].geom,b.geom],Y={a:b.prop,b:k[0].prop,c:k[1].prop},D=_e([T],Y),Q=zt.counterTri(D);sn(t,{forw:Q,bakw:D},s)}),r=!0)}return r}function ve(s){return[s[0],s[1]]}function Un(s,t){const[e,n]=t[0],[r,i]=t[1],[o,a]=t[2],c=o-e,f=a-n,u=r-e,h=i-n,p=s[0]-e,y=s[1]-n,E=c*c+f*f,k=c*u+f*h,X=c*p+f*y,C=u*u+h*h,m=u*p+h*y,v=E*C-k*k;if(v===0)return!1;const l=1/v,g=(C*X-k*m)*l,x=(E*m-k*X)*l,A=1e-9;return g>=-A&&x>=-A&&g+x<=1+A}function Mi(s){const t=s.map(o=>o.slice()).filter((o,a,c)=>c.findIndex(f=>cn(f[0],o[0])&&cn(f[1],o[1]))===a);if(t.length<=1)return t;const e=t.sort((o,a)=>o[0]===a[0]?o[1]-a[1]:o[0]-a[0]),n=(o,a,c)=>(a[0]-o[0])*(c[1]-o[1])-(a[1]-o[1])*(c[0]-o[0]),r=[];for(const o of e){for(;r.length>=2&&n(r[r.length-2],r[r.length-1],o)<=0;)r.pop();r.push(o)}const i=[];for(let o=e.length-1;o>=0;o--){const a=e[o];for(;i.length>=2&&n(i[i.length-2],i[i.length-1],a)<=0;)i.pop();i.push(a)}return i.pop(),r.pop(),r.concat(i)}function ki(s){if(s.length<3)return 0;let t=0;for(let e=0;e<s.length;e++){const[n,r]=s[e],[i,o]=s[(e+1)%s.length];t+=n*o-i*r}return Math.abs(t)/2}function zn(s,t,e){return Math.abs((s[0]*(t[1]-e[1])+t[0]*(e[1]-s[1])+e[0]*(s[1]-t[1]))/2)}function cn(s,t,e=1e-9){return Math.abs(s-t)<=e}const Vn=typeof zt.format_version<"u"?zt.format_version:2.00703;class It extends zt.Transform{importance;priority;pointsSet;constructor(t={}){super(),t.bounds?this.setBounds(t.bounds):(this.setWh(t.wh),this.vertexMode=t.vertexMode||It.VERTEX_PLAIN),this.strictMode=t.strictMode||It.MODE_AUTO,this.yaxisMode=t.yaxisMode||It.YAXIS_INVERT,this.importance=t.importance||0,this.priority=t.priority||0,this.stateFull=t.stateFull||!1,t.points&&this.setPoints(t.points),t.edges&&this.setEdges(t.edges)}getFormatVersion(){return Vn}setPoints(t){this.yaxisMode===It.YAXIS_FOLLOW&&(t=t.map(e=>[e[0],[e[1][0],-1*e[1][1]]])),this.points=t,this.tins=void 0,this.indexedTins=void 0}setEdges(t=[]){this.edges=zt.normalizeEdges(t),this.edgeNodes=void 0,this.tins=void 0,this.indexedTins=void 0}setBounds(t){this.bounds=t;let e=t[0][0],n=e,r=t[0][1],i=r;const o=[t[0]];for(let a=1;a<t.length;a++){const c=t[a];c[0]<e&&(e=c[0]),c[0]>n&&(n=c[0]),c[1]<r&&(r=c[1]),c[1]>i&&(i=c[1]),o.push(c)}o.push(t[0]),this.boundsPolygon=_e([o]),this.xy=[e,r],this.wh=[n-e,i-r],this.vertexMode=It.VERTEX_PLAIN,this.tins=void 0,this.indexedTins=void 0}getCompiled(){const t={};t.version=Vn,t.points=this.points,t.weight_buffer=this.pointsWeightBuffer,t.centroid_point=[this.centroid.forw.geometry.coordinates,this.centroid.forw.properties.target.geom],t.vertices_params=[this.vertices_params.forw[0],this.vertices_params.bakw[0]],t.vertices_points=[];const e=this.vertices_params.forw[1];return e&&[0,1,2,3].map(n=>{const r=e[n].features[0],i=r.geometry.coordinates[0][1],o=r.properties.b.geom;t.vertices_points[n]=[i,o]}),t.strict_status=this.strict_status,t.tins_points=[[]],this.tins.forw.features.map(n=>{t.tins_points[0].push(["a","b","c"].map(r=>n.properties[r].index))}),this.strict_status===It.STATUS_LOOSE?(t.tins_points[1]=[],this.tins.bakw.features.map(n=>{t.tins_points[1].push(["a","b","c"].map(r=>n.properties[r].index))})):this.strict_status===It.STATUS_ERROR&&this.kinks?.bakw&&(t.kinks_points=this.kinks.bakw.features.map(n=>n.geometry.coordinates)),t.yaxisMode=this.yaxisMode,t.vertexMode=this.vertexMode,t.strictMode=this.strictMode,this.bounds?(t.bounds=this.bounds,t.boundsPolygon=this.boundsPolygon,t.xy=this.xy,t.wh=this.wh):t.wh=this.wh,t.edges=this.edges,t.edgeNodes=this.edgeNodes,t}setWh(t){this.wh=t||[100,100],this.xy=[0,0],this.bounds=void 0,this.boundsPolygon=void 0,this.tins=void 0,this.indexedTins=void 0}setVertexMode(t){this.vertexMode=t,this.tins=void 0,this.indexedTins=void 0}setStrictMode(t){this.strictMode=t,this.tins=void 0,this.indexedTins=void 0}calcurateStrictTin(){const t=this.tins.forw.features.map(r=>zt.counterTri(r));this.tins.bakw=Vt(t);const e={};this.tins.forw.features.forEach((r,i)=>{const o=this.tins.bakw.features[i];sn(e,{forw:r,bakw:o})}),xi(this.tins,e,this.pointsSet?.edges||[]);const n=["forw","bakw"].map(r=>{const i=this.tins[r].features.map(o=>o.geometry.coordinates[0]);return Yn(i)});n[0].length===0&&n[1].length===0?(this.strict_status=It.STATUS_STRICT,delete this.kinks):(this.strict_status=It.STATUS_ERROR,this.kinks={forw:Vt(n[0]),bakw:Vt(n[1])})}generatePointsSet(){const t={forw:[],bakw:[]};for(let r=0;r<this.points.length;r++){const i=this.points[r][0],o=this.points[r][1],a=Pe(i,o,r);t.forw.push(a),t.bakw.push(Be(a))}const e=[];let n=0;this.edgeNodes=[],this.edges||(this.edges=[]);for(let r=0;r<this.edges.length;r++){const i=this.edges[r][2],o=Object.assign([],this.edges[r][0]),a=Object.assign([],this.edges[r][1]);if(o.length===0&&a.length===0){e.push(i);continue}o.unshift(this.points[i[0]][0]),o.push(this.points[i[1]][0]),a.unshift(this.points[i[0]][1]),a.push(this.points[i[1]][1]);const c=[o,a].map(f=>{const u=f.map((p,y,E)=>{if(y===0)return 0;const k=E[y-1];return Math.sqrt(Math.pow(p[0]-k[0],2)+Math.pow(p[1]-k[1],2))}),h=u.reduce((p,y,E)=>E===0?[0]:(p.push(p[E-1]+y),p),[]);return h.map((p,y,E)=>{const k=p/E[E.length-1];return[f[y],u[y],h[y],k]})});c.map((f,u)=>{const h=c[u?0:1];return f.filter((p,y)=>!(y===0||y===f.length-1||p[4]==="handled")).map(p=>{const y=p[0],E=p[3],k=h.reduce((X,C,m,v)=>{if(X)return X;const l=v[m+1];if(C[3]===E)return C[4]="handled",[C];if(C[3]<E&&l&&l[3]>E)return[C,l]},void 0);if(k&&k.length===1)return u===0?[y,k[0][0],E]:[k[0][0],y,E];if(k&&k.length===2){const X=k[0],C=k[1],m=(E-X[3])/(C[3]-X[3]),v=[(C[0][0]-X[0][0])*m+X[0][0],(C[0][1]-X[0][1])*m+X[0][1]];return u===0?[y,v,E]:[v,y,E]}return[]})}).reduce((f,u)=>f.concat(u),[]).sort((f,u)=>f[2]<u[2]?-1:1).map((f,u,h)=>{this.edgeNodes[n]=[f[0],f[1]];const p=Pe(f[0],f[1],`e${n}`);n++,t.forw.push(p),t.bakw.push(Be(p)),u===0?e.push([i[0],t.forw.length-1]):e.push([t.forw.length-2,t.forw.length-1]),u===h.length-1&&e.push([t.forw.length-1,i[1]])})}return{forw:t.forw,bakw:t.bakw,edges:e}}validateAndPrepareInputs(){const t=this.xy[0]-.05*this.wh[0],e=this.xy[0]+1.05*this.wh[0],n=this.xy[1]-.05*this.wh[1],r=this.xy[1]+1.05*this.wh[1];if(!this.points.reduce((a,c)=>a&&(this.bounds?ar(c[0],this.boundsPolygon):c[0][0]>=t&&c[0][0]<=e&&c[0][1]>=n&&c[0][1]<=r),!0))throw"SOME POINTS OUTSIDE";let o=[];return this.wh&&(o=[[t,n],[e,n],[t,r],[e,r]]),{pointsSet:this.generatePointsSet(),bbox:o,minx:t,maxx:e,miny:n,maxy:r}}updateTin(){let t=this.strictMode;t!==It.MODE_STRICT&&t!==It.MODE_LOOSE&&(t=It.MODE_AUTO);const{pointsSet:e,bbox:n,minx:r,maxx:i,miny:o,maxy:a}=this.validateAndPrepareInputs(),c={forw:Vt(e.forw),bakw:Vt(e.bakw)},f=Ee(c.forw,e.edges,"target"),u=Ee(c.bakw,e.edges,"target");if(f.features.length===0||u.features.length===0)throw"TOO LINEAR1";const h=fr(c.forw),p=kn(c.forw);if(!p)throw"TOO LINEAR2";const y={},E=p.geometry.coordinates[0];let k;try{k=E.map(b=>({forw:b,bakw:zt.transformArr(le(b),f)})),k.forEach(b=>{y[`${b.forw[0]}:${b.forw[1]}`]=b})}catch{throw"TOO LINEAR2"}const X=kn(c.bakw);if(!X)throw"TOO LINEAR2";const C=X.geometry.coordinates[0];try{k=C.map(b=>({bakw:b,forw:zt.transformArr(le(b),u)})),k.forEach(b=>{y[`${b.forw[0]}:${b.forw[1]}`]=b})}catch{throw"TOO LINEAR2"}const m={forw:h.geometry.coordinates,bakw:zt.transformArr(h,f)},v=Pe(m.forw,m.bakw,"c");this.centroid={forw:v,bakw:Be(v)};const l={convexBuf:y,centroid:m,bbox:n,minx:r,maxx:i,miny:o,maxy:a},g=this.vertexMode===It.VERTEX_BIRDEYE?Qr(l):Gr(l),x={forw:[],bakw:[]};for(let b=0;b<g.length;b++){const T=g[b].forw,Y=g[b].bakw,D=Pe(T,Y,`b${b}`),Q=Be(D);e.forw.push(D),e.bakw.push(Q),x.forw.push(D),x.bakw.push(Q)}this.pointsSet={forw:Vt(e.forw),bakw:Vt(e.bakw),edges:e.edges},this.tins={forw:zt.rotateVerticesTriangle(Ee(this.pointsSet.forw,e.edges,"target"))},(t===It.MODE_STRICT||t===It.MODE_AUTO)&&this.calcurateStrictTin(),(t===It.MODE_LOOSE||t===It.MODE_AUTO&&this.strict_status===It.STATUS_ERROR)&&(this.tins.bakw=zt.rotateVerticesTriangle(Ee(this.pointsSet.bakw,e.edges,"target")),delete this.kinks,this.strict_status=It.STATUS_LOOSE),this.vertices_params={forw:an(x.forw,this.centroid.forw),bakw:an(x.bakw,this.centroid.bakw)},this.addIndexedTin();const A=["forw"];this.strict_status===It.STATUS_LOOSE&&A.push("bakw");const I=this.strict_status===It.STATUS_STRICT;this.pointsWeightBuffer=bi({tins:this.tins,targets:A,includeReciprocals:I})}async updateTinAsync(){this.updateTin()}}$t.Tin=It,$t.constrainedTin=Ee,$t.counterPoint=Be,$t.createPoint=Pe,$t.default=It,$t.findIntersections=Yn,$t.format_version=zt.format_version,$t.insertSearchIndex=sn,$t.vertexCalc=an,Object.defineProperties($t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
